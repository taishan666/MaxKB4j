import{ay as _e,aA as be,aB as r,bg as he,b9 as Q,c4 as ye,ba as ge,bs as ke,aL as we,aD as n,bc as L,aF as s,aH as t,aG as a,aK as b,aJ as m,bo as h,aC as g,aI as i,aE as d,bd as $,bh as I,bi as z,ci as Te,cj as $e,bj as S,cd as X,cf as Ce,ck as Y,bp as Ve}from"./chat-BFw4auTk.js";import{E as Me,_ as Le}from"./ParamSettingDialog.vue_vue_type_script_setup_true_lang-ClNm1Nb0.js";import{l as Se}from"./permission-api-DWn36i1R.js";import"./workspace-CWPFNlmc.js";const Ue={class:"p-16-24"},Fe={class:"ml-4 color-text-primary"},Ne={class:"flex-between mb-16"},xe={class:"complex-search"},Ae=["innerHTML"],Ee=["innerHTML"],Pe={class:"filter"},Re={class:"form-item mb-16 ml-4"},Be={class:"text-right"},Ie={class:"mr-8"},ze={class:"mr-8"},He={class:"mr-8"},Je=_e({__name:"ModelResourceIndex",setup(De){const{user:H,model:Z}=be(),k=r("name"),c=r({name:"",createUser:"",modelType:""}),U=r(!1),D=r([]),j=r([]),F=r([]),N=he({current_page:1,page_size:20,total:0}),ee=e=>{Ce(`${g("views.model.delete.confirmTitle")}${e.name} ?`,g("views.model.delete.confirmMessage"),{confirmButtonText:g("common.confirm"),confirmButtonClass:"danger"}).then(()=>{Y.deleteModel(e.id).then(()=>{p(),Ve(g("common.deleteSuccess"))})}).catch(()=>{})},O=r(),le=e=>{var o;(o=O.value)==null||o.open(e)},W=r(),te=e=>{var v;const o=F.value.find(E=>E.provider===e.provider);o&&((v=W.value)==null||v.open(o,e))},x=Q(()=>ye.model.systemManage),C=r([]),V=r(!1),_=r([]),A=Q(()=>e=>F.value.find(o=>o.provider===e.provider)),w=r(""),M=r([]);ge([()=>C.value,()=>w.value],()=>{w.value.length||(M.value=C.value),M.value=C.value.filter(e=>e.label.toLowerCase().includes(w.value.toLowerCase()))},{immediate:!0});function G(e){e==="clear"&&(_.value=[]),p(),V.value=!1}async function oe(){if(H.isEE()){const e=await Se("workspace").getSystemWorkspaceList(U);C.value=e.data.map(o=>({label:o.name,value:o.id}))}}const ae=()=>{c.value={name:"",createUser:"",modelType:""}};function ne(){let e={name:c.value.name,createUser:c.value.createUser,modelType:c.value.modelType};return _.value.length>0&&(e.workspace_ids=JSON.stringify(_.value)),e}function p(){Y.getModelListPage(N,ne(),U).then(e=>{var o,v;N.total=(o=e.data)==null?void 0:o.total,D.value=(v=e.data)==null?void 0:v.records})}function se(){Z.asyncGetProvider(U).then(e=>{F.value=e==null?void 0:e.data,p()})}return ke(()=>{oe(),se(),we.getAllMemberList("").then(e=>{j.value=e.data})}),(e,o)=>{const v=n("el-breadcrumb-item"),E=n("el-breadcrumb"),T=n("el-option"),P=n("el-select"),J=n("el-input"),q=n("el-space"),u=n("el-table-column"),ie=n("Filter"),re=n("el-icon"),y=n("el-button"),de=n("el-checkbox"),me=n("el-checkbox-group"),ce=n("el-scrollbar"),pe=n("el-empty"),ue=n("el-popover"),R=n("AppIcon"),B=n("el-tooltip"),ve=n("app-table"),fe=n("el-card");return s(),L("div",Ue,[t(E,{"separator-icon":"ArrowRight"},{default:a(()=>[t(v,null,{default:a(()=>[b(m(h(g)("views.system.resource_management.label")),1)]),_:1}),t(v,null,{default:a(()=>[i("h5",Fe,m(h(g)("views.model.title")),1)]),_:1})]),_:1}),t(fe,{class:"mt-16",style:{height:"calc(var(--app-main-height) + 20px)"}},{default:a(()=>[i("div",Ne,[i("div",xe,[t(P,{class:"complex-search__left",modelValue:k.value,"onUpdate:modelValue":o[0]||(o[0]=l=>k.value=l),style:{width:"120px"},onChange:ae},{default:a(()=>[t(T,{label:e.$t("common.creator"),value:"createUser"},null,8,["label"]),t(T,{label:e.$t("views.model.modelForm.modelType.label"),value:"modelType"},null,8,["label"]),t(T,{label:e.$t("views.model.modelForm.modelName.label"),value:"name"},null,8,["label"])]),_:1},8,["modelValue"]),k.value==="name"?(s(),d(J,{key:0,modelValue:c.value.name,"onUpdate:modelValue":o[1]||(o[1]=l=>c.value.name=l),onChange:p,placeholder:e.$t("common.searchBar.placeholder"),style:{width:"220px"},clearable:""},null,8,["modelValue","placeholder"])):k.value==="createUser"?(s(),d(P,{key:1,modelValue:c.value.createUser,"onUpdate:modelValue":o[2]||(o[2]=l=>c.value.createUser=l),onChange:p,filterable:"",clearable:"",style:{width:"220px"}},{default:a(()=>[(s(!0),L(I,null,z(j.value,l=>(s(),d(T,{key:l.id,value:l.id,label:l.nickname},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])):k.value==="modelType"?(s(),d(P,{key:2,modelValue:c.value.modelType,"onUpdate:modelValue":o[3]||(o[3]=l=>c.value.modelType=l),clearable:"",onChange:p,style:{width:"220px"}},{default:a(()=>[(s(!0),L(I,null,z(h(Te),l=>(s(),d(T,{key:l.value,label:l.text,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):$("",!0)])]),t(ve,{data:D.value,"pagination-config":N,onSizeChange:p,onChangePage:p,maxTableHeight:260},{default:a(()=>[t(u,{width:"220",label:e.$t("common.name"),"show-overflow-tooltip":""},{default:a(({row:l})=>[t(q,{size:8},{default:a(()=>{var f;return[i("span",{style:{width:"24px",height:"24px",display:"inline-block"},innerHTML:(f=A.value(l))==null?void 0:f.icon},null,8,Ae),i("span",null,m(l.name),1)]}),_:2},1024)]),_:1},8,["label"]),t(u,{prop:"provider",label:e.$t("views.model.provider"),"show-overflow-tooltip":"",width:"150"},{default:a(({row:l})=>[t(q,{size:8},{default:a(()=>{var f,K;return[i("span",{style:{width:"24px",height:"24px",display:"inline-block"},innerHTML:(f=A.value(l))==null?void 0:f.icon},null,8,Ee),i("span",null,m((K=A.value(l))==null?void 0:K.name),1)]}),_:2},1024)]),_:1},8,["label"]),t(u,{width:"120",label:e.$t("views.model.modelForm.modelType.label")},{default:a(({row:l})=>[b(m(e.$t(h($e)[l.modelType])),1)]),_:1},8,["label"]),t(u,{width:"220",label:e.$t("views.model.modelForm.base_model.label"),"show-overflow-tooltip":""},{default:a(({row:l})=>[b(m(l.modelName),1)]),_:1},8,["label"]),h(H).isEE()?(s(),d(u,{key:0,width:"150",prop:"workspace_name",label:e.$t("views.workspace.title"),"show-overflow-tooltip":""},{header:a(()=>[i("div",null,[i("span",null,m(e.$t("views.workspace.title")),1),t(ue,{width:200,trigger:"click",visible:V.value},{reference:a(()=>[t(y,{style:{"margin-top":"-2px"},type:_.value&&_.value.length>0?"primary":"",link:"",onClick:o[4]||(o[4]=l=>V.value=!V.value)},{default:a(()=>[t(re,null,{default:a(()=>[t(ie)]),_:1})]),_:1},8,["type"])]),default:a(()=>[i("div",Pe,[i("div",Re,[i("div",{onClick:o[7]||(o[7]=S(()=>{},["stop"]))},[t(J,{modelValue:w.value,"onUpdate:modelValue":o[5]||(o[5]=l=>w.value=l),placeholder:e.$t("common.search"),"prefix-icon":"Search",clearable:""},null,8,["modelValue","placeholder"]),M.value.length?(s(),d(ce,{key:0,height:"300"},{default:a(()=>[t(me,{modelValue:_.value,"onUpdate:modelValue":o[6]||(o[6]=l=>_.value=l),style:{display:"flex","flex-direction":"column"}},{default:a(()=>[(s(!0),L(I,null,z(M.value,l=>(s(),d(de,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):(s(),d(pe,{key:1,description:e.$t("common.noData")},null,8,["description"]))])])]),i("div",Be,[t(y,{size:"small",onClick:o[8]||(o[8]=l=>G("clear"))},{default:a(()=>[b(m(e.$t("common.clear")),1)]),_:1}),t(y,{type:"primary",onClick:G,size:"small"},{default:a(()=>[b(m(e.$t("common.confirm")),1)]),_:1})])]),_:1},8,["visible"])])]),_:1},8,["label"])):$("",!0),t(u,{prop:"nickname",label:e.$t("common.creator"),"show-overflow-tooltip":""},null,8,["label"]),t(u,{label:e.$t("views.document.table.updateTime"),width:"180"},{default:a(({row:l})=>[b(m(h(X)(l.update_time)),1)]),_:1},8,["label"]),t(u,{label:e.$t("common.createTime"),width:"180"},{default:a(({row:l})=>[b(m(h(X)(l.createTime)),1)]),_:1},8,["label"]),t(u,{label:e.$t("common.operation"),align:"left",width:"120",fixed:"right"},{default:a(({row:l})=>[x.value.modify()?(s(),d(B,{key:0,effect:"dark",content:e.$t("common.modify"),placement:"top"},{default:a(()=>[i("span",Ie,[t(y,{type:"primary",text:"",title:e.$t("common.modify"),onClick:S(f=>te(l),["stop"])},{default:a(()=>[t(R,{iconName:"app-edit"})]),_:2},1032,["title","onClick"])])]),_:2},1032,["content"])):$("",!0),(l.modelType==="TTS"||l.modelType==="LLM"||l.modelType==="VISION"||l.modelType==="TTI")&&x.value.paramSetting()?(s(),d(B,{key:1,effect:"dark",content:e.$t("views.model.modelForm.title.paramSetting"),placement:"top"},{default:a(()=>[i("span",ze,[t(y,{type:"primary",text:"",title:e.$t("views.model.modelForm.title.paramSetting"),onClick:S(f=>le(l),["stop"])},{default:a(()=>[t(R,{iconName:"app-setting"})]),_:2},1032,["title","onClick"])])]),_:2},1032,["content"])):$("",!0),x.value.delete()?(s(),d(B,{key:2,effect:"dark",content:e.$t("common.delete"),placement:"top"},{default:a(()=>[i("span",He,[t(y,{type:"primary",text:"",title:e.$t("common.delete"),onClick:S(f=>ee(l),["stop"])},{default:a(()=>[t(R,{iconName:"app-delete"})]),_:2},1032,["title","onClick"])])]),_:2},1032,["content"])):$("",!0)]),_:1},8,["label"])]),_:1},8,["data","pagination-config"])]),_:1}),t(Me,{ref_key:"editModelRef",ref:W,onSubmit:p},null,512),t(Le,{ref_key:"paramSettingRef",ref:O},null,512)])}}});export{Je as default};

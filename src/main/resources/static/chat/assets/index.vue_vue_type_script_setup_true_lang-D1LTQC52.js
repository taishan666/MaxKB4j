import{ct as me,cu as fe,aJ as B,aY as Q,aK as J,aP as D,bq as ue,bf as E,aQ as i,aZ as ee,aL as b,aM as u,bn as te,aR as s,b0 as oe,aT as o,a_ as U,b1 as R,aW as l,aV as C,aO as e,cv as ne,aS as t,cw as ye,bp as pe,cx as se,aU as ae,cy as ve,bm as ge,bk as le,bc as de,bg as he,b8 as ie,bl as ce,cr as z,cs as X,cz as h,cA as H,cB as Y,ba as Z,b6 as q,cC as be,cD as Ae,cE as ke,aN as we}from"./chat-ESISKCvw.js";import{_ as $e}from"./ResetPassword.vue_vue_type_script_setup_true_lang-BWxiDIuW.js";import{_ as Ie,s as j}from"./SettingAPIKeyDialog.vue_vue_type_script_setup_true_lang-NgQ1T41x.js";const _e="/license",Ce=O=>fe(`${_e}/profile`,void 0,O),Ee=(O,a)=>me(`${_e}/profile`,O,void 0,a),re={getLicense:Ce,putLicense:Ee},Re=["id"],De={class:"about-ui"},Se={class:"flex"},Ne={class:"label"},Pe={class:"flex"},Ke={class:"label"},xe={key:0,class:"color-danger"},Oe={class:"flex"},Te={class:"label"},Me={class:"flex"},Ue={class:"label"},Ve={class:"flex"},We={class:"label"},ze={class:"flex"},Be={class:"label"},Le={key:0,class:"mt-16 flex align-center"},Ge={class:"border-t text-center mt-16 p-16 pb-0"},Fe=B({__name:"AboutDialog",setup(O,{expose:a}){const{user:d,theme:p}=Q(),v=J(()=>p.isDefaultTheme()),m=D(!1),f=D(!1),_=D(null),A=D(!1);ue(m,n=>{n||(A.value&&window.location.reload(),A.value=!1)});const N=()=>{d.showXpack()&&V(),m.value=!0},k=n=>{const r=new FormData;r.append("license_file",n.raw),re.putLicense(r,f).then(w=>{V(),A.value=!0})},L=J(()=>d?d.getEditionName()==="PE"?E("layout.about.edition.professional"):d.getEditionName()==="EE"?E("layout.about.edition.enterprise"):E("layout.about.edition.community"):"-");function V(){re.getLicense(f).then(n=>{var r;_.value=(r=n.data)==null?void 0:r.license})}return a({open:N}),(n,r)=>{const w=i("LogoFull"),T=i("el-button"),c=i("el-upload"),$=i("el-text"),I=i("el-dialog"),P=ee("hasPermission"),K=ee("loading");return u(),b(I,{modelValue:m.value,"onUpdate:modelValue":r[0]||(r[0]=S=>m.value=S),class:te(["about-dialog border-r-6",v.value?"":"dialog-custom-header"])},{header:s(({titleId:S,titleClass:g})=>[o("div",{class:te(["logo flex-center",g]),id:S},[t(w,{height:"59px"})],10,Re)]),default:s(()=>{var S,g,x,M,G,F,y;return[oe((u(),U("div",De,[o("div",Se,[o("span",Ne,l(n.$t("layout.about.authorize")),1),o("span",null,l(((S=_.value)==null?void 0:S.corporation)||"-"),1)]),o("div",Pe,[o("span",Ke,l(n.$t("layout.about.expiredTime")),1),o("span",null,[C(l(((g=_.value)==null?void 0:g.expired)||"-")+" ",1),(x=_.value)!=null&&x.expired&&e(ne)((M=_.value)==null?void 0:M.expired)?(u(),U("span",xe,"（"+l(e(ne)((G=_.value)==null?void 0:G.expired))+"）",1)):R("",!0)])]),o("div",Oe,[o("span",Te,l(n.$t("layout.about.edition.label")),1),o("span",null,l(L.value),1)]),o("div",Me,[o("span",Ue,l(n.$t("layout.about.version")),1),o("span",null,l(e(d).version),1)]),o("div",Ve,[o("span",We,l(n.$t("layout.about.serialNo")),1),o("span",null,l(((F=_.value)==null?void 0:F.serialNo)||"-"),1)]),o("div",ze,[o("span",Be,l(n.$t("layout.about.remark")),1),o("span",null,l(((y=_.value)==null?void 0:y.remark)||"-"),1)]),e(d).showXpack()?(u(),U("div",Le,[oe((u(),b(c,{ref:"uploadRef",action:"#","auto-upload":!1,"show-file-list":!1,"on-change":k},{default:s(()=>[t(T,{class:"border-primary mr-16"},{default:s(()=>[C(l(n.$t("layout.about.update"))+" License ",1)]),_:1})]),_:1})),[[P,new(e(ye))("ADMIN")]])])):R("",!0)])),[[K,f.value]]),o("div",Ge,[t($,{type:"info"},{default:s(()=>[C(l(n.$t("layout.copyright")),1)]),_:1})])]}),_:1},8,["modelValue","class"])}}}),Xe={style:{"margin-top":"10px"}},je={class:"vertical-middle lighter break-all"},He={class:"mr-4"},Ye=B({__name:"APIKeyDialog",props:{userId:{type:String,default:""}},emits:["addData"],setup(O,{expose:a,emit:d}){const p=pe(),{params:{id:v}}=p,m=window.location.origin+"/doc/",f=D(),_=D(!1),A=D(!1),N=D(null);ue(_,c=>{c||(N.value=null)});function k(c){f.value.open(c,"USER")}function L(c){ge(`${E("views.applicationOverview.appInfo.APIKeyDialog.msgConfirm1")}: ${c.secretKey}?`,E(E("views.applicationOverview.appInfo.APIKeyDialog.msgConfirm2")),{confirmButtonText:E("common.confirm"),cancelButtonText:E("common.cancel"),confirmButtonClass:"color-danger"}).then(()=>{j.delAPIKey(c.id,A).then(()=>{le(E("common.deleteSuccess")),w()})}).catch(()=>{})}function V(c,$){const I={isActive:c},P=c?E("views.applicationOverview.appInfo.APIKeyDialog.enabledSuccess"):E("views.applicationOverview.appInfo.APIKeyDialog.disabledSuccess");j.putAPIKey($.id,I,A).then(K=>{le(P),w()})}function n(){j.postAPIKey(A).then(c=>{w()})}const r=()=>{w(),_.value=!0};function w(){j.getAPIKey().then(c=>{c.data.sort(($,I)=>$.name<I.name?1:-1),N.value=c.data})}function T(){w()}return a({open:r}),(c,$)=>{const I=i("el-text"),P=i("AppIcon"),K=i("el-button"),S=i("el-card"),g=i("el-table-column"),x=i("el-switch"),M=i("el-tooltip"),G=i("el-table"),F=i("el-dialog");return u(),b(F,{title:c.$t("layout.apiKey"),modelValue:_.value,"onUpdate:modelValue":$[2]||($[2]=y=>_.value=y),width:"800","close-on-click-modal":!1,"close-on-press-escape":!1},{default:s(()=>[t(S,{shadow:"never",class:"layout-bg mb-16"},{default:s(()=>[t(I,{type:"info",class:"color-secondary"},{default:s(()=>[C(l(c.$t("layout.apiServiceAddress")),1)]),_:1}),o("p",Xe,[o("span",{class:"vertical-middle lighter break-all"},l(m)),t(K,{type:"primary",text:"",onClick:$[0]||($[0]=y=>e(se)(m))},{default:s(()=>[t(P,{iconName:"app-copy"})]),_:1})])]),_:1}),t(K,{type:"primary",class:"mb-16",onClick:n},{default:s(()=>[C(l(c.$t("common.create")),1)]),_:1}),t(G,{data:N.value,class:"mb-16",loading:A.value},{default:s(()=>[t(g,{prop:"secretKey",label:"API Key"},{default:s(({row:y})=>[o("span",je,l(y.secretKey),1),t(K,{type:"primary",text:"",onClick:W=>e(se)(y.secretKey)},{default:s(()=>[t(P,{iconName:"app-copy"})]),_:2},1032,["onClick"])]),_:1}),t(g,{label:c.$t("common.status.label"),width:"80"},{default:s(({row:y})=>[o("div",{onClick:$[1]||($[1]=ae(()=>{},["stop"]))},[t(x,{size:"small",modelValue:y.isActive,"onUpdate:modelValue":W=>y.isActive=W,onChange:W=>V(W,y)},null,8,["modelValue","onUpdate:modelValue","onChange"])])]),_:1},8,["label"]),t(g,{prop:"name",label:c.$t("common.createDate"),width:"170"},{default:s(({row:y})=>[C(l(e(ve)(y.createTime)),1)]),_:1},8,["label"]),t(g,{label:c.$t("common.setting"),align:"left",width:"80"},{default:s(({row:y})=>[o("span",He,[t(M,{effect:"dark",content:c.$t("common.setting"),placement:"top"},{default:s(()=>[t(K,{type:"primary",text:"",onClick:ae(W=>k(y),["stop"])},{default:s(()=>[t(P,{iconName:"app-setting"})]),_:2},1032,["onClick"])]),_:2},1032,["content"])]),t(M,{effect:"dark",content:c.$t("common.delete"),placement:"top"},{default:s(()=>[t(K,{type:"primary",text:"",onClick:W=>L(y)},{default:s(()=>[t(P,{iconName:"app-delete"})]),_:2},1032,["onClick"])]),_:2},1032,["content"])]),_:1},8,["label"])]),_:1},8,["data","loading"]),t(Ie,{ref_key:"SettingAPIKeyDialogRef",ref:f,onRefresh:T},null,512)]),_:1},8,["title","modelValue"])}}}),qe={class:"flex-center cursor"},Je=["title"],Qe={class:"userInfo flex align-center"},Ze={class:"mr-12 flex align-center"},et={style:{width:"90%"}},tt={class:"bold mb-4",style:{"font-size":"14px"}},ot={class:"color-secondary lighter"},nt={class:"flex-between w-full"},st=B({__name:"index",setup(O){const{user:a,login:d}=Q(),p=de(),v=D(),m=D(),f=D(),_=()=>{var n;(n=v.value)==null||n.open()};function A(){m.value.open()}const N=()=>{var n;(n=f.value)==null||n.open()},k={系统管理员:"layout.about.inner_admin",工作空间管理员:"layout.about.inner_wsm",普通用户:"layout.about.inner_user"},L=J(()=>{var n,r;return a.userInfo?(r=(n=a.userInfo)==null?void 0:n.roleName)==null?void 0:r.map(w=>{const T=k[w];return T?E(T):w}):[]}),V=()=>{d.logout().then(()=>{var n;(n=a==null?void 0:a.userInfo)!=null&&n.source&&["CAS","OIDC","OAuth2"].includes(a.userInfo.source)?p.push({name:"login",query:{login_mode:"manual"}}):p.push({name:"login"})})};return he(()=>{var n,r;(n=a.userInfo)!=null&&n.isEditPassword&&((r=f.value)==null||r.open())}),(n,r)=>{var S;const w=i("el-avatar"),T=i("CaretBottom"),c=i("el-icon"),$=i("TagGroup"),I=i("el-dropdown-item"),P=i("el-dropdown-menu"),K=i("el-dropdown");return u(),U(ie,null,[t(K,{trigger:"click",type:"primary"},{dropdown:s(()=>[t(P,{class:"avatar-dropdown"},{default:s(()=>{var g,x,M;return[o("div",Qe,[o("div",Ze,[t(w,{size:30},{default:s(()=>r[2]||(r[2]=[o("img",{src:ce,style:{width:"54%"},alt:""},null,-1)])),_:1,__:[2]})]),o("div",et,[o("p",tt,[C(l((g=e(a).userInfo)==null?void 0:g.nickname)+" ",1),o("span",ot,"("+l((x=e(a).userInfo)==null?void 0:x.username)+")",1)]),(M=e(a).userInfo)!=null&&M.roleName&&e(a).userInfo.roleName.length>0?(u(),U(ie,{key:0},[e(z)([e(X).IS_EE,e(X).IS_PE],"OR")?(u(),b($,{key:0,size:"small",tags:L.value},null,8,["tags"])):R("",!0)],64)):R("",!0)])]),e(z)([e(h).EXTENDS_ADMIN,e(h).EXTENDS_WORKSPACE_MANAGE,e(h).ADMIN,e(h).WORKSPACE_MANAGE],"OR")?(u(),b(I,{key:0,class:"border-t",onClick:r[0]||(r[0]=G=>e(p).push({path:"/system/user"}))},{default:s(()=>[o("div",nt,l(n.$t("views.system.title")),1)]),_:1})):R("",!0),e(z)(new(e(H))([e(h).ADMIN,e(h).WORKSPACE_MANAGE,e(h).USER],[e(Y).CHANGE_PASSWORD],[],"OR"),"OR")?(u(),b(I,{key:1,onClick:N},{default:s(()=>[C(l(n.$t("views.login.resetPassword")),1)]),_:1})):R("",!0),o("div",null,[e(z)(new(e(H))([e(h).ADMIN],[e(Y).SYSTEM_API_KEY_EDIT],[e(X).IS_EE,e(X).IS_PE],"OR"),"OR")?(u(),b(I,{key:0,class:"p-8",onClick:A},{default:s(()=>[C(l(n.$t("layout.apiKey")),1)]),_:1})):R("",!0)]),e(z)(new(e(H))([e(h).ADMIN,e(h).USER,e(h).WORKSPACE_MANAGE],[e(Y).ABOUT_READ],[],"OR"),"OR")?(u(),b(I,{key:2,onClick:_},{default:s(()=>[C(l(n.$t("layout.about.title")),1)]),_:1})):R("",!0),t(I,{class:"border-t",onClick:V},{default:s(()=>[C(l(n.$t("layout.logout")),1)]),_:1})]}),_:1})]),default:s(()=>{var g,x;return[o("div",qe,[t(w,{size:30},{default:s(()=>r[1]||(r[1]=[o("img",{src:ce,style:{width:"54%"},alt:""},null,-1)])),_:1,__:[1]}),o("span",{class:"ml-8 color-text-primary ellipsis",title:(g=e(a).userInfo)==null?void 0:g.nickname},l((x=e(a).userInfo)==null?void 0:x.nickname),9,Je),t(c,{class:"el-icon--right"},{default:s(()=>[t(T)]),_:1})])]}),_:1}),t(Ye,{"user-id":(S=e(a).userInfo)==null?void 0:S.id,ref_key:"APIKeyDialogRef",ref:m},null,8,["user-id"]),t($e,{ref_key:"resetPasswordRef",ref:f},null,512),t(Fe,{ref_key:"AboutDialogRef",ref:v},null,512)],64)}}}),at=Z(st,[["__scopeId","data-v-79935b41"]]),lt={class:"flex align-center"},it=B({__name:"index",setup(O){const{theme:a}=Q();function d(p){window.open(p,"_blank")}return(p,v)=>{var f,_,A;const m=i("el-tooltip");return u(),U("div",lt,[(f=e(a).themeInfo)!=null&&f.showProject?(u(),b(m,{key:0,effect:"dark",content:p.$t("layout.github"),placement:"top"},{default:s(()=>[t(q,{iconName:"app-github",class:"cursor color-secondary mr-8 ml-8",style:{"font-size":"20px"},onClick:v[0]||(v[0]=N=>{var k;return d((k=e(a).themeInfo)==null?void 0:k.projectUrl)})})]),_:1},8,["content"])):R("",!0),(_=e(a).themeInfo)!=null&&_.showUserManual?(u(),b(m,{key:1,effect:"dark",content:p.$t("layout.wiki"),placement:"top"},{default:s(()=>[t(q,{iconName:"app-user-manual",class:"cursor color-secondary mr-8 ml-8",style:{"font-size":"20px"},onClick:v[1]||(v[1]=N=>{var k;return d((k=e(a).themeInfo)==null?void 0:k.userManualUrl)})})]),_:1},8,["content"])):R("",!0),(A=e(a).themeInfo)!=null&&A.showForum?(u(),b(m,{key:2,effect:"dark",content:p.$t("layout.forum"),placement:"top"},{default:s(()=>[t(q,{iconName:"app-help",class:"cursor color-secondary mr-8 ml-8",style:{"font-size":"20px"},onClick:v[2]||(v[2]=N=>{var k;return d((k=e(a).themeInfo)==null?void 0:k.forumUrl)})})]),_:1},8,["content"])):R("",!0)])}}}),ct=Z(it,[["__scopeId","data-v-f7b64438"]]),rt={class:"app-top-bar-container border-b flex-center"},ut={class:"logo mt-4"},pt={class:"flex-between w-full align-center"},dt={class:"flex align-center mr-8"},_t=B({__name:"SystemHeader",setup(O){const a=de();return(d,p)=>{const v=i("LogoFull"),m=i("el-divider"),f=i("AppIcon"),_=i("el-button");return u(),U("div",rt,[o("div",ut,[t(v)]),o("div",pt,[o("h4",null,[t(m,{class:"ml-16 mr-16",direction:"vertical"}),C(l(d.$t("views.system.title")),1)]),o("div",dt,[t(ct),t(m,{class:"ml-8 mr-8",direction:"vertical"}),e(z)([e(h).USER.getWorkspaceRole,e(h).EXTENDS_USER.getWorkspaceRole,e(h).EXTENDS_WORKSPACE_MANAGE.getWorkspaceRole,e(h).WORKSPACE_MANAGE.getWorkspaceRole],"OR")?(u(),b(_,{key:0,link:"",onClick:p[0]||(p[0]=A=>e(a).push({path:"/"})),style:{color:"var(--el-text-color-primary)"}},{default:s(()=>[t(f,{class:"mr-8",iconName:"app-workspace",style:{"font-size":"16px"}}),C(" "+l(d.$t("views.workspace.toWorkspace")),1)]),_:1})):R("",!0)])]),t(at)])}}}),vt=Z(_t,[["__scopeId","data-v-c20e3067"]]),gt=B({__name:"index",setup(O){const a=pe(),d=D([]);return be(()=>{const{name:p,meta:v}=a;p&&!d.value.includes(p)&&d.value.push(p)}),(p,v)=>{const m=i("router-view");return u(),b(m,null,{default:s(({Component:f})=>[t(Ae,{appear:"",name:"fade-transform",mode:"out-in"},{default:s(()=>[(u(),b(ke,{include:d.value},[(u(),b(we(f),{key:e(a).path}))],1032,["include"]))]),_:2},1024)]),_:1})}}});export{at as A,vt as S,ct as T,gt as _};

import{_ as h}from"./logo_lark-DULIW3z6.js";import{ay as f,bi as k,cg as w,bq as _,ba as b,aF as y,aI as e,aJ as S,bb as q}from"./chat-C--1ojLo.js";const $={class:"flex-center mb-16"},L=f({__name:"larkQrCode",props:{config:{}},setup(c){const o=k(),{params:{accessToken:d}}=o,{load:p}=w("https://lf-package-cn.feishucdn.com/obj/feishu-static/lark/passport/qrcode/LarkSSOSDKWebQRCode-1.0.3.js"),s=c,l=async()=>{if(!await p(!0)){console.error("飞书二维码 SDK 加载失败");return}const t={agentId:s.config.app_key,appSecret:s.config.app_secret},u=new URLSearchParams(o.query).toString(),m=encodeURIComponent(`${window.location.origin}/chat/api/auth/lark?accessToken=${d}&${u}`),n=`https://passport.feishu.cn/suite/passport/oauth/authorize?client_id=${t.agentId}&redirect_uri=${m}&response_type=code&state=fit2cloud-lark-qr`,i=window.QRLogin({id:"lark-qr",goto:n,width:"266",height:"266",style:"width:280px;height:280px;border:1px solid #e8e8e8;margin:0 auto;border-radius:8px;"});window.addEventListener("message",async a=>{if(i.matchOrigin(a.origin)&&i.matchData(a.data)){const g=a.data.tmp_code;window.location.replace(`${n}&tmp_code=${g}`)}})};return _(()=>{l()}),(r,t)=>(y(),b(q,null,[e("div",$,[t[0]||(t[0]=e("img",{src:h,alt:"",width:"24px",class:"mr-4"},null,-1)),e("h2",null,S(r.$t("views.system.authentication.scanTheQRCode.larkQrCode")),1)]),t[1]||(t[1]=e("div",{id:"lark-qr",class:"lark-qrName"},null,-1))],64))}});export{L as default};

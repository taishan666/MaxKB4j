import{ay as G,az as H,b8 as J,b9 as U,aB as v,bg as j,aC as w,aD as c,bq as O,bc as l,aF as a,aI as t,aH as i,aJ as _,aG as m,br as P,aK as x,bd as Q,cB as X,cC as Y,cD as Z,cE as ee,cF as te,cG as se,cH as oe,cI as ne,cJ as le,cK as ae,bo as ie,bf as W,cL as ce,bp as re,cn as de}from"./chat-BcZeCBLv.js";const _e={class:"create-knowledge p-12-24"},me={class:"flex align-center mb-16"},ue={style:{display:"inline-block"}},pe={class:"create-knowledge__main flex"},he={class:"create-knowledge__component main-calc-height"},fe={class:"upload-document p-24",style:{"min-width":"850px"}},ge={class:"title-decoration-1 mb-8"},ve={class:"mt-16 mb-16"},ke={class:"update-info flex p-8-12 border-r-6 mb-16"},be={class:"mt-4"},ye={class:"ml-16 lighter"},we={class:"card-never border-r-6 mb-16"},xe={style:{height:"calc(100vh - 450px)"}},Ce={class:"flex align-center lighter"},De={key:0,src:X,alt:"",height:"20"},Le={key:1,src:Y,alt:"",height:"22"},Ne={key:2,src:Z,alt:"",height:"22"},Ve={key:3,src:ee,alt:"",height:"22"},We={key:4,src:te,alt:"",height:"22"},Te={key:5,src:se,alt:"",height:"22"},$e={key:6,src:oe,alt:"",height:"22"},Ie={key:7,src:ne,alt:"",height:"22"},Me={key:8,src:le,alt:"",height:"22"},ze={key:9,src:ae,alt:"",height:"22"},qe={class:"ml-4"},Be={class:"create-knowledge__footer text-right border-t"},Fe=G({__name:"ImportLarkDocument",setup(Re){const C=H(),b=J(),{query:{id:T,folder_token:$}}=b,D=U(()=>b.path.includes("shared")?"systemShare":b.path.includes("resource-management")?"systemManage":"workspace"),L=T,I=$,p=v(!1),g=v(!1),N=v(!1),h=v(null),y=v({fileType:"txt",fileList:[]}),M=j({fileList:[{required:!0,message:w("views.document.upload.requiredMessage"),trigger:"change"}]}),z={label:"name",children:"zones",isLeaf:e=>e.type!=="folder",disabled:e=>e.is_exist},q=(e,o)=>{const r=e.level===0?I:e.data.token;W({type:"document",systemType:D.value}).getLarkDocumentList(L,r,{},p).then(d=>{const s=d.data.files;o(s),s.forEach(u=>{var k;u.is_exist&&((k=h.value)==null||k.setChecked(u.token,!0,!1))})}).catch(d=>{console.error("Failed to load tree nodes:",d)})},B=e=>{var o,r;e?Object.values(((o=h.value)==null?void 0:o.store.nodesMap)||{}).forEach(s=>{var u;s.disabled||(u=h.value)==null||u.setChecked(s.data,!0,!1)}):(r=h.value)==null||r.setCheckedKeys([])};function F(){var d;p.value=!0,g.value=!0;const r=(((d=h.value)==null?void 0:d.getCheckedNodes())||[]).filter(s=>!s.is_exist).map(s=>({name:s.name,token:s.token,type:s.type}));if(r.length===0){g.value=!1,ce(w("views.document.feishu.errorMessage1")),p.value=!1;return}W({type:"document",systemType:D.value}).importLarkDocument(L,r,p).then(()=>{re(w("views.document.tip.importMessage")),g.value=!1,C.go(-1)}).catch(s=>{console.error("Failed to load tree nodes:",s)}).finally(()=>{g.value=!1}),p.value=!1}return(e,o)=>{const r=c("back-button"),d=c("el-radio-button"),s=c("el-radio-group"),u=c("AppIcon"),k=c("el-checkbox"),R=c("el-tree"),A=c("el-scrollbar"),E=c("el-form"),S=c("el-card"),V=c("el-button"),K=O("loading");return a(),l("div",_e,[t("div",me,[i(r,{to:"-1",style:{"margin-left":"-4px"}}),t("h3",ue,_(e.$t("views.document.importDocument")),1)]),i(S,{style:{"--el-card-padding":"0"}},{default:m(()=>[P((a(),l("div",pe,[t("div",he,[t("div",fe,[t("h4",ge,_(e.$t("views.document.feishu.selectDocument")),1),i(E,{ref:"FormRef",model:y.value,rules:M,"label-position":"top","require-asterisk-position":"right"},{default:m(()=>[t("div",ve,[i(s,{modelValue:y.value.fileType,"onUpdate:modelValue":o[0]||(o[0]=f=>y.value.fileType=f),class:"app-radio-button-group"},{default:m(()=>[i(d,{value:"txt"},{default:m(()=>[x(_(e.$t("views.document.fileType.txt.label")),1)]),_:1})]),_:1},8,["modelValue"])]),t("div",ke,[t("div",be,[i(u,{iconName:"app-warning-colorful",style:{"font-size":"16px"}})]),t("div",ye,[t("p",null,_(e.$t("views.document.feishu.tip1")),1),t("p",null,_(e.$t("views.document.feishu.tip2")),1)])]),t("div",we,[i(k,{modelValue:N.value,"onUpdate:modelValue":o[1]||(o[1]=f=>N.value=f),label:e.$t("views.document.feishu.allCheck"),size:"large",class:"ml-24",onChange:B},null,8,["modelValue","label"])]),t("div",xe,[i(A,null,{default:m(()=>[i(R,{props:z,load:q,lazy:"","show-checkbox":"","node-key":"token",ref_key:"treeRef",ref:h},{default:m(({node:f,data:n})=>[t("div",Ce,[n.type==="folder"?(a(),l("img",De)):n.type==="docx"||n.name.endsWith(".docx")?(a(),l("img",Le)):n.type==="sheet"||n.name.endsWith(".xlsx")?(a(),l("img",Ne)):n.name.endsWith("xls")?(a(),l("img",Ve)):n.name.endsWith("csv")?(a(),l("img",We)):n.name.endsWith(".pdf")?(a(),l("img",Te)):n.name.endsWith(".html")?(a(),l("img",$e)):n.name.endsWith(".txt")?(a(),l("img",Ie)):n.name.endsWith(".zip")?(a(),l("img",Me)):n.name.endsWith(".md")?(a(),l("img",ze)):Q("",!0),t("span",qe,_(f.label),1)])]),_:1},512)]),_:1})])]),_:1},8,["model","rules"])])])])),[[K,p.value]])]),_:1}),t("div",Be,[i(V,{onClick:o[2]||(o[2]=f=>ie(C).go(-1))},{default:m(()=>[x(_(e.$t("common.cancel")),1)]),_:1}),i(V,{onClick:F,type:"primary",disabled:g.value},{default:m(()=>[x(_(e.$t("views.document.buttons.import")),1)]),_:1},8,["disabled"])])])}}}),Ee=de(Fe,[["__scopeId","data-v-fccd3d6b"]]);export{Ee as default};

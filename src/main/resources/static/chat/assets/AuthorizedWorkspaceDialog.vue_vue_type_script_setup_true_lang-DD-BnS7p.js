import{bf as T,bh as x,ay as Z,aB as p,bn as ee,aD as i,bo as te,aE as I,aF as h,aG as a,aI as d,aH as l,bp as oe,aJ as s,aK as _,ba as C,bj as ae,bb as H,bc as U}from"./chat-BvM2GaQg.js";import{l as le}from"./permission-api-9qFcLm0n.js";const v="/system/shared",se=(r,n)=>x(`${v}/knowledge/${r}/authorization`,{},n),ne=(r,n,u)=>T(`${v}/knowledge/${r}/authorization`,n,u),ie=(r,n)=>x(`${v}/tool/${r}/authorization`,{},n),re=(r,n,u)=>T(`${v}/tool/${r}/authorization`,n,u),de=(r,n)=>x(`${v}/model/${r}/authorization`,{},n),ce=(r,n,u)=>T(`${v}/model/${r}/authorization`,n,u),F={getSharedAuthorizationKnowledge:se,postSharedAuthorizationKnowledge:ne,getSharedAuthorizationTool:ie,postSharedAuthorizationTool:re,getSharedAuthorizationModel:de,postSharedAuthorizationModel:ce},ue={class:"mb-8"},pe={class:"mb-8 lighter"},he={class:"mb-8 lighter mt-16"},_e={class:"flex border",style:{overflow:"hidden"}},me={class:"border-r"},ve={class:"mt-8"},fe={class:"flex"},ge=["title"],ke={class:"w-full"},we={class:"flex-between p-16"},be={class:"lighter"},$e={class:"flex-between"},Ce={class:"flex align-center"},ye=["title"],Ae=Z({__name:"AuthorizedWorkspaceDialog",setup(r,{expose:n}){const u=p(!1),y=p(!0),c=p([]),m=p([]),g=p("WHITE_LIST"),k=p("");let L="",W="Knowledge";const z=p(!1),f=p(!1),M=ee(()=>m.value.filter(e=>e.name.includes(k.value))),P=e=>{c.value=e?m.value:[],y.value=!1,e||K()},V=e=>{const t=e.length;u.value=t===m.value.length,y.value=t>0&&t<m.value.length},j=async({id:e},t="Knowledge")=>{L=e,z.value=!0,W=t;const[w,b]=await Promise.all([F[`getSharedAuthorization${t}`](e),le("workspace").getSystemWorkspaceList()]);m.value=b.data,g.value=(w.data||{}).authentication_type||"WHITE_LIST";let A=(w.data||{}).workspace_id_list||[];c.value=m.value.filter(S=>A.includes(S.id)),V(c.value),z.value=!1,f.value=!0},G=()=>{F[`postSharedAuthorization${W}`](L,{workspace_id_list:c.value.map(e=>e.id),authentication_type:g.value}).then(()=>{f.value=!1})},J=e=>{c.value=c.value.filter(t=>t.id!==e.id)},K=()=>{c.value=[],V([])};return n({open:j}),(e,t)=>{const w=i("el-text"),b=i("el-radio"),A=i("el-radio-group"),S=i("Search"),B=i("el-icon"),q=i("el-input"),D=i("el-checkbox"),E=i("AppIcon"),O=i("el-checkbox-group"),N=i("el-scrollbar"),$=i("el-button"),Q=i("Close"),R=i("el-dialog"),X=te("loading");return h(),I(R,{"modal-class":"authorized-workspace",modelValue:f.value,"onUpdate:modelValue":t[5]||(t[5]=o=>f.value=o),width:"840"},{header:a(({titleId:o,titleClass:Y})=>[d("h4",ue,s(e.$t("views.shared.authorized_workspace")),1),l(w,{class:"color-secondary lighter"},{default:a(()=>[_(s(e.$t("views.shared.authorized_tip")),1)]),_:1})]),footer:a(()=>[l($,{onClick:t[4]||(t[4]=o=>f.value=!1)},{default:a(()=>[_(s(e.$t("common.cancel")),1)]),_:1}),l($,{type:"primary",onClick:G},{default:a(()=>[_(s(e.$t("common.save")),1)]),_:1})]),default:a(()=>[d("p",pe,s(e.$t("views.shared.type")),1),l(A,{modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=o=>g.value=o)},{default:a(()=>[l(b,{value:"WHITE_LIST"},{default:a(()=>[_(s(e.$t("views.shared.WHITE_LIST")),1)]),_:1}),l(b,{value:"BLACK_LIST"},{default:a(()=>[_(s(e.$t("views.shared.BLACK_LIST")),1)]),_:1})]),_:1},8,["modelValue"]),d("p",he,s(e.$t("views.shared.select_workspace")),1),oe((h(),C("div",_e,[d("div",me,[l(q,{modelValue:k.value,"onUpdate:modelValue":t[1]||(t[1]=o=>k.value=o),"validate-event":!1,placeholder:e.$t("common.search"),style:{width:"364px",padding:"16px 16px 0 16px"},clearable:""},{prefix:a(()=>[l(B,null,{default:a(()=>[l(S)]),_:1})]),_:1},8,["modelValue","placeholder"]),d("div",ve,[k.value?ae("",!0):(h(),I(D,{key:0,class:"mb-8",style:{"margin-left":"16px"},modelValue:u.value,"onUpdate:modelValue":t[2]||(t[2]=o=>u.value=o),indeterminate:y.value,onChange:P},{default:a(()=>[_(s(e.$t("views.shared.allCheck")),1)]),_:1},8,["modelValue","indeterminate"])),l(N,{"max-height":"205","wrap-class":"p-16 pt-0"},{default:a(()=>[l(O,{class:"checkbox-group-block",modelValue:c.value,"onUpdate:modelValue":t[3]||(t[3]=o=>c.value=o),onChange:V},{default:a(()=>[(h(!0),C(H,null,U(M.value,o=>(h(),I(D,{key:o.id,label:o.name,value:o},{default:a(()=>[d("div",fe,[l(E,{iconName:"app-workspace"}),d("span",{class:"ml-4 ellipsis",title:o.name},s(o.name),9,ge)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})])]),d("div",ke,[d("div",we,[d("span",be,s(e.$t("common.selected"))+": "+s(c.value.length)+" ä¸ª ",1),l($,{onClick:K,link:"",type:"primary"},{default:a(()=>[_(s(e.$t("common.clear")),1)]),_:1})]),l(N,{"max-height":"250","wrap-class":"p-16 pt-0"},{default:a(()=>[(h(!0),C(H,null,U(c.value,o=>(h(),C("div",$e,[d("div",Ce,[l(E,{iconName:"app-workspace"}),d("span",{class:"ml-4 lighter ellipsis",title:o.name},s(o.name),9,ye)]),l($,{link:""},{default:a(()=>[l(B,{onClick:Y=>J(o),size:18},{default:a(()=>[l(Q)]),_:2},1032,["onClick"])]),_:2},1024)]))),256))]),_:1})])])),[[X,z.value]])]),_:1},8,["modelValue"])}}});export{Ae as _};

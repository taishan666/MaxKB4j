import{aJ as oe,bm as te,aK as W,aP as m,be as F,aQ as u,aZ as me,aL as k,aM as b,aR as l,b0 as O,eB as ie,aS as t,aT as i,aW as c,a_ as A,b5 as Z,b6 as ee,b1 as ue,aV as M,fE as Q,cF as E,bi as se,b7 as pe,aO as ce,ex as fe,aU as le,fF as ve,e9 as ae}from"./chat-4wXRqTZ9.js";const _e={class:"active-breadcrumb"},be={class:"flex align-center",style:{display:"inline-flex"}},ye={class:"mr-4"},ge={class:"flex align-center",style:{display:"inline-flex"}},he={class:"mr-4"},we={class:"color-danger ml-4",style:{color:"red"}},$e={class:"flex align-center",style:{display:"inline-flex"}},ke={class:"flex-between mr-4"},Fe={class:"dialog-footer"},Ve=oe({__name:"EditModel",emits:["change","submit"],setup(ne,{expose:L,emit:U}){const N=te(),g=W(()=>N.path.includes("shared")?"systemShare":N.path.includes("resource-management")?"systemManage":"workspace"),y=m(),f=m(),R=U,V=m(!1),B=m(!1),$=m(!1),C=m(!1),I=m([]),h=m(),q=m([]),o=m([]),n=m(!1),r=m({name:{required:!0,trigger:"blur",message:F("views.model.modelForm.modelName.requiredMessage")},modelType:{required:!0,trigger:"change",message:F("views.model.modelForm.modelType.requiredMessage")},modelName:{required:!0,trigger:"change",message:F("views.model.modelForm.base_model.requiredMessage")}}),d=m({name:"",modelType:"",modelName:""}),v=m({}),_=W({get:()=>({...v.value,...d.value}),set:a=>{v.value=a}}),P=a=>{y.value&&Q.getModelCreateForm(y.value.provider,_.value.modelType,a).then(e=>{var w;o.value=e.data,h.value&&((w=f.value)==null||w.render(o.value,h.value.credential))})},S=(a,e)=>{e&&(d.value.modelName=""),y.value&&Q.listBaseModel(y.value.provider,a,C).then(w=>{q.value=w.data})},D=(a,e)=>{h.value=e,E({type:"model",systemType:g.value}).getModelById(e.id,B).then(w=>{h.value=w.data,Q.listModelType(e.provider,$).then(z=>{I.value=z.data,S(e.modelType)}),y.value=a,d.value={name:e.name,modelType:e.modelType,modelName:e.modelName},_.value=e.credential,P(e.modelName)}),n.value=!0},T=()=>{var a,e;d.value={name:"",modelType:"",modelName:""},(e=(a=f.value)==null?void 0:a.ruleFormRef)==null||e.resetFields(),v.value={},o.value=[],q.value=[],n.value=!1},p=()=>{var a;(a=f.value)==null||a.validate().then(()=>{h.value&&E({type:"model",systemType:g.value}).updateModel(h.value.id,{...d.value,credential:v.value},V).then(e=>{se(F("views.model.tip.updateSuccessMessage")),T(),R("submit")})})};return L({open:D,close:T}),(a,e)=>{const w=u("el-breadcrumb-item"),z=u("el-breadcrumb"),j=u("AppIcon"),G=u("el-tooltip"),de=u("el-input"),J=u("el-form-item"),H=u("el-option"),X=u("el-select"),Y=u("el-button"),re=u("el-dialog"),K=me("loading");return b(),k(re,{modelValue:n.value,"onUpdate:modelValue":e[6]||(e[6]=s=>n.value=s),width:"600px","close-on-click-modal":!1,"close-on-press-escape":!1,"destroy-on-close":!0,"before-close":T},{header:l(({close:s,titleId:qe,titleClass:Pe})=>[t(z,{separator:">"},{default:l(()=>[t(w,null,{default:l(()=>{var x;return[i("span",_e,c(`${a.$t("common.edit")} ${(x=y.value)==null?void 0:x.name}`),1)]}),_:1})]),_:1})]),footer:l(()=>[i("span",Fe,[t(Y,{onClick:T},{default:l(()=>[M(c(a.$t("common.cancel")),1)]),_:1}),t(Y,{type:"primary",onClick:p,loading:V.value},{default:l(()=>[M(c(a.$t("common.modify")),1)]),_:1},8,["loading"])])]),default:l(()=>[O((b(),k(ie,{modelValue:_.value,"onUpdate:modelValue":e[5]||(e[5]=s=>_.value=s),render_data:o.value,model:_.value,ref_key:"dynamicsFormRef",ref:f,"label-position":"top","require-asterisk-position":"right"},{default:l(()=>[t(J,{prop:"name",rules:r.value.name},{label:l(()=>[i("div",be,[i("div",ye,[i("span",null,c(a.$t("views.model.modelForm.modelName.label")),1)]),t(G,{effect:"dark",placement:"right"},{content:l(()=>[i("p",null,c(a.$t("views.model.modelForm.modelName.tooltip")),1)]),default:l(()=>[t(j,{iconName:"app-warning",class:"app-warning-icon"})]),_:1})])]),default:l(()=>[t(de,{modelValue:d.value.name,"onUpdate:modelValue":e[0]||(e[0]=s=>d.value.name=s),maxlength:"64","show-word-limit":"",placeholder:a.$t("views.model.modelForm.modelName.placeholder")},null,8,["modelValue","placeholder"])]),_:1},8,["rules"]),t(J,{prop:"modelType",rules:r.value.modelType},{label:l(()=>[i("span",null,c(a.$t("views.model.modelForm.modelType.label")),1)]),default:l(()=>[O((b(),k(X,{disabled:"",onChange:e[1]||(e[1]=s=>S(s,!0)),modelValue:d.value.modelType,"onUpdate:modelValue":e[2]||(e[2]=s=>d.value.modelType=s),class:"w-full m-2",placeholder:a.$t("views.model.modelForm.modelType.placeholder")},{default:l(()=>[(b(!0),A(Z,null,ee(I.value,s=>(b(),k(H,{key:s.value,label:s.key,value:s.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])),[[K,$.value]])]),_:1},8,["rules"]),t(J,{prop:"modelName",rules:r.value.modelName},{label:l(()=>[i("div",ge,[i("div",he,[i("span",null,c(a.$t("views.model.modelForm.base_model.label")),1),i("span",we,c(a.$t("views.model.modelForm.base_model.tooltip")),1)])])]),default:l(()=>[O((b(),k(X,{onChange:e[3]||(e[3]=s=>P(s)),modelValue:d.value.modelName,"onUpdate:modelValue":e[4]||(e[4]=s=>d.value.modelName=s),class:"w-full m-2",placeholder:a.$t("views.model.modelForm.base_model.requiredMessage"),filterable:"","allow-create":"","default-first-option":""},{default:l(()=>[(b(!0),A(Z,null,ee(q.value,s=>(b(),k(H,{key:s.name,value:s.name},{default:l(()=>[i("div",$e,[i("div",ke,[i("span",null,c(s.name),1)]),s.desc?(b(),k(G,{key:0,effect:"dark",placement:"right"},{content:l(()=>[i("p",null,c(s.desc),1)]),default:l(()=>[t(j,{iconName:"app-warning",class:"app-warning-icon"})]),_:2},1024)):ue("",!0)])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","placeholder"])),[[K,C.value]])]),_:1},8,["rules"])]),_:1},8,["modelValue","render_data","model"])),[[K,B.value]])]),_:1},8,["modelValue"])}}}),Ae=pe(Ve,[["__scopeId","data-v-228e9acd"]]),Te={key:0},Me={key:1},Ne={class:"mr-4"},Ce={class:"dialog-footer"},Ue=oe({__name:"ParamSettingDialog",setup(ne,{expose:L}){const U=te(),N=W(()=>U.path.includes("shared")?"systemShare":U.path.includes("resource-management")?"systemManage":"workspace"),g=m(!1),y=m(!1),f=m([]),R=m(),V=m(null),B=o=>{V.value=o,y.value=!0,g.value=!0,E({type:"model",systemType:N.value}).getModelParamsForm(o.id,g).then(n=>{g.value=!1,f.value=n.data}).catch(()=>{g.value=!1})},$=()=>{y.value=!1};function C(o,n){var r;(r=R.value)==null||r.open(o,n)}function I(o){f.value.splice(o,1)}function h(o,n){for(let r=0;r<f.value.length;r++){const d=f.value[r].field;let v=f.value[r].label;v&&v.input_type==="TooltipLabel"&&(v=v.label);let _=o.label;if(_&&_.input_type==="TooltipLabel"&&(_=_.label),d===o.field&&n!==r){ae(F("views.model.tip.errorMessage")+o.field);return}if(v===_&&n!==r){ae(F("views.model.tip.errorMessage")+v);return}}n!==null?f.value.splice(n,1,o):f.value.push(o)}function q(){V.value&&E({type:"model",systemType:N.value}).updateModelParamsForm(V.value.id,f.value,g).then(o=>{se(F("views.model.tip.saveSuccessMessage")),$()})}return L({open:B,close:$}),(o,n)=>{const r=u("el-button"),d=u("el-table-column"),v=u("el-tag"),_=u("el-switch"),P=u("AppIcon"),S=u("el-tooltip"),D=u("el-table"),T=u("el-dialog");return b(),A(Z,null,[t(T,{title:o.$t("views.model.modelForm.title.paramSetting"),modelValue:y.value,"onUpdate:modelValue":n[2]||(n[2]=p=>y.value=p),width:"800px","close-on-click-modal":!1,"close-on-press-escape":!1,"destroy-on-close":!0,"before-close":$},{footer:l(()=>[i("span",Ce,[t(r,{onClick:$},{default:l(()=>[M(c(o.$t("common.cancel")),1)]),_:1}),t(r,{type:"primary",onClick:q,loading:g.value},{default:l(()=>[M(c(o.$t("common.save")),1)]),_:1},8,["loading"])])]),default:l(()=>[t(r,{type:"primary",onClick:n[0]||(n[0]=p=>C()),class:"mb-12"},{default:l(()=>[M(c(o.$t("common.param.addParam")),1)]),_:1}),t(D,{data:f.value,class:"mb-16"},{default:l(()=>[t(d,{prop:"label",label:o.$t("dynamicsForm.paramForm.name.label"),"show-overflow-tooltip":""},{default:l(({row:p})=>[p.label&&p.label.input_type==="TooltipLabel"?(b(),A("span",Te,c(p.label.label),1)):(b(),A("span",Me,c(p.label),1))]),_:1},8,["label"]),t(d,{prop:"field",label:o.$t("dynamicsForm.paramForm.field.label"),"show-overflow-tooltip":""},null,8,["label"]),t(d,{label:o.$t("dynamicsForm.paramForm.input_type.label"),width:"110px"},{default:l(({row:p})=>[t(v,{type:"info",class:"info-tag"},{default:l(()=>{var a;return[M(c((a=ce(fe).find(e=>e.value===p.input_type))==null?void 0:a.label),1)]}),_:2},1024)]),_:1},8,["label"]),t(d,{prop:"default_value",label:o.$t("dynamicsForm.default.label"),"show-overflow-tooltip":""},null,8,["label"]),t(d,{label:o.$t("common.required")},{default:l(({row:p})=>[i("div",{onClick:n[1]||(n[1]=le(()=>{},["stop"]))},[t(_,{disabled:"",size:"small",modelValue:p.required,"onUpdate:modelValue":a=>p.required=a},null,8,["modelValue","onUpdate:modelValue"])])]),_:1},8,["label"]),t(d,{label:o.$t("common.operation"),align:"left",width:"90"},{default:l(({row:p,$index:a})=>[i("span",Ne,[t(S,{effect:"dark",content:o.$t("common.modify"),placement:"top"},{default:l(()=>[t(r,{type:"primary",text:"",onClick:le(e=>C(p,a),["stop"])},{default:l(()=>[t(P,{iconName:"app-edit"})]),_:2},1032,["onClick"])]),_:2},1032,["content"])]),t(S,{effect:"dark",content:o.$t("common.delete"),placement:"top"},{default:l(()=>[t(r,{type:"primary",text:"",onClick:e=>I(a)},{default:l(()=>[t(P,{iconName:"app-delete"})]),_:2},1032,["onClick"])]),_:2},1032,["content"])]),_:1},8,["label"])]),_:1},8,["data"])]),_:1},8,["title","modelValue"]),t(ve,{ref_key:"AddParamRef",ref:R,onRefresh:h},null,512)],64)}}});export{Ae as E,Ue as _};

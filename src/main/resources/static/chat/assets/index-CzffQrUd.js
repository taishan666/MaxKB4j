import{ay as X,b9 as O,aD as r,bc as V,aF as m,aI as o,aH as e,dm as re,aJ as i,aG as t,aK as u,cn as Y,aA as ue,az as de,dc as me,aB as $,aC as y,bg as ce,bs as pe,dn as K,bk as N,bq as J,br as Q,bo as C,bd as j,bh as he,bi as _e,aE as D,bj as fe,bS as ge,c2 as ve,c1 as be,c3 as we,cf as $e,dp as ye,dq as W,dr as Ve,bp as Te}from"./chat-BcZeCBLv.js";import{a as ke,L as Pe}from"./LoginContainer-BX6DfjY4.js";const Le={class:"login-preview mr-16 white-bg"},Ue={class:"header"},Ce={class:"tag flex-between"},De={class:"flex align-center"},Se=["src"],ze={key:1,src:re,height:"24px",class:"mr-8"},Fe={class:"ellipsis"},Re={class:"mb-24"},Ne={class:"mb-24"},je={class:"mb-24"},Ie={class:"operate-container flex-between mt-12"},Me=X({__name:"LoginPreview",props:{data:{type:Object,default:null}},setup(S){const d=S,c=O(()=>d.data.icon?typeof d.data.icon=="string"?d.data.icon:URL.createObjectURL(d.data.icon):"");return(h,T)=>{const z=r("Close"),b=r("el-icon"),a=r("el-input"),_=r("el-form-item"),k=r("el-form"),F=r("el-button");return m(),V("div",Le,[o("div",Ue,[o("div",Ce,[o("div",De,[d.data.icon?(m(),V("img",{key:0,src:c.value,alt:"",height:"20px",class:"mr-8"},null,8,Se)):(m(),V("img",ze)),o("span",Fe,i(S.data.title),1)]),e(b,null,{default:t(()=>[e(z)]),_:1})])]),e(ke,{style:{height:"530px"},lang:!1},{default:t(()=>[e(Pe,{subTitle:S.data.slogan,class:"login-container"},{default:t(()=>[T[0]||(T[0]=o("div",{class:"mask"},null,-1)),o("h2",Re,i(h.$t("views.login.title")),1),e(k,{class:"login-form"},{default:t(()=>[o("div",Ne,[e(_,null,{default:t(()=>[e(a,{size:"large",class:"input-item",placeholder:h.$t("views.login.loginForm.username.placeholder")},null,8,["placeholder"])]),_:1})]),o("div",je,[e(_,null,{default:t(()=>[e(a,{type:"password",size:"large",class:"input-item",placeholder:h.$t("views.login.loginForm.password.placeholder"),"show-password":""},null,8,["placeholder"])]),_:1})])]),_:1}),e(F,{size:"large",type:"primary",class:"w-full"},{default:t(()=>[u(i(h.$t("views.login.buttons.login")),1)]),_:1}),o("div",Ie,[e(F,{class:"forgot-password",link:"",type:"primary"},{default:t(()=>[u(i(h.$t("views.login.forgotPassword"))+"? ",1)]),_:1})])]),_:1,__:[0]},8,["subTitle"])]),_:1})])}}}),Ae=Y(Me,[["__scopeId","data-v-2077f61a"]]),Be={class:"theme-setting p-16-24"},Ee={class:"ml-4 color-text-primary"},qe={class:"mb-16"},Oe={key:0},xe={class:"mt-16 mb-8"},He={class:"mb-16"},Ge={class:"flex-between"},Ke={class:"mb-16"},Je={class:"theme-preview"},Qe={class:"theme-form"},We={class:"flex-between mb-8"},Xe={class:"lighter"},Ye={class:"flex-between mb-8"},Ze={class:"lighter"},el={class:"flex-between mb-8"},ll={class:"lighter"},tl={class:"mt-16"},ol={class:"mb-16"},al={class:"flex-between"},sl={class:"mb-16"},nl={class:"theme-preview"},il={class:"theme-platform mr-16"},rl={class:"flex-center h-full"},ul={class:"app-title-container cursor"},dl={class:"logo flex-center"},ml={class:"flex-center"},cl={class:"theme-form"},pl={class:"ml-24"},hl={class:"mt-4"},_l={class:"ml-24"},fl={class:"mt-4"},gl={class:"ml-24"},vl={class:"mt-16"},bl={class:"theme-setting__operate w-full p-16-24"},wl=X({__name:"index",setup(S){const{theme:d}=ue();de(),me((l,s)=>{d.setTheme(b.value)});const c=O(()=>d.themeInfo),h=O(()=>d.isDefaultTheme()),T=$(),z=$(!1),b=$(null),a=$({theme:"",icon:"",loginLogo:"",loginImage:"",title:"MaxKB",slogan:y("theme.defaultSlogan"),...W}),_=$(""),k=$(""),F=ce({title:[{required:!0,message:y("theme.websiteNamePlaceholder"),trigger:"blur"}],slogan:[{required:!0,message:y("theme.websiteSloganPlaceholder"),trigger:"blur"}]}),I=(l,s,w)=>{if((l==null?void 0:l.size)/1024/1024<10)a.value[w]=l.raw;else return $e(y("theme.fileMessageError")),!1;d.setTheme(a.value)};function Z(l){l!=="custom"&&(a.value.theme=l,d.setTheme(a.value))}function ee(l){a.value.theme=l,d.setTheme(a.value)}function le(){d.setTheme(b.value),a.value=N.cloneDeep(c.value)}function x(l){a.value=l==="login"?{...a.value,theme:a.value.theme,...ye}:{...a.value,theme:a.value.theme,...W},d.setTheme(a.value)}const te=async(l,s)=>{l&&await l.validate((w,M)=>{if(w){const P=new FormData;Object.keys(a.value).map(L=>{P.append(L,a.value[L])}),Ve.postThemeInfo(P,z).then(L=>{d.theme(),b.value=N.cloneDeep(a.value),Te(y("theme.saveSuccess"))})}})};return pe(()=>{c.value&&(_.value=K.some(l=>l.value===c.value.theme)?c.value.theme:"custom",k.value=c.value.theme,a.value=N.cloneDeep(c.value),b.value=N.cloneDeep(c.value))}),(l,s)=>{const w=r("el-breadcrumb-item"),M=r("el-breadcrumb"),P=r("el-radio-button"),L=r("el-radio-group"),oe=r("el-color-picker"),p=r("el-card"),f=r("el-button"),R=r("el-col"),A=r("el-upload"),g=r("el-text"),U=r("el-input"),H=r("el-form-item"),ae=r("el-form"),G=r("el-row"),B=r("el-scrollbar"),se=r("LogoFull"),E=r("AppIcon"),q=r("el-checkbox"),ne=J("hasPermission"),ie=J("loading");return Q((m(),V("div",Be,[e(M,{"separator-icon":"ArrowRight",class:"mb-16"},{default:t(()=>[e(w,null,{default:t(()=>[u(i(C(y)("views.system.subTitle")),1)]),_:1}),e(w,null,{default:t(()=>[o("h5",Ee,i(l.$t("theme.title")),1)]),_:1})]),_:1}),e(B,null,{default:t(()=>[e(p,{style:{"--el-card-padding":"16px"}},{default:t(()=>[o("h5",qe,i(l.$t("theme.platformDisplayTheme")),1),e(L,{modelValue:_.value,"onUpdate:modelValue":s[0]||(s[0]=n=>_.value=n),class:"app-radio-button-group",onChange:Z},{default:t(()=>[(m(!0),V(he,null,_e(C(K),(n,v)=>(m(),D(P,{key:v,label:n.label,value:n.value},null,8,["label","value"]))),128)),e(P,{label:l.$t("theme.custom"),value:"custom"},null,8,["label"])]),_:1},8,["modelValue"]),_.value==="custom"?(m(),V("div",Oe,[o("h5",xe,i(l.$t("theme.customTheme")),1),e(oe,{modelValue:k.value,"onUpdate:modelValue":s[1]||(s[1]=n=>k.value=n),onChange:ee},null,8,["modelValue"])])):j("",!0)]),_:1}),e(p,{style:{"--el-card-padding":"16px"},class:"mt-16"},{default:t(()=>[o("h5",He,i(l.$t("theme.platformLoginSettings")),1),e(p,{shadow:"never",class:"layout-bg"},{default:t(()=>[o("div",Ge,[o("h5",Ke,i(l.$t("theme.pagePreview")),1),e(f,{type:"primary",link:"",onClick:s[2]||(s[2]=n=>x("login"))},{default:t(()=>[u(i(l.$t("theme.restoreDefaults")),1)]),_:1})]),e(B,null,{default:t(()=>[o("div",Je,[e(G,{gutter:8},{default:t(()=>[e(R,{span:16},{default:t(()=>[e(Ae,{data:a.value},null,8,["data"])]),_:1}),e(R,{span:8},{default:t(()=>[o("div",Qe,[e(p,{shadow:"never",class:"mb-8"},{default:t(()=>[o("div",We,[o("span",Xe,i(l.$t("theme.websiteLogo")),1),e(A,{ref:"uploadRef",action:"#","auto-upload":!1,"show-file-list":!1,accept:"image/jpeg, image/png, image/gif","on-change":(n,v)=>I(n,v,"icon")},{default:t(()=>[e(f,{size:"small"},{default:t(()=>[u(i(l.$t("theme.replacePicture")),1)]),_:1})]),_:1},8,["on-change"])]),e(g,{type:"info",size:"small"},{default:t(()=>[u(i(l.$t("theme.websiteLogoTip")),1)]),_:1})]),_:1}),e(p,{shadow:"never",class:"mb-8"},{default:t(()=>[o("div",Ye,[o("span",Ze,i(l.$t("theme.loginLogo")),1),e(A,{ref:"uploadRef",action:"#","auto-upload":!1,"show-file-list":!1,accept:"image/jpeg, image/png, image/gif","on-change":(n,v)=>I(n,v,"loginLogo")},{default:t(()=>[e(f,{size:"small"},{default:t(()=>[u(i(l.$t("theme.replacePicture")),1)]),_:1})]),_:1},8,["on-change"])]),e(g,{type:"info",size:"small"},{default:t(()=>[u(i(l.$t("theme.loginLogoTip")),1)]),_:1})]),_:1}),e(p,{shadow:"never",class:"mb-8"},{default:t(()=>[o("div",el,[o("span",ll,i(l.$t("theme.loginBackground")),1),e(A,{ref:"uploadRef",action:"#","auto-upload":!1,"show-file-list":!1,accept:"image/jpeg, image/png, image/gif","on-change":(n,v)=>I(n,v,"loginImage")},{default:t(()=>[e(f,{size:"small"},{default:t(()=>[u(i(l.$t("theme.replacePicture")),1)]),_:1})]),_:1},8,["on-change"])]),e(g,{type:"info",size:"small"},{default:t(()=>[u(i(l.$t("theme.loginBackgroundTip")),1)]),_:1})]),_:1}),e(ae,{ref_key:"themeFormRef",ref:T,model:a.value,"label-position":"top","require-asterisk-position":"right",rules:F,onSubmit:s[5]||(s[5]=fe(()=>{},["prevent"]))},{default:t(()=>[e(H,{label:l.$t("theme.websiteName"),prop:"title"},{default:t(()=>[e(U,{modelValue:a.value.title,"onUpdate:modelValue":s[3]||(s[3]=n=>a.value.title=n),placeholder:l.$t("theme.websiteNamePlaceholder"),"show-word-limit":"",maxlength:"128"},null,8,["modelValue","placeholder"]),e(g,{type:"info"},{default:t(()=>[u(i(l.$t("theme.websiteNameTip")),1)]),_:1})]),_:1},8,["label"]),e(H,{label:l.$t("theme.websiteSlogan"),prop:"slogan"},{default:t(()=>[e(U,{modelValue:a.value.slogan,"onUpdate:modelValue":s[4]||(s[4]=n=>a.value.slogan=n),placeholder:l.$t("theme.websiteSloganPlaceholder"),maxlength:"64","show-word-limit":""},null,8,["modelValue","placeholder"]),e(g,{type:"info"},{default:t(()=>[u(i(l.$t("theme.websiteSloganTip")),1)]),_:1})]),_:1},8,["label"])]),_:1},8,["model","rules"])])]),_:1})]),_:1})])]),_:1}),o("div",tl,[e(g,{type:"info"},{default:t(()=>[u(i(l.$t("theme.logoDefaultTip")),1)]),_:1})])]),_:1})]),_:1}),e(p,{style:{"--el-card-padding":"16px"},class:"mt-16"},{default:t(()=>[o("h5",ol,i(l.$t("theme.platformSetting")),1),e(p,{shadow:"never",class:"layout-bg"},{default:t(()=>[o("div",al,[o("h5",sl,i(l.$t("theme.pagePreview")),1),e(f,{type:"primary",link:"",onClick:s[6]||(s[6]=n=>x("platform"))},{default:t(()=>[u(i(l.$t("theme.restoreDefaults")),1)]),_:1})]),e(B,null,{default:t(()=>[o("div",nl,[e(G,{gutter:8},{default:t(()=>[e(R,{span:16},{default:t(()=>[o("div",il,[o("div",{class:ge(["theme-platform-header border-b flex-between",h.value?"":"custom-header"])},[o("div",rl,[o("div",ul,[o("div",dl,[e(se,{height:"25px"})])])]),o("div",ml,[a.value.showProject?(m(),D(E,{key:0,iconName:"app-github",class:"cursor color-secondary mr-8 ml-8",style:{"font-size":"20px"}})):j("",!0),a.value.showUserManual?(m(),D(E,{key:1,iconName:"app-user-manual",class:"cursor color-secondary mr-8 ml-8",style:{"font-size":"20px"}})):j("",!0),a.value.showForum?(m(),D(E,{key:2,iconName:"app-help",class:"cursor color-secondary ml-8",style:{"font-size":"20px"}})):j("",!0)])],2)])]),_:1}),e(R,{span:8},{default:t(()=>[o("div",cl,[o("div",null,[e(q,{modelValue:a.value.showUserManual,"onUpdate:modelValue":s[7]||(s[7]=n=>a.value.showUserManual=n),label:l.$t("theme.showUserManual")},null,8,["modelValue","label"]),o("div",pl,[e(U,{modelValue:a.value.userManualUrl,"onUpdate:modelValue":s[8]||(s[8]=n=>a.value.userManualUrl=n),placeholder:l.$t("theme.urlPlaceholder"),"show-word-limit":"",maxlength:"128"},null,8,["modelValue","placeholder"])])]),o("div",hl,[e(q,{modelValue:a.value.showForum,"onUpdate:modelValue":s[9]||(s[9]=n=>a.value.showForum=n),label:l.$t("theme.showForum")},null,8,["modelValue","label"]),o("div",_l,[e(U,{modelValue:a.value.forumUrl,"onUpdate:modelValue":s[10]||(s[10]=n=>a.value.forumUrl=n),placeholder:l.$t("theme.urlPlaceholder"),"show-word-limit":"",maxlength:"128"},null,8,["modelValue","placeholder"])])]),o("div",fl,[e(q,{modelValue:a.value.showProject,"onUpdate:modelValue":s[11]||(s[11]=n=>a.value.showProject=n),label:l.$t("theme.showProject")},null,8,["modelValue","label"]),o("div",gl,[e(U,{modelValue:a.value.projectUrl,"onUpdate:modelValue":s[12]||(s[12]=n=>a.value.projectUrl=n),placeholder:l.$t("theme.urlPlaceholder"),"show-word-limit":"",maxlength:"128"},null,8,["modelValue","placeholder"])])])])]),_:1})]),_:1})])]),_:1}),o("div",vl,[e(g,{type:"info"},{default:t(()=>[u(i(l.$t("theme.defaultTip")),1)]),_:1})])]),_:1})]),_:1})]),_:1}),o("div",bl,[e(f,{onClick:le},{default:t(()=>[u(i(l.$t("theme.abandonUpdate")),1)]),_:1}),Q((m(),D(f,{type:"primary",onClick:s[13]||(s[13]=n=>te(T.value))},{default:t(()=>[u(i(l.$t("theme.saveAndApply")),1)]),_:1})),[[ne,new(C(ve))([C(be).ADMIN],[C(we).APPEARANCE_SETTINGS_EDIT],[],"OR")]])])])),[[ie,z.value]])}}}),Vl=Y(wl,[["__scopeId","data-v-41cef248"]]);export{Vl as default};

import{ay as de,b9 as ee,b8 as ve,aB as n,c4 as xe,aE as D,aG as e,aD as t,aH as l,bV as Te,aI as r,bd as X,aK as C,aJ as p,bj as re,bf as ce,aF as y,aC as oe,bg as De,ba as ne,cc as Ue,bk as Le,br as ue,bq as he,bS as me,cv as ge,aA as ye,e2 as Ae,bc as le,bi as $e,bh as be,cl as Re,c6 as Ve,e3 as Se,cg as qe,bo as Ie,ca as Pe,dy as Fe,bb as Ne,cU as ze,cx as Ce,cV as Oe,e4 as He,b_ as ke,cr as Ke,ce as Ee,cf as Be,co as We}from"./chat-BFw4auTk.js";const Ge={class:"dialog-footer"},Yl=de({__name:"AIModeParamSettingDialog",emits:["refresh"],setup(se,{expose:E,emit:B}){const q=ve(),L=ee(()=>q.path.includes("resource-management")?"systemManage":"workspace"),M=n([]),I=B,F=n(),i=n({}),d=n(!1),c=n(!1),v=(o,u)=>ce({type:"model",systemType:L.value}).getModelParamsForm(o,c),f=n(""),g=ee(()=>xe.model[L.value]),A=(o,u,_)=>{f.value=o,i.value={},v(o).then(V=>{var w;M.value=V.data,(w=F.value)==null||w.render(M.value,_)}),d.value=!0},x=(o,u)=>{v(o).then($=>{M.value=$.data;const V=$.data.map(w=>w.show_default_value===!1?{[w.field]:void 0}:{[w.field]:w.default_value}).reduce((w,h)=>({...w,...h}),{});I("refresh",V)})},N=async()=>{var o;(o=F.value)==null||o.validate().then(()=>{I("refresh",i.value),d.value=!1})};return E({open:A,reset_default:x}),(o,u)=>{const _=t("el-button"),$=t("el-dialog");return y(),D($,{"align-center":"",title:o.$t("common.paramSetting"),modelValue:d.value,"onUpdate:modelValue":u[2]||(u[2]=V=>d.value=V),style:{width:"550px"},"append-to-body":"","destroy-on-close":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:e(()=>[r("span",Ge,[l(_,{onClick:u[1]||(u[1]=re(V=>d.value=!1,["prevent"]))},{default:e(()=>[C(p(o.$t("common.cancel")),1)]),_:1}),g.value.paramSetting(f.value)?(y(),D(_,{key:0,type:"primary",onClick:N,loading:c.value},{default:e(()=>[C(p(o.$t("common.confirm")),1)]),_:1},8,["loading"])):X("",!0)])]),default:e(()=>[l(Te,{modelValue:i.value,"onUpdate:modelValue":u[0]||(u[0]=V=>i.value=V),model:i.value,"label-position":"top","require-asterisk-position":"right",render_data:M.value,ref_key:"dynamicsFormRef",ref:F},null,8,["modelValue","model","render_data"])]),_:1},8,["title","modelValue"])}}}),je={class:"p-8"},Je={class:"mb-4"},Qe={class:"mb-4"},Xe={class:"mb-4"},Ye={class:"flex align-center"},Ze={class:"mr-4"},el={class:"flex align-center"},ll={class:"mr-4"},al={class:"dialog-footer"},Zl=de({__name:"ParamSettingDialog",emits:["refresh"],setup(se,{expose:E,emit:B}){const q=B,L=n(),M=n(),I={ai_questioning:"{question}",designated_answer:oe("views.application.dialog.designated_answer")},F=oe("views.application.dialog.defaultPrompt1",{question:"{question}"})+"<data></data>"+oe("views.application.dialog.defaultPrompt2"),i=n({knowledgeSetting:{searchMode:"embedding",topN:3,similarity:.6,maxParagraphCharNumber:5e3,noReferencesSetting:{status:"ai_questioning",value:"{question}"}},problemOptimization:!1,problemOptimizationPrompt:F}),d=n({ai_questioning:I.ai_questioning,designated_answer:I.designated_answer}),c=De({ai_questioning:[{required:!0,message:oe("views.application.form.aiModel.placeholder"),trigger:"blur"}],designated_answer:[{required:!0,message:oe("views.application.form.prompt.requiredMessage"),trigger:"blur"}]}),v=n(!1),f=n(!1),g=n(!1);ne(v,o=>{var u;o||(d.value={ai_questioning:I.ai_questioning,designated_answer:I.designated_answer},(u=M.value)==null||u.clearValidate())});const A=(o,u)=>{g.value=Ue(u),i.value={knowledgeSetting:Le.cloneDeep(o.knowledgeSetting),problemOptimization:o.problemOptimization,problemOptimizationPrompt:o.problemOptimizationPrompt},g.value||(d.value[i.value.knowledgeSetting.noReferencesSetting.status]=i.value.knowledgeSetting.noReferencesSetting.value),v.value=!0},x=async o=>{if(g.value)delete i.value.noReferencesSetting,q("refresh",i.value),v.value=!1;else{if(!o)return;await o.validate((u,_)=>{u&&(i.value.knowledgeSetting.noReferencesSetting.value=d.value[i.value.knowledgeSetting.noReferencesSetting.status],q("refresh",i.value),v.value=!1)})}};function N(o){o==="keywords"?i.value.knowledgeSetting.similarity=0:i.value.knowledgeSetting.similarity=.6}return E({open:A}),(o,u)=>{const _=t("el-text"),$=t("el-radio"),V=t("el-card"),w=t("el-radio-group"),h=t("el-form-item"),T=t("el-tooltip"),S=t("el-input-number"),H=t("el-col"),b=t("el-row"),a=t("el-slider"),m=t("el-input"),P=t("el-form"),W=t("el-switch"),Q=t("el-scrollbar"),K=t("el-button"),ae=t("el-dialog"),te=he("loading");return y(),D(ae,{class:"scrollbar-dialog","align-center":"",title:o.$t("common.paramSetting"),modelValue:v.value,"onUpdate:modelValue":u[11]||(u[11]=R=>v.value=R),width:"550px","append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:e(()=>[r("span",al,[l(K,{onClick:u[9]||(u[9]=re(R=>v.value=!1,["prevent"]))},{default:e(()=>[C(p(o.$t("common.cancel")),1)]),_:1}),l(K,{type:"primary",onClick:u[10]||(u[10]=R=>x(M.value)),loading:f.value},{default:e(()=>[C(p(o.$t("common.save")),1)]),_:1},8,["loading"])])]),default:e(()=>[l(Q,{"max-height":"550"},{default:e(()=>[r("div",je,[ue((y(),D(P,{"label-position":"top",ref_key:"paramFormRef",ref:L,model:i.value},{default:e(()=>[l(h,{label:o.$t("views.application.dialog.selectSearchMode")},{default:e(()=>[l(w,{modelValue:i.value.knowledgeSetting.searchMode,"onUpdate:modelValue":u[0]||(u[0]=R=>i.value.knowledgeSetting.searchMode=R),class:"card__radio",onChange:N},{default:e(()=>[l(V,{shadow:"never",class:me(["mb-16",i.value.searchMode==="embedding"?"active":""])},{default:e(()=>[l($,{value:"embedding",size:"large"},{default:e(()=>[r("p",Je,p(o.$t("views.application.dialog.vectorSearch")),1),l(_,{type:"info"},{default:e(()=>[C(p(o.$t("views.application.dialog.vectorSearchTooltip")),1)]),_:1})]),_:1})]),_:1},8,["class"]),l(V,{shadow:"never",class:me(["mb-16",i.value.knowledgeSetting.searchMode==="keywords"?"active":""])},{default:e(()=>[l($,{value:"keywords",size:"large"},{default:e(()=>[r("p",Qe,p(o.$t("views.application.dialog.fullTextSearch")),1),l(_,{type:"info"},{default:e(()=>[C(p(o.$t("views.application.dialog.fullTextSearchTooltip")),1)]),_:1})]),_:1})]),_:1},8,["class"]),l(V,{shadow:"never",class:me(i.value.knowledgeSetting.searchMode==="hybrid"?"active":"")},{default:e(()=>[l($,{value:"hybrid",size:"large"},{default:e(()=>[r("p",Xe,p(o.$t("views.application.dialog.hybridSearch")),1),l(_,{type:"info"},{default:e(()=>[C(p(o.$t("views.application.dialog.hybridSearchTooltip")),1)]),_:1})]),_:1})]),_:1},8,["class"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(b,{gutter:10},{default:e(()=>[l(H,{span:12},{default:e(()=>[l(h,null,{label:e(()=>[r("div",Ye,[r("span",Ze,p(o.$t("views.application.dialog.similarityThreshold")),1),l(T,{effect:"dark",content:o.$t("views.application.dialog.similarityTooltip"),placement:"right"},{default:e(()=>[l(ge,{iconName:"app-warning",class:"app-warning-icon"})]),_:1},8,["content"])])]),default:e(()=>[l(S,{modelValue:i.value.knowledgeSetting.similarity,"onUpdate:modelValue":u[1]||(u[1]=R=>i.value.knowledgeSetting.similarity=R),min:0,max:i.value.knowledgeSetting.searchMode==="hybrid"?2:1,precision:3,step:.1,"value-on-clear":0,"controls-position":"right",class:"w-full"},null,8,["modelValue","max"])]),_:1})]),_:1}),l(H,{span:12},{default:e(()=>[l(h,{label:o.$t("views.application.dialog.topReferences")},{default:e(()=>[l(S,{modelValue:i.value.knowledgeSetting.topN,"onUpdate:modelValue":u[2]||(u[2]=R=>i.value.knowledgeSetting.topN=R),min:1,max:1e4,"value-on-clear":1,"controls-position":"right",class:"w-full"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),l(h,{label:o.$t("views.application.dialog.maxCharacters")},{default:e(()=>[l(a,{modelValue:i.value.knowledgeSetting.maxParagraphCharNumber,"onUpdate:modelValue":u[3]||(u[3]=R=>i.value.knowledgeSetting.maxParagraphCharNumber=R),"show-input":"","show-input-controls":!1,min:500,max:1e5,class:"custom-slider"},null,8,["modelValue"])]),_:1},8,["label"]),g.value?X("",!0):(y(),D(h,{key:0,label:o.$t("views.application.dialog.noReferencesAction")},{default:e(()=>[l(P,{"label-position":"top",ref_key:"noReferencesFormRef",ref:M,model:d.value,rules:c,"hide-required-asterisk":!0,class:"w-full"},{default:e(()=>[l(w,{modelValue:i.value.knowledgeSetting.noReferencesSetting.status,"onUpdate:modelValue":u[5]||(u[5]=R=>i.value.knowledgeSetting.noReferencesSetting.status=R),class:"radio-block-avatar"},{default:e(()=>[l($,{value:"ai_questioning"},{default:e(()=>[r("p",null,p(o.$t("views.application.dialog.continueQuestioning")),1)]),_:1}),l($,{value:"designated_answer"},{default:e(()=>[r("p",null,p(o.$t("views.application.dialog.provideAnswer")),1),i.value.knowledgeSetting.noReferencesSetting.status==="designated_answer"?(y(),D(h,{key:0,prop:"designated_answer"},{default:e(()=>[l(m,{modelValue:d.value.designated_answer,"onUpdate:modelValue":u[4]||(u[4]=R=>d.value.designated_answer=R),rows:2,type:"textarea",maxlength:"2048",placeholder:I.designated_answer},null,8,["modelValue","placeholder"])]),_:1})):X("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["model","rules"])]),_:1},8,["label"])),g.value?X("",!0):(y(),D(h,{key:1,onClick:u[7]||(u[7]=re(()=>{},["prevent"]))},{label:e(()=>[r("div",el,[r("span",ll,p(o.$t("views.application.form.problemOptimization.label")),1)])]),default:e(()=>[l(W,{size:"small",modelValue:i.value.problemOptimization,"onUpdate:modelValue":u[6]||(u[6]=R=>i.value.problemOptimization=R)},null,8,["modelValue"])]),_:1})),i.value.problemOptimization?(y(),D(h,{key:2,label:o.$t("views.application.form.prompt.label")},{default:e(()=>[l(m,{modelValue:i.value.problemOptimizationPrompt,"onUpdate:modelValue":u[8]||(u[8]=R=>i.value.problemOptimizationPrompt=R),rows:6,type:"textarea",maxlength:"2048",placeholder:F},null,8,["modelValue"])]),_:1},8,["label"])):X("",!0)]),_:1},8,["model"])),[[te,f.value]])])]),_:1})]),_:1},8,["title","modelValue"])}}}),tl={class:"flex-between mb-8"},ol={class:"flex"},nl=["id"],sl={class:"p-8"},il={class:"layout-bg"},rl={class:"flex-between p-16 ml-8"},ul={class:"p-16-24 pt-0",style:{height:"calc(100vh - 200px)"}},dl=["title"],cl={class:"flex-between"},pl={class:"flex"},ea=de({__name:"AddKnowledgeDialog",props:{data:{type:Array,default:()=>[]},loading:Boolean},emits:["addData"],setup(se,{expose:E,emit:B}){const q=ve(),L=se,M=B,{folder:I,user:F}=ye(),i=ee(()=>q.path.includes("shared")?"systemShare":q.path.includes("resource-management")?"systemManage":"workspace"),d=n(!1),c=n([]),v=n(""),f=n(""),g=n([]),A=n([]),x=n(!1),N=ee(()=>v.value?g.value.filter(a=>a.embeddingModelId===v.value):g.value);ne(d,a=>{a||(c.value=[],v.value="",f.value="",g.value=[],A.value=[])}),ne(f,a=>{a?g.value=A.value.filter(m=>{var P;return m.name.includes(a)&&m.folderId===((P=h.value)==null?void 0:P.id)}):g.value=A.value.filter(m=>{var P;return m.folderId===((P=h.value)==null?void 0:P.id)})});function o(){var a,m;c.value.length>0?v.value=(m=(a=A.value)==null?void 0:a.find(P=>P.id===c.value[0]))==null?void 0:m.embeddingModelId:c.value.length===0&&(v.value="")}function u(){c.value=[],v.value=""}const _=a=>{c.value=a,H(),c.value.length>0&&(v.value=L.data.filter(m=>m.id===c.value[0])[0].embeddingModelId),d.value=!0},$=()=>{M("addData",A.value.filter(a=>c.value.includes(a.id))),d.value=!1},V=()=>{f.value="",A.value=[],b()},w=n([]),h=n({}),T=n(!1);function S(a){var m;a.id!==((m=h.value)==null?void 0:m.id)&&(h.value=a,b())}function H(){const a={};I.asyncGetFolder("KNOWLEDGE",a,i.value,T).then(m=>{var P;w.value=m.data,h.value=((P=m.data)==null?void 0:P[0])||{},b()})}function b(){var m;const a=((m=h.value)==null?void 0:m.id)||F.getWorkspaceId();ce({type:"knowledge",isShared:a==="share",systemType:i.value}).getKnowledgeList({folderId:a},x).then(P=>{A.value=Ae([...A.value,...P.data],"id"),g.value=P.data})}return E({open:_}),(a,m)=>{const P=t("el-text"),W=t("Refresh"),Q=t("el-icon"),K=t("el-button"),ae=t("el-input"),te=t("el-col"),R=t("el-row"),Y=t("el-empty"),G=t("el-scrollbar"),z=t("el-dialog"),ie=he("loading");return y(),D(z,{title:a.$t("views.application.dialog.addKnowledge"),modelValue:d.value,"onUpdate:modelValue":m[3]||(m[3]=s=>d.value=s),width:"1000","append-to-body":"",class:"addKnowledge-dialog","align-center":"","close-on-click-modal":!1,"close-on-press-escape":!1},{header:e(({titleId:s,titleClass:k})=>[r("div",tl,[r("div",ol,[r("h4",{id:s,class:me([k,"mr-8"])},p(a.$t("views.application.dialog.addKnowledge")),11,nl),l(P,{type:"info"},{default:e(()=>[C(p(a.$t("views.application.dialog.addKnowledgePlaceholder")),1)]),_:1})]),l(K,{link:"",class:"mr-24",onClick:V},{default:e(()=>[l(Q,{size:18},{default:e(()=>[l(W)]),_:1})]),_:1})])]),footer:e(()=>[r("div",cl,[r("div",pl,[c.value.length>0?(y(),D(P,{key:0,type:"info",class:"color-secondary mr-8"},{default:e(()=>[C(p(a.$t("common.selected"))+" "+p(c.value.length),1)]),_:1})):X("",!0),c.value.length>0?(y(),D(K,{key:1,link:"",type:"primary",onClick:u},{default:e(()=>[C(p(a.$t("common.clear")),1)]),_:1})):X("",!0)]),r("span",null,[l(K,{onClick:m[2]||(m[2]=re(s=>d.value=!1,["prevent"]))},{default:e(()=>[C(p(a.$t("common.cancel")),1)]),_:1}),l(K,{type:"primary",onClick:$},{default:e(()=>[C(p(a.$t("common.add")),1)]),_:1})])])]),default:e(()=>[l(Ve,{showCollapse:"",class:"application-manage"},{left:e(()=>{var s;return[r("div",sl,[ue(l(Re,{data:w.value,currentNodeKey:(s=h.value)==null?void 0:s.id,onHandleNodeClick:S,canOperation:!1,showShared:"",shareTitle:a.$t("views.shared.shared_knowledge"),treeStyle:{height:"calc(100vh - 240px)"}},null,8,["data","currentNodeKey","shareTitle"]),[[ie,T.value]])])]}),default:e(()=>{var s;return[r("div",il,[r("div",rl,[r("h4",null,p((s=h.value)==null?void 0:s.name),1),l(ae,{modelValue:f.value,"onUpdate:modelValue":m[0]||(m[0]=k=>f.value=k),placeholder:a.$t("common.search"),"prefix-icon":"Search",class:"w-240 mr-8",clearable:""},null,8,["modelValue","placeholder"])]),l(G,null,{default:e(()=>[r("div",ul,[N.value.length?ue((y(),D(R,{key:0,gutter:12},{default:e(()=>[(y(!0),le(be,null,$e(N.value.filter(k=>k.resourceType!=="folder"),(k,J)=>(y(),D(te,{span:8,key:J,class:"mb-16"},{default:e(()=>[l(Se,{"value-field":"id",data:k,modelValue:c.value,"onUpdate:modelValue":m[1]||(m[1]=j=>c.value=j),onChange:o},{default:e(()=>[r("span",{class:"ellipsis cursor ml-12",title:k.name},p(k.name),9,dl)]),_:2},1032,["data","modelValue"])]),_:2},1024))),128))]),_:1})),[[ie,x.value]]):(y(),D(Y,{key:1,description:a.$t("common.noData")},null,8,["description"]))])]),_:1})])]}),_:1})]),_:1},8,["title","modelValue"])}}}),ml={class:"flex-between"},vl={class:"dialog-footer"},la=de({__name:"TTSModeParamSettingDialog",emits:["refresh"],setup(se,{expose:E,emit:B}){const q=ve(),{params:{id:L}}=q,M=ee(()=>q.path.includes("resource-management")?"systemManage":"workspace"),I=n(""),F=n([]),i=B,d=n(),c=n({}),v=n(!1),f=n(!1),g=n(!1),A=(_,$,V)=>{c.value={},I.value=_,ce({type:"model",systemType:M.value}).getModelParamsForm(_,f).then(w=>{var T;F.value=w.data;const h=w.data.map(S=>({[S.field]:S.show_default_value!==!1?S.default_value:void 0})).reduce((S,H)=>({...S,...H}),{});V&&Object.keys(V).forEach(S=>{S in h||delete V[S]}),V={...h,...V},(T=d.value)==null||T.render(F.value,V)}),v.value=!0},x=(_,$)=>{ce({type:"model",systemType:M.value}).getModelParamsForm(_,f).then(V=>{F.value=V.data;const w=V.data.map(h=>({[h.field]:h.show_default_value!==!1?h.default_value:void 0})).reduce((h,T)=>({...h,...T}),{});console.log("model_setting_data: ",w),i("refresh",w)})},N=async()=>{var _;(_=d.value)==null||_.validate().then(()=>{i("refresh",c.value),v.value=!1})},o=n(null),u=()=>{const _={...c.value,ttsModelId:I.value};ce({type:"application",systemType:M.value}).playDemoText(L,_,g).then(async $=>{if($.type==="application/json"){const h=await $.text();qe(h);return}const V=new Blob([$],{type:"audio/mp3"}),w=URL.createObjectURL(V);o.value instanceof HTMLAudioElement?(o.value.src=w,o.value.play()):console.error("audioPlayer.value is not an instance of HTMLAudioElement")}).catch($=>{console.log("err: ",$)})};return E({open:A,reset_default:x}),(_,$)=>{const V=t("el-button"),w=t("el-dialog");return y(),le(be,null,[l(w,{"align-center":"",title:_.$t("common.paramSetting"),modelValue:v.value,"onUpdate:modelValue":$[2]||($[2]=h=>v.value=h),style:{width:"550px"},"append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:e(()=>[r("div",ml,[l(V,{onClick:u,loading:g.value},{default:e(()=>[l(ge,{iconName:"app-video-play",class:"mr-4"}),C(" "+p(_.$t("views.application.form.voicePlay.listeningTest")),1)]),_:1},8,["loading"]),r("span",vl,[l(V,{onClick:$[1]||($[1]=re(h=>v.value=!1,["prevent"]))},{default:e(()=>[C(p(_.$t("common.cancel")),1)]),_:1}),l(V,{type:"primary",onClick:N,loading:f.value},{default:e(()=>[C(p(_.$t("common.confirm")),1)]),_:1},8,["loading"])])])]),default:e(()=>[l(Te,{modelValue:c.value,"onUpdate:modelValue":$[0]||($[0]=h=>c.value=h),model:c.value,"label-position":"top","require-asterisk-position":"right",render_data:F.value,ref_key:"dynamicsFormRef",ref:d},null,8,["modelValue","model","render_data"])]),_:1},8,["title","modelValue"]),r("audio",{ref_key:"audioPlayer",ref:o,controls:"",hidden:"hidden"},null,512)],64)}}}),fl={class:"dialog-footer p-16"},aa=de({__name:"ReasoningParamSettingDialog",emits:["refresh"],setup(se,{expose:E,emit:B}){const q=B,L=n({reasoningContent_start:"<think>",reasoningContent_end:"</think>"}),M=n(!1),I=n(!1);ne(M,d=>{d||(L.value={reasoningContent_start:"<think>",reasoningContent_end:"</think>"})});const F=d=>{L.value={...L.value,...d},M.value=!0},i=()=>{q("refresh",L.value),M.value=!1};return E({open:F}),(d,c)=>{const v=t("el-text"),f=t("el-input"),g=t("el-form-item"),A=t("el-col"),x=t("el-row"),N=t("el-form"),o=t("el-button"),u=t("el-dialog");return y(),D(u,{"align-center":"",title:d.$t("common.setting"),class:"param-dialog",modelValue:M.value,"onUpdate:modelValue":c[4]||(c[4]=_=>M.value=_),style:{width:"550px"},"append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:e(()=>[r("span",fl,[l(o,{onClick:c[2]||(c[2]=re(_=>M.value=!1,["prevent"]))},{default:e(()=>[C(p(d.$t("common.cancel")),1)]),_:1}),l(o,{type:"primary",onClick:c[3]||(c[3]=_=>i()),loading:I.value},{default:e(()=>[C(p(d.$t("common.save")),1)]),_:1},8,["loading"])])]),default:e(()=>[l(N,{"label-position":"top",ref:"paramFormRef",model:L.value},{default:e(()=>[l(v,{type:"info",class:"color-secondary"},{default:e(()=>[C(p(d.$t("views.application.form.reasoningContent.tooltip")),1)]),_:1}),l(x,{class:"mt-16",gutter:20},{default:e(()=>[l(A,{span:12},{default:e(()=>[l(g,{label:d.$t("views.application.form.reasoningContent.start")},{default:e(()=>[l(f,{type:"textarea",modelValue:L.value.reasoningContent_start,"onUpdate:modelValue":c[0]||(c[0]=_=>L.value.reasoningContent_start=_),rows:6,maxlength:"50",placeholder:"<think>"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),l(A,{span:12},{default:e(()=>[l(g,{label:d.$t("views.application.form.reasoningContent.end")},{default:e(()=>[l(f,{type:"textarea",modelValue:L.value.reasoningContent_end,"onUpdate:modelValue":c[1]||(c[1]=_=>L.value.reasoningContent_end=_),rows:6,maxlength:"50",placeholder:"</think>"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])}}}),_l={class:"flex-between mb-8"},gl={class:"flex"},hl=["id"],yl={class:"p-8"},bl={class:"layout-bg"},wl={class:"flex-between p-16 ml-8"},kl={class:"p-16-24 pt-0",style:{height:"calc(100vh - 200px)"}},$l=["src"],Vl=["title"],Sl={class:"flex-between"},Cl={class:"flex"},ta=de({__name:"ToolDialog",emits:["refresh"],setup(se,{expose:E,emit:B}){const q=ve(),L=B,{folder:M,user:I}=ye(),F=ee(()=>q.path.includes("shared")?"systemShare":q.path.includes("resource-management")?"systemManage":"workspace"),i=n(!1),d=n([]),c=n(""),v=n([]),f=n([]),g=n("CUSTOM"),A=n(!1);ne(i,b=>{b||(d.value=[],c.value="",v.value=[],f.value=[])}),ne(c,b=>{b?v.value=f.value.filter(a=>a.name.includes(b)&&a.toolType===g.value):v.value=f.value.filter(a=>a.toolType===g.value)});function x(){}function N(){d.value=[]}const o=b=>{d.value=b||[],S(),i.value=!0},u=()=>{L("refresh",{toolIds:d.value}),i.value=!1},_=()=>{c.value="",f.value=[],H()};function $(){v.value=f.value.filter(b=>b.name.includes(c.value)&&b.toolType===g.value)}const V=n([]),w=n({}),h=n(!1);function T(b){var a;b.id!==((a=w.value)==null?void 0:a.id)&&(w.value=b,H())}function S(){const b={};M.asyncGetFolder("TOOL",b,F.value,h).then(a=>{var m;V.value=a.data,w.value=((m=a.data)==null?void 0:m[0])||{},H()})}function H(){var a;const b=((a=w.value)==null?void 0:a.id)||I.getWorkspaceId();ce({type:"tool",isShared:b==="share",systemType:"workspace"}).getToolList({folderId:b}).then(m=>{var P,W,Q;f.value=((P=m.data)==null?void 0:P.tools)||m.data||[],f.value=(W=f.value)==null?void 0:W.filter(K=>K.isActive),v.value=m.data.tools||m.data,v.value=(Q=v.value)==null?void 0:Q.filter(K=>K.isActive&&K.toolType===g.value)})}return E({open:o}),(b,a)=>{const m=t("Refresh"),P=t("el-icon"),W=t("el-button"),Q=t("el-divider"),K=t("el-radio-button"),ae=t("el-radio-group"),te=t("el-input"),R=t("el-avatar"),Y=t("ToolIcon"),G=t("el-col"),z=t("el-row"),ie=t("el-empty"),s=t("el-scrollbar"),k=t("el-text"),J=t("el-dialog"),j=he("loading");return y(),D(J,{modelValue:i.value,"onUpdate:modelValue":a[4]||(a[4]=O=>i.value=O),width:"1000","append-to-body":"",class:"addTool-dialog","align-center":"","close-on-click-modal":!1,"close-on-press-escape":!1},{header:e(({titleId:O,titleClass:U})=>[r("div",_l,[r("div",gl,[r("h4",{id:O,class:me([U,"mr-8"])},p(b.$t("views.tool.settingTool")),11,hl)]),l(W,{link:"",class:"mr-24",onClick:_},{default:e(()=>[l(P,{size:18},{default:e(()=>[l(m)]),_:1})]),_:1})])]),footer:e(()=>[r("div",Sl,[r("div",Cl,[d.value.length>0?(y(),D(k,{key:0,type:"info",class:"color-secondary mr-8"},{default:e(()=>[C(p(b.$t("common.selected"))+" "+p(d.value.length),1)]),_:1})):X("",!0),d.value.length>0?(y(),D(W,{key:1,link:"",type:"primary",onClick:N},{default:e(()=>[C(p(b.$t("common.clear")),1)]),_:1})):X("",!0)]),r("span",null,[l(W,{onClick:a[3]||(a[3]=re(O=>i.value=!1,["prevent"]))},{default:e(()=>[C(p(b.$t("common.cancel")),1)]),_:1}),l(W,{type:"primary",onClick:u},{default:e(()=>[C(p(b.$t("common.add")),1)]),_:1})])])]),default:e(()=>[l(Ve,{showCollapse:"",class:"application-manage"},{left:e(()=>{var O;return[r("div",yl,[ue(l(Re,{data:V.value,currentNodeKey:(O=w.value)==null?void 0:O.id,onHandleNodeClick:T,canOperation:!1,showShared:"",shareTitle:b.$t("views.shared.shared_tool"),treeStyle:{height:"calc(100vh - 240px)"}},null,8,["data","currentNodeKey","shareTitle"]),[[j,h.value]])])]}),default:e(()=>{var O;return[r("div",bl,[r("div",wl,[r("h4",null,p((O=w.value)==null?void 0:O.name),1),l(Q,{direction:"vertical"}),l(ae,{modelValue:g.value,"onUpdate:modelValue":a[0]||(a[0]=U=>g.value=U),onChange:$,class:"app-radio-button-group"},{default:e(()=>[l(K,{value:"CUSTOM"},{default:e(()=>[C(p(b.$t("views.tool.title")),1)]),_:1}),l(K,{value:"MCP"},{default:e(()=>a[5]||(a[5]=[C("MCP",-1)])),_:1,__:[5]})]),_:1},8,["modelValue"]),l(te,{modelValue:c.value,"onUpdate:modelValue":a[1]||(a[1]=U=>c.value=U),placeholder:b.$t("common.search"),"prefix-icon":"Search",class:"w-240 mr-8",clearable:""},null,8,["modelValue","placeholder"])]),l(s,null,{default:e(()=>[r("div",kl,[v.value.length?ue((y(),D(z,{key:0,gutter:12},{default:e(()=>[(y(!0),le(be,null,$e(v.value,(U,fe)=>(y(),D(G,{span:8,key:fe,class:"mb-16"},{default:e(()=>[l(Se,{"value-field":"id",data:U,modelValue:d.value,"onUpdate:modelValue":a[2]||(a[2]=pe=>d.value=pe),onChange:x},{icon:e(()=>[U!=null&&U.icon?(y(),D(R,{key:0,shape:"square",size:32,style:{background:"none"},class:"mr-8"},{default:e(()=>[r("img",{src:Ie(Pe)(U==null?void 0:U.icon),alt:""},null,8,$l)]),_:2},1024)):(y(),D(Y,{key:1,size:32,type:U==null?void 0:U.toolType},null,8,["type"]))]),default:e(()=>[r("span",{class:"ellipsis cursor ml-12",title:U.name},p(U.name),9,Vl)]),_:2},1032,["data","modelValue"])]),_:2},1024))),128))]),_:1})),[[j,A.value]]):(y(),D(ie,{key:1,description:b.$t("common.noData")},null,8,["description"]))])]),_:1})])]}),_:1})]),_:1},8,["modelValue"])}}}),Tl={class:"flex-between mb-8"},Dl={class:"flex"},Rl=["id"],Il={class:"layout-bg"},Pl={class:"flex-between p-16 ml-8"},Ml={class:"p-16-24 pt-0",style:{height:"calc(100vh - 200px)"}},xl=["src"],Ul=["title"],Ll={class:"flex-between"},Al={class:"flex"},oa=de({__name:"ApplicationDialog",emits:["refresh"],setup(se,{expose:E,emit:B}){const q=ve(),L=B,{folder:M,user:I}=ye(),F=ee(()=>q.path.includes("shared")?"systemShare":q.path.includes("resource-management")?"systemManage":"workspace"),i=n(!1),d=n([]),c=n(""),v=n([]),f=n([]),g=n(!1);ne(i,T=>{T||(d.value=[],c.value="",v.value=[],f.value=[])}),ne(c,T=>{T?v.value=f.value.filter(S=>S.name.includes(T)):v.value=f.value});function A(){}function x(){d.value=[]}const N=T=>{d.value=T||[],w(),i.value=!0},o=()=>{L("refresh",{applicationIds:d.value}),i.value=!1},u=()=>{c.value="",f.value=[],h()},_=n([]),$=n({}),V=n(!1);function w(){const T={};M.asyncGetFolder("APPLICATION",T,F.value,V).then(S=>{var H;_.value=S.data,$.value=((H=S.data)==null?void 0:H[0])||{},h()})}function h(){var S;const T=((S=$.value)==null?void 0:S.id)||I.getWorkspaceId();ce({type:"application",isShared:T==="share",systemType:"workspace"}).getAllApplication({folderId:T}).then(H=>{var b,a;f.value=H.data,f.value=(b=f.value)==null?void 0:b.filter(m=>m.isPublish&&m.id!==q.params.id),v.value=H.data,v.value=(a=v.value)==null?void 0:a.filter(m=>m.isPublish&&m.id!==q.params.id)})}return E({open:N}),(T,S)=>{const H=t("Refresh"),b=t("el-icon"),a=t("el-button"),m=t("el-input"),P=t("el-avatar"),W=t("el-col"),Q=t("el-row"),K=t("el-empty"),ae=t("el-scrollbar"),te=t("el-text"),R=t("el-dialog"),Y=he("loading");return y(),D(R,{modelValue:i.value,"onUpdate:modelValue":S[3]||(S[3]=G=>i.value=G),width:"1000","append-to-body":"",class:"addTool-dialog","align-center":"","close-on-click-modal":!1,"close-on-press-escape":!1},{header:e(({titleId:G,titleClass:z})=>[r("div",Tl,[r("div",Dl,[r("h4",{id:G,class:me([z,"mr-8"])},p(T.$t("views.application.title")),11,Rl)]),l(a,{link:"",class:"mr-24",onClick:u},{default:e(()=>[l(b,{size:18},{default:e(()=>[l(H)]),_:1})]),_:1})])]),footer:e(()=>[r("div",Ll,[r("div",Al,[d.value.length>0?(y(),D(te,{key:0,type:"info",class:"color-secondary mr-8"},{default:e(()=>[C(p(T.$t("common.selected"))+" "+p(d.value.length),1)]),_:1})):X("",!0),d.value.length>0?(y(),D(a,{key:1,link:"",type:"primary",onClick:x},{default:e(()=>[C(p(T.$t("common.clear")),1)]),_:1})):X("",!0)]),r("span",null,[l(a,{onClick:S[2]||(S[2]=re(G=>i.value=!1,["prevent"]))},{default:e(()=>[C(p(T.$t("common.cancel")),1)]),_:1}),l(a,{type:"primary",onClick:o},{default:e(()=>[C(p(T.$t("common.add")),1)]),_:1})])])]),default:e(()=>[l(Ve,{showCollapse:"",class:"application-manage"},{default:e(()=>{var G;return[r("div",Il,[r("div",Pl,[r("h4",null,p((G=$.value)==null?void 0:G.name),1),l(m,{modelValue:c.value,"onUpdate:modelValue":S[0]||(S[0]=z=>c.value=z),placeholder:T.$t("common.search"),"prefix-icon":"Search",class:"w-240 mr-8",clearable:""},null,8,["modelValue","placeholder"])]),l(ae,null,{default:e(()=>[r("div",Ml,[v.value.length?ue((y(),D(Q,{key:0,gutter:12},{default:e(()=>[(y(!0),le(be,null,$e(v.value,(z,ie)=>(y(),D(W,{span:12,key:ie,class:"mb-16"},{default:e(()=>[l(Se,{"value-field":"id",data:z,modelValue:d.value,"onUpdate:modelValue":S[1]||(S[1]=s=>d.value=s),onChange:A},{icon:e(()=>[z!=null&&z.icon?(y(),D(P,{key:0,shape:"square",size:32,style:{background:"none"},class:"mr-8"},{default:e(()=>[r("img",{src:Ie(Pe)(z==null?void 0:z.icon),alt:""},null,8,xl)]),_:2},1024)):(y(),D(Fe,{key:1,size:32,type:z==null?void 0:z.toolType},null,8,["type"]))]),default:e(()=>[r("span",{class:"ellipsis cursor ml-12",title:z.name},p(z.name),9,Ul)]),_:2},1032,["data","modelValue"])]),_:2},1024))),128))]),_:1})),[[Y,g.value]]):(y(),D(K,{key:1,description:T.$t("common.noData")},null,8,["description"]))])]),_:1})])]}),_:1})]),_:1},8,["modelValue"])}}}),ql={class:"generate-prompt-dialog-bg border-r-8"},Fl={class:"scrollbar-height"},Nl={class:"p-16 pb-0 lighter"},zl={key:1,shadow:"always",style:{margin:"0.5rem 0"}},Ol={key:2,class:"flex align-center"},Hl={key:0,class:"mt-8"},Kl={key:1,class:"mt-8"},El={class:"generate-prompt-operate p-16"},Bl={key:0,class:"text-center mb-8"},Wl={class:"operate-textarea"},Gl={class:"operate"},jl={class:"text-right"},Jl={src:Oe,alt:""},Ql=de({__name:"GeneratePromptDialog",emits:["replace"],setup(se,{expose:E,emit:B}){const q=B,{user:L}=ye(),M=ve(),I=n([]),F=ee(()=>M.path.includes("resource-management")?"systemManage":"workspace"),i=n(""),d=n(""),c=n(""),v=n(!1),f=n(""),g=n(!1),A={INIT_TEMPLATE:`
è¯·æ ¹æ®ç”¨æˆ·æè¿°ç”Ÿæˆä¸€ä¸ªå®Œæ•´çš„AIè§’è‰²äººè®¾æ¨¡æ¿:

åº”ç”¨åç§°ï¼š{application_name}
åº”ç”¨æè¿°ï¼š{detail}
ç”¨æˆ·éœ€æ±‚ï¼š{userInput}

é‡è¦è¯´æ˜ï¼š
1. è§’è‰²è®¾å®šå¿…é¡»æœåŠ¡äº"{application_name}"åº”ç”¨çš„æ ¸å¿ƒåŠŸèƒ½
2. å…è®¸ç”¨æˆ·å¯¹è§’è‰²è®¾å®šçš„å…·ä½“å†…å®¹è¿›è¡Œè°ƒæ•´å’Œä¼˜åŒ–
3. å¦‚æœç”¨æˆ·è¦æ±‚ä¿®æ”¹æŸä¸ªæŠ€èƒ½æˆ–éƒ¨åˆ†ï¼Œåœ¨ä¿æŒåº”ç”¨ä¸»é¢˜çš„å‰æä¸‹è¿›è¡Œç›¸åº”è°ƒæ•´

è¯·æŒ‰ä»¥ä¸‹æ ¼å¼ç”Ÿæˆï¼š

å¿…é¡»ä¸¥æ ¼éµå¾ªä»¥ä¸‹è§„åˆ™ï¼š
1. **ä¸¥æ ¼ç¦æ­¢è¾“å‡ºè§£é‡Šã€å‰è¨€ã€é¢å¤–è¯´æ˜**ï¼Œåªè¾“å‡ºæœ€ç»ˆç»“æœã€‚
2. **ä¸¥æ ¼ä½¿ç”¨ä»¥ä¸‹æ ¼å¼**ï¼Œä¸èƒ½ç¼ºå°‘æ ‡é¢˜ã€ä¸èƒ½å¤šå‡ºå…¶ä»–æ®µè½ã€‚
3. **å¦‚æœç”¨æˆ·è¦æ±‚ä¿®æ”¹è§’è‰²è®¾å®šçš„æŸä¸ªéƒ¨åˆ†ï¼Œåœ¨ä¿æŒåº”ç”¨æ ¸å¿ƒåŠŸèƒ½çš„å‰æä¸‹è¿›è¡Œè°ƒæ•´**ã€‚
4. **å¦‚æœç”¨æˆ·éœ€æ±‚ä¸è§’è‰²è®¾å®šç”Ÿæˆå®Œå…¨æ— å…³ï¼ˆå¦‚é—²èŠã€å…¶ä»–è¯é¢˜ï¼‰ï¼Œåˆ™å¿½ç•¥ç”¨æˆ·éœ€æ±‚ï¼ŒåŸºäºåº”ç”¨ä¿¡æ¯ç”Ÿæˆæ ‡å‡†è§’è‰²è®¾å®š**ã€‚

# è§’è‰²:
è§’è‰²æ¦‚è¿°å’Œä¸»è¦èŒè´£çš„ä¸€å¥è¯æè¿°

## ç›®æ ‡ï¼š
è§’è‰²çš„å·¥ä½œç›®æ ‡,å¦‚æœæœ‰å¤šç›®æ ‡å¯ä»¥åˆ†ç‚¹åˆ—å‡º,ä½†å»ºè®®æ›´èšç„¦1-2ä¸ªç›®æ ‡

## æ ¸å¿ƒæŠ€èƒ½ï¼š
### æŠ€èƒ½ 1: [æŠ€èƒ½åç§°ï¼Œå¦‚ä½œå“æ¨è/ä¿¡æ¯æŸ¥è¯¢/ä¸“ä¸šåˆ†æç­‰]
1. [æ‰§è¡Œæ­¥éª¤1 - æè¿°è¯¥æŠ€èƒ½çš„ç¬¬ä¸€ä¸ªå…·ä½“æ“ä½œæ­¥éª¤ï¼ŒåŒ…æ‹¬æ¡ä»¶åˆ¤æ–­å’Œå¤„ç†æ–¹å¼]
2. [æ‰§è¡Œæ­¥éª¤2 - æè¿°è¯¥æŠ€èƒ½çš„ç¬¬äºŒä¸ªå…·ä½“æ“ä½œæ­¥éª¤ï¼ŒåŒ…æ‹¬å¦‚ä½•è·å–æˆ–å¤„ç†ä¿¡æ¯]
3. [æ‰§è¡Œæ­¥éª¤3 - æè¿°è¯¥æŠ€èƒ½çš„æœ€ç»ˆè¾“å‡ºæ­¥éª¤ï¼Œè¯´æ˜å¦‚ä½•å‘ˆç°ç»“æœ]

===å›å¤ç¤ºä¾‹===
- ğŸ“‹ [æ ‡è¯†ç¬¦]: <å…·ä½“å†…å®¹æ ¼å¼è¯´æ˜>
- ğŸ¯ [æ ‡è¯†ç¬¦]: <å…·ä½“å†…å®¹æ ¼å¼è¯´æ˜>
- ğŸ’¡ [æ ‡è¯†ç¬¦]: <å…·ä½“å†…å®¹æ ¼å¼è¯´æ˜>
===ç¤ºä¾‹ç»“æŸ===

### æŠ€èƒ½ 2: [æŠ€èƒ½åç§°]
1. [æ‰§è¡Œæ­¥éª¤1 - æè¿°è§¦å‘æ¡ä»¶å’Œåˆå§‹å¤„ç†æ–¹å¼]
2. [æ‰§è¡Œæ­¥éª¤2 - æè¿°ä¿¡æ¯è·å–å’Œæ·±åŒ–å¤„ç†çš„å…·ä½“æ–¹æ³•]
3. [æ‰§è¡Œæ­¥éª¤3 - æè¿°æœ€ç»ˆè¾“å‡ºçš„å…·ä½“è¦æ±‚å’Œæ ¼å¼]

### æŠ€èƒ½ 3: [æŠ€èƒ½åç§°]
- [æ ¸å¿ƒèƒ½åŠ›æè¿° - è¯´æ˜è¯¥æŠ€èƒ½çš„ä¸»è¦ä½œç”¨å’ŒçŸ¥è¯†åŸºç¡€]
- [åº”ç”¨æ–¹æ³• - æè¿°å¦‚ä½•è¿ç”¨è¯¥æŠ€èƒ½ä¸ºç”¨æˆ·æä¾›æœåŠ¡ï¼ŒåŒ…æ‹¬å…·ä½“çš„å®æ–½æ–¹å¼]

## å·¥ä½œæµï¼š
1. æè¿°è§’è‰²å·¥ä½œæµç¨‹çš„ç¬¬ä¸€æ­¥
2. æè¿°è§’è‰²å·¥ä½œæµç¨‹çš„ç¬¬äºŒæ­¥
3. æè¿°è§’è‰²å·¥ä½œæµç¨‹çš„ç¬¬ä¸‰æ­¥

## è¾“å‡ºæ ¼å¼ï¼š
å¦‚æœå¯¹è§’è‰²çš„è¾“å‡ºæ ¼å¼æœ‰ç‰¹å®šè¦æ±‚ï¼Œå¯ä»¥åœ¨è¿™é‡Œå¼ºè°ƒå¹¶ä¸¾ä¾‹è¯´æ˜æƒ³è¦çš„è¾“å‡ºæ ¼å¼


## é™åˆ¶ï¼š
1. **ä¸¥æ ¼é™åˆ¶å›ç­”èŒƒå›´**ï¼šä»…å›ç­”ä¸è§’è‰²è®¾å®šç›¸å…³çš„é—®é¢˜ã€‚
   - å¦‚æœç”¨æˆ·æé—®ä¸è§’è‰²æ— å…³ï¼Œå¿…é¡»ä½¿ç”¨ä»¥ä¸‹å›ºå®šæ ¼å¼å›å¤ï¼š
     â€œå¯¹ä¸èµ·ï¼Œæˆ‘åªèƒ½å›ç­”ä¸[è§’è‰²è®¾å®š]ç›¸å…³çš„é—®é¢˜ï¼Œæ‚¨çš„é—®é¢˜ä¸åœ¨æœåŠ¡èŒƒå›´å†…ã€‚â€
   - ä¸å¾—æä¾›ä»»ä½•ä¸è§’è‰²è®¾å®šæ— å…³çš„å›ç­”ã€‚
2. æè¿°è§’è‰²åœ¨äº’åŠ¨è¿‡ç¨‹ä¸­éœ€è¦éµå¾ªçš„é™åˆ¶æ¡ä»¶2
3. æè¿°è§’è‰²åœ¨äº’åŠ¨è¿‡ç¨‹ä¸­éœ€è¦éµå¾ªçš„é™åˆ¶æ¡ä»¶3

è¾“å‡ºæ—¶ä¸å¾—åŒ…å«ä»»ä½•è§£é‡Šæˆ–é™„åŠ è¯´æ˜ï¼Œåªèƒ½è¿”å›ç¬¦åˆä»¥ä¸Šæ ¼å¼çš„å†…å®¹ã€‚
  `},x=n(!1),N=n(!1),o=n(""),u=n(0);let _=null;const $=n(!1),V=()=>{_&&clearInterval(_),x.value=!0,N.value=!1,_=setInterval(()=>{if(b.value&&!N.value){const s=I.value[I.value.length-1];s&&s.role==="ai"&&(s.content=o.value),w();return}if(!N.value&&u.value<o.value.length){const s=Math.min(3,o.value.length-u.value);u.value+=s;const k=I.value[I.value.length-1];k&&k.role==="ai"&&(k.content=o.value.substring(0,u.value))}else g.value===!1&&u.value>=o.value.length&&w()},50)},w=()=>{_&&(clearInterval(_),_=null),x.value=!1,N.value=!1,g.value=!1,$.value=!0},h=ee(()=>x.value),T=()=>{N.value=!0,x.value=!1},S=()=>{u.value<o.value.length&&V()},H=s=>{let k="";const J=De({content:"",role:"ai"});I.value.push(J),o.value="",u.value=0,$.value=!1;let j=!1;const O=({done:U,value:fe})=>{try{if(U){g.value=!1,b.value=!0;return}let Z=new TextDecoder("utf-8").decode(fe,{stream:!0});k+=Z;const _e=k.match(/data:.*}\n\n/g);if(_e)Z=_e.join(""),k=k.replace(Z,"");else return s.read().then(O);if(Z&&Z.startsWith("data:")&&_e)for(const Me in _e){const we=JSON==null?void 0:JSON.parse(_e[Me].replace("data:",""));if(we.isEnd||(o.value+=we.content,j||(j=!0,V())),we.isEnd)return Promise.resolve()}}catch(pe){return g.value=!1,w(),Promise.reject(pe)}return s.read().then(O)};return O},b=n(!1),a=ee(()=>{const s=I.value[I.value.length-1];return s&&s.role=="ai"?s.content:""}),m=ee(()=>!x.value&&N.value&&u.value<o.value.length);function P(s){b.value=!1,g.value=!0;const k=L.getWorkspaceId()||"default";I.value.push({content:s,role:"user"});const J={messages:I.value,prompt:A.INIT_TEMPLATE};F.value==="workspace"?Ke.generate_prompt(k,d.value,c.value,J).then(j=>{ke(()=>{Y.value&&R.value.setScrollTop(G())});const O=j.body.getReader();O.read().then(H(O))}):F.value==="systemManage"&&Ee.generate_prompt(c.value,d.value,J).then(j=>{ke(()=>{Y.value&&R.value.setScrollTop(G())});const O=j.body.getReader();O.read().then(H(O))})}const W=()=>{i.value&&P("ç»“æœä¸æ»¡æ„,è¯·æŒ‰ç…§æ ¼å¼,é‡æ–°ç”Ÿæˆ")},Q=n(),K=s=>{if(!(s!=null&&s.ctrlKey)&&!(s!=null&&s.shiftKey)&&!(s!=null&&s.altKey)&&!(s!=null&&s.metaKey)){if(s==null||s.preventDefault(),!f.value.trim()||g.value||x.value||(i.value||(i.value=f.value),N.value||x.value))return;f.value&&(P(f.value),f.value="")}else ae(s)},ae=s=>{const k=Q.value.$el.querySelector(".el-textarea__inner"),J=k.selectionStart,j=k.selectionEnd;s.preventDefault(),f.value=f.value.slice(0,J)+`
`+f.value.slice(j),ke(()=>{k.setSelectionRange(J+1,J+1)})},te=(s,k)=>{d.value=s,c.value=k,v.value=!0,i.value="",I.value=[]},R=n(),Y=n(),G=()=>Y.value.scrollHeight,z=()=>{var s;R.value&&R.value.wrapRef.offsetHeight<((s=Y.value)==null?void 0:s.scrollHeight)&&R.value.setScrollTop(G())},ie=s=>{a.value?Be(oe("common.tip"),oe("views.application.generateDialog.exit"),{confirmButtonText:oe("common.confirm"),cancelButtonText:oe("common.cancel"),distinguishCancelAndClose:!0}).then(()=>{w(),I.value=[],o.value="",u.value=0,$.value=!1,s()}).catch(()=>{}):s()};return Ne(()=>{w()}),ne(a,()=>{z()},{deep:!0,immediate:!0}),E({open:te}),(s,k)=>{const J=t("Loading"),j=t("el-icon"),O=t("el-scrollbar"),U=t("el-button"),fe=t("el-input"),pe=t("el-dialog");return y(),D(pe,{"align-center":"",title:s.$t("views.application.generateDialog.generatePrompt"),modelValue:v.value,"onUpdate:modelValue":k[3]||(k[3]=Z=>v.value=Z),style:{width:"600px"},"append-to-body":"","close-on-click-modal":!0,"close-on-press-escape":!0,"before-close":ie},{default:e(()=>[r("div",ql,[r("div",Fl,[r("div",Nl,[l(O,{ref_key:"scrollDiv",ref:R},{default:e(()=>[a.value?(y(),le("div",{key:0,ref_key:"dialogScrollbar",ref:Y,class:"pre-wrap lighter",style:{"max-height":"calc(100vh - 400px)"}},p(a.value),513)):g.value?(y(),le("p",zl,[l(j,{class:"is-loading color-primary mr-4"},{default:e(()=>[l(J)]),_:1}),C(" "+p(s.$t("views.application.generateDialog.loading"))+" ",1),k[4]||(k[4]=r("span",{class:"dotting"},null,-1))])):(y(),le("p",Ol,[l(ge,{iconName:"app-generate-star",class:"color-primary mr-4"}),C(" "+p(s.$t("views.application.generateDialog.title")),1)]))]),_:1},512),a.value&&!g.value&&!x.value&&!m.value?(y(),le("div",Hl,[l(U,{type:"primary",onClick:k[0]||(k[0]=()=>q("replace",a.value))},{default:e(()=>[C(p(s.$t("views.application.generateDialog.replace")),1)]),_:1}),l(U,{onClick:W,disabled:!a.value||g.value,loading:g.value},{default:e(()=>[C(p(s.$t("views.application.generateDialog.remake")),1)]),_:1},8,["disabled","loading"])])):(y(),le("div",Kl,[m.value?(y(),D(U,{key:0,type:"primary",onClick:S,link:""},{default:e(()=>[C(p(s.$t("views.application.generateDialog.continue")),1)]),_:1})):X("",!0)]))]),r("div",El,[h.value?(y(),le("div",Bl,[l(U,{class:"border-primary video-stop-button",onClick:T},{default:e(()=>[l(ge,{iconName:"app-video-stop",class:"mr-8"}),C(" "+p(s.$t("views.application.generateDialog.stop")),1)]),_:1})])):X("",!0),r("div",Wl,[l(fe,{ref_key:"quickInputRef",ref:Q,modelValue:f.value,"onUpdate:modelValue":k[1]||(k[1]=Z=>f.value=Z),autosize:{minRows:1,maxRows:10},type:"textarea",placeholder:s.$t("views.application.generateDialog.placeholder"),maxlength:1e5,class:"chat-operate-textarea",onKeydown:k[2]||(k[2]=ze(Z=>K(Z),["enter"]))},null,8,["modelValue","placeholder"]),r("div",Gl,[r("div",jl,[l(U,{text:"",class:"sent-button",disabled:!f.value.trim()||g.value||x.value,onClick:K},{default:e(()=>[ue(r("img",Jl,null,512),[[Ce,!f.value.trim()||g.value||x.value]]),ue(l(He,null,null,512),[[Ce,f.value.trim()&&!g.value&&!x.value]])]),_:1},8,["disabled"])])])])])])])]),_:1},8,["title","modelValue"])}}}),na=We(Ql,[["__scopeId","data-v-2168fa76"]]);export{na as G,Yl as _,la as a,Zl as b,ea as c,aa as d,ta as e,oa as f};

import{cp as E,cq as u,cu as n,cx as P,cF as T,cA as e,cB as c,cz as a,cE as O,cK as S,cJ as p,dT as Y,cQ as K,dU as Z,cR as G,cZ as B,d6 as te,di as Q,cV as j,cN as L,cP as le,cr as oe,cU as ne,cv as ie,cy as X,cC as ee,cD as se,cS as re,cY as de}from"./index-938a5085.js";const ce={class:"dialog-footer p-16"},ue=E({__name:"AIModeParamSettingDialog",emits:["refresh"],setup(A,{expose:U,emit:x}){const y=u([]),h=x,m=u(),d=u({}),v=u(!1),o=u(!1),r=(_,f)=>f?K.getModelParamsForm(f,_,o):Z.getModelParamsForm(_,o),b=(_,f,M)=>{d.value={},r(_,f).then(l=>{var t;y.value=l.data,(t=m.value)==null||t.render(y.value,M)}),v.value=!0},V=(_,f)=>{r(_,f).then(s=>{y.value=s.data;const l=s.data.map(t=>t.show_default_value===!1?{[t.field]:void 0}:{[t.field]:t.default_value}).reduce((t,i)=>({...t,...i}),{});h("refresh",l)})},D=async()=>{var _;(_=m.value)==null||_.validate().then(()=>{h("refresh",d.value),v.value=!1})};return U({open:b,reset_default:V}),(_,f)=>{const M=n("el-button"),s=n("el-dialog");return P(),T(s,{"align-center":"",title:_.$t("common.paramSetting"),class:"aiMode-param-dialog",modelValue:v.value,"onUpdate:modelValue":f[2]||(f[2]=l=>v.value=l),style:{width:"550px"},"append-to-body":"","destroy-on-close":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:e(()=>[c("span",ce,[a(M,{onClick:f[1]||(f[1]=O(l=>v.value=!1,["prevent"]))},{default:e(()=>[S(p(_.$t("common.cancel")),1)]),_:1}),a(M,{type:"primary",onClick:D,loading:o.value},{default:e(()=>[S(p(_.$t("common.confirm")),1)]),_:1},8,["loading"])])]),default:e(()=>[a(Y,{modelValue:d.value,"onUpdate:modelValue":f[0]||(f[0]=l=>d.value=l),model:d.value,"label-position":"top","require-asterisk-position":"right",render_data:y.value,ref_key:"dynamicsFormRef",ref:m},null,8,["modelValue","model","render_data"])]),_:1},8,["title","modelValue"])}}});const Oe=G(ue,[["__scopeId","data-v-b346fa02"]]),pe={class:"dialog-max-height"},me={class:"p-16"},_e={class:"flex align-center"},fe={class:"mr-4"},ve={class:"flex align-center"},ge={class:"mr-4"},he={class:"flex align-center"},be={class:"mr-4"},we={class:"flex align-center"},ye={class:"mr-4"},$e={class:"flex align-center"},Ve={class:"mr-4"},Se={class:"dialog-footer p-16"},Ie=E({__name:"ParamSettingDialog",emits:["refresh"],setup(A,{expose:U,emit:x}){const y=x,h=u(),m=u(),d={ai_questioning:"{question}",designated_answer:B("views.application.applicationForm.dialog.designated_answer")},v=B("views.application.applicationForm.dialog.defaultPrompt1",{question:"{question}"})+"<data></data>"+B("views.application.applicationForm.dialog.defaultPrompt2"),o=u({datasetSetting:{searchMode:"embedding",topN:3,similarity:.6,maxParagraphCharNumber:5e3,noReferencesSetting:{status:"ai_questioning",value:"{question}"}},problemOptimization:!1,problemOptimizationPrompt:v}),r=u({ai_questioning:d.ai_questioning,designated_answer:d.designated_answer}),b=te({ai_questioning:[{required:!0,message:B("views.application.applicationForm.form.aiModel.placeholder"),trigger:"blur"}],designated_answer:[{required:!0,message:B("views.application.applicationForm.form.prompt.requiredMessage"),trigger:"blur"}]}),V=u(!1),D=u(!1),_=u(!1);Q(V,l=>{var t;l||(o.value={datasetSetting:{searchMode:"embedding",topN:3,similarity:.6,maxParagraphCharNumber:5e3,noReferencesSetting:{status:"ai_questioning",value:"{question}"}},problemOptimization:!1,problemOptimizationPrompt:""},r.value={ai_questioning:d.ai_questioning,designated_answer:d.designated_answer},(t=m.value)==null||t.clearValidate())});const f=(l,t)=>{_.value=le(t),o.value={datasetSetting:{...l.datasetSetting},problemOptimization:l.problemOptimization,problemOptimizationPrompt:l.problemOptimizationPrompt},_.value||(r.value[o.value.datasetSetting.noReferencesSetting.status]=o.value.datasetSetting.noReferencesSetting.value),V.value=!0},M=async l=>{if(_.value)delete o.value.noReferencesSetting,y("refresh",o.value),V.value=!1;else{if(!l)return;await l.validate((t,i)=>{t&&(o.value.datasetSetting.noReferencesSetting.value=r.value[o.value.datasetSetting.noReferencesSetting.status],y("refresh",o.value),V.value=!1)})}};function s(l){l==="fullText"?o.value.datasetSetting.similarity=0:o.value.datasetSetting.similarity=.6}return U({open:f}),(l,t)=>{const i=n("AppIcon"),g=n("el-tooltip"),$=n("el-radio"),k=n("el-card"),w=n("el-radio-group"),R=n("el-form-item"),C=n("el-input-number"),z=n("el-col"),W=n("el-row"),J=n("el-input"),H=n("el-form"),q=n("el-switch"),I=n("el-scrollbar"),N=n("el-button"),ae=n("el-dialog");return P(),T(ae,{"align-center":"",title:l.$t("common.paramSetting"),class:"param-dialog",modelValue:V.value,"onUpdate:modelValue":t[9]||(t[9]=F=>V.value=F),style:{width:"550px"},"append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:e(()=>[c("span",Se,[a(N,{onClick:t[7]||(t[7]=O(F=>V.value=!1,["prevent"]))},{default:e(()=>[S(p(l.$t("common.cancel")),1)]),_:1}),a(N,{type:"primary",onClick:t[8]||(t[8]=F=>M(m.value)),loading:D.value},{default:e(()=>[S(p(l.$t("common.save")),1)]),_:1},8,["loading"])])]),default:e(()=>[c("div",pe,[a(I,null,{default:e(()=>[c("div",me,[a(H,{"label-position":"top",ref_key:"paramFormRef",ref:h,model:o.value},{default:e(()=>[a(R,{label:l.$t("views.application.applicationForm.dialog.selectSearchMode")},{default:e(()=>[a(w,{modelValue:o.value.datasetSetting.searchMode,"onUpdate:modelValue":t[0]||(t[0]=F=>o.value.datasetSetting.searchMode=F),class:"card__radio",onChange:s},{default:e(()=>[a(k,{shadow:"never",class:j(["mb-8",o.value.searchMode==="embedding"?"active":""])},{default:e(()=>[a($,{value:"embedding",size:"small"},{default:e(()=>[c("div",_e,[c("span",fe,p(l.$t("views.application.applicationForm.dialog.vectorSearch")),1),a(g,{effect:"dark",content:l.$t("views.application.applicationForm.dialog.vectorSearchTooltip"),placement:"right"},{default:e(()=>[a(i,{iconName:"app-warning",class:"app-warning-icon"})]),_:1},8,["content"])])]),_:1})]),_:1},8,["class"]),a(k,{shadow:"never",class:j(["mb-8",o.value.datasetSetting.searchMode==="fullText"?"active":""])},{default:e(()=>[a($,{value:"keywords",size:"small"},{default:e(()=>[c("div",ve,[c("span",ge,p(l.$t("views.application.applicationForm.dialog.fullTextSearch")),1),a(g,{effect:"dark",content:l.$t("views.application.applicationForm.dialog.fullTextSearchTooltip"),placement:"right"},{default:e(()=>[a(i,{iconName:"app-warning",class:"app-warning-icon"})]),_:1},8,["content"])])]),_:1})]),_:1},8,["class"]),a(k,{shadow:"never",class:j(o.value.datasetSetting.searchMode==="hybrid"?"active":"")},{default:e(()=>[a($,{value:"hybrid",size:"small"},{default:e(()=>[c("div",he,[c("span",be,p(l.$t("views.application.applicationForm.dialog.hybridSearch")),1),a(g,{effect:"dark",content:l.$t("views.application.applicationForm.dialog.hybridSearchTooltip"),placement:"right"},{default:e(()=>[a(i,{iconName:"app-warning",class:"app-warning-icon"})]),_:1},8,["content"])])]),_:1})]),_:1},8,["class"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),a(W,{gutter:20},{default:e(()=>[a(z,{span:12},{default:e(()=>[a(R,null,{label:e(()=>[c("div",we,[c("span",ye,p(l.$t("views.application.applicationForm.dialog.similarityThreshold")),1),a(g,{effect:"dark",content:l.$t("views.application.applicationForm.dialog.similarityTooltip"),placement:"right"},{default:e(()=>[a(i,{iconName:"app-warning",class:"app-warning-icon"})]),_:1},8,["content"])])]),default:e(()=>[a(C,{modelValue:o.value.datasetSetting.similarity,"onUpdate:modelValue":t[1]||(t[1]=F=>o.value.datasetSetting.similarity=F),min:0,max:o.value.searchMode==="hybrid"?2:1,precision:3,step:.1,"value-on-clear":0,"controls-position":"right",class:"w-full"},null,8,["modelValue","max"])]),_:1})]),_:1}),a(z,{span:12},{default:e(()=>[a(R,{label:l.$t("views.application.applicationForm.dialog.topReferences")},{default:e(()=>[a(C,{modelValue:o.value.datasetSetting.topN,"onUpdate:modelValue":t[2]||(t[2]=F=>o.value.datasetSetting.topN=F),min:1,max:1e4,"value-on-clear":1,"controls-position":"right",class:"w-full"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),_.value?L("",!0):(P(),T(R,{key:0,label:l.$t("views.application.applicationForm.dialog.noReferencesAction")},{default:e(()=>[a(H,{"label-position":"top",ref_key:"noReferencesformRef",ref:m,model:r.value,rules:b,class:"w-full","hide-required-asterisk":!0},{default:e(()=>[a(w,{modelValue:o.value.datasetSetting.noReferencesSetting.status,"onUpdate:modelValue":t[4]||(t[4]=F=>o.value.datasetSetting.noReferencesSetting.status=F),class:"radio-block"},{default:e(()=>[a($,{value:"ai_questioning"},{default:e(()=>[c("p",null,p(l.$t("views.application.applicationForm.dialog.continueQuestioning")),1)]),_:1}),a($,{value:"designated_answer"},{default:e(()=>[c("p",null,p(l.$t("views.application.applicationForm.dialog.provideAnswer")),1),o.value.datasetSetting.noReferencesSetting.status==="designated_answer"?(P(),T(R,{key:0,prop:"designated_answer"},{default:e(()=>[a(J,{modelValue:r.value.designated_answer,"onUpdate:modelValue":t[3]||(t[3]=F=>r.value.designated_answer=F),rows:2,type:"textarea",maxlength:"2048",placeholder:d.designated_answer},null,8,["modelValue","placeholder"])]),_:1})):L("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["model","rules"])]),_:1},8,["label"])),_.value?L("",!0):(P(),T(R,{key:1,onClick:t[6]||(t[6]=O(()=>{},["prevent"]))},{label:e(()=>[c("div",$e,[c("span",Ve,p(l.$t("views.application.applicationForm.form.problemOptimization.label")),1)])]),default:e(()=>[a(q,{size:"small",modelValue:o.value.problemOptimization,"onUpdate:modelValue":t[5]||(t[5]=F=>o.value.problemOptimization=F)},null,8,["modelValue"])]),_:1}))]),_:1},8,["model"])])]),_:1})])]),_:1},8,["title","modelValue"])}}});const ke={class:"flex-between mb-8"},Fe=["id"],Me={class:"flex align-center mr-8"},Re={class:"flex-between"},Ce={class:"max-height"},Pe=["title"],De={class:"flex-between"},Te={class:"flex"},Be=E({__name:"AddDatasetDialog",props:{data:{type:Array,default:()=>[]},loading:Boolean},emits:["addData","refresh"],setup(A,{expose:U,emit:x}){const y=A,h=x,m=u(!1),d=u([]),v=u(""),o=u(""),r=u([]),b=oe(()=>v.value?r.value.filter(s=>s.embeddingModelId===v.value):r.value);Q(m,s=>{s||(d.value=[],v.value="",o.value="")}),Q(o,s=>{s?r.value=y.data.filter(l=>l.name.includes(s)):r.value=y.data});function V(){d.value.length>0?v.value=y.data.filter(s=>s.id===d.value[0])[0].embeddingModelId:d.value.length===0&&(v.value="")}function D(){d.value=[],v.value=""}const _=s=>{r.value=y.data,d.value=s,d.value.length>0&&(v.value=y.data.filter(l=>l.id===d.value[0])[0].embeddingModelId),m.value=!0},f=()=>{h("addData",d.value),m.value=!1},M=()=>{h("refresh")};return U({open:_}),(s,l)=>{const t=n("Refresh"),i=n("el-icon"),g=n("el-button"),$=n("el-divider"),k=n("el-text"),w=n("el-input"),R=n("CardCheckbox"),C=n("el-col"),z=n("el-row"),W=n("el-scrollbar"),J=n("el-dialog"),H=ne("loading");return P(),T(J,{title:s.$t("views.application.applicationForm.dialog.addDataset"),modelValue:m.value,"onUpdate:modelValue":l[3]||(l[3]=q=>m.value=q),width:"600","append-to-body":"",class:"addDataset-dialog","align-center":"","close-on-click-modal":!1,"close-on-press-escape":!1},{header:e(({titleId:q,titleClass:I})=>[c("div",ke,[c("h4",{id:q,class:j(I)},p(s.$t("views.application.applicationForm.dialog.addDataset")),11,Fe),c("div",Me,[a(g,{link:"",class:"ml-16",onClick:M},{default:e(()=>[a(i,{class:"mr-4"},{default:e(()=>[a(t)]),_:1}),S(p(s.$t("common.refresh")),1)]),_:1}),a($,{direction:"vertical"})])]),c("div",Re,[a(k,{type:"info",class:"color-secondary"},{default:e(()=>[S(p(s.$t("views.application.applicationForm.dialog.addDatasetPlaceholder")),1)]),_:1}),a(w,{modelValue:o.value,"onUpdate:modelValue":l[0]||(l[0]=N=>o.value=N),placeholder:s.$t("common.search"),"prefix-icon":"Search",class:"w-240",clearable:""},null,8,["modelValue","placeholder"])])]),footer:e(()=>[c("div",De,[c("div",Te,[d.value.length>0?(P(),T(k,{key:0,type:"info",class:"color-secondary mr-8"},{default:e(()=>[S(p(s.$t("views.application.applicationForm.dialog.selected"))+" "+p(d.value.length)+" "+p(s.$t("views.application.applicationForm.dialog.countDataset")),1)]),_:1})):L("",!0),d.value.length>0?(P(),T(g,{key:1,link:"",type:"primary",onClick:D},{default:e(()=>[S(p(s.$t("common.clear")),1)]),_:1})):L("",!0)]),c("span",null,[a(g,{onClick:l[2]||(l[2]=O(q=>m.value=!1,["prevent"]))},{default:e(()=>[S(p(s.$t("common.cancel")),1)]),_:1}),a(g,{type:"primary",onClick:f},{default:e(()=>[S(p(s.$t("common.confirm")),1)]),_:1})])])]),default:e(()=>[a(W,null,{default:e(()=>[c("div",Ce,[ie((P(),T(z,{gutter:12},{default:e(()=>[(P(!0),X(ee,null,se(b.value,(q,I)=>(P(),T(C,{span:12,key:I,class:"mb-16"},{default:e(()=>[a(R,{"value-field":"id",data:q,modelValue:d.value,"onUpdate:modelValue":l[1]||(l[1]=N=>d.value=N),onChange:V},{default:e(()=>[c("span",{class:"ellipsis cursor",title:q.name},p(q.name),9,Pe)]),_:2},1032,["data","modelValue"])]),_:2},1024))),128))]),_:1})),[[H,A.loading]])])]),_:1})]),_:1},8,["title","modelValue"])}}});const qe={class:"flex-between"},Ue={class:"p-16"},xe={class:"dialog-footer p-16"},Ae=E({__name:"TTSModeParamSettingDialog",emits:["refresh"],setup(A,{expose:U,emit:x}){const{params:{id:y}}=re.config.globalProperties.$route,h=u(""),m=u([]),d=x,v=u(),o=u({}),r=u(!1),b=u(!1),V=u(!1),D=(t,i)=>i?K.getModelParamsForm(i,t,b):Z.getModelParamsForm(t,b),_=(t,i,g)=>{o.value={},h.value=t,D(t,i).then(k=>{var R;m.value=k.data;const w=k.data.map(C=>({[C.field]:C.show_default_value!==!1?C.default_value:void 0})).reduce((C,z)=>({...C,...z}),{});g&&Object.keys(g).forEach(C=>{C in w||delete g[C]}),g={...w,...g},(R=v.value)==null||R.render(m.value,g)}),r.value=!0},f=(t,i)=>{D(t,i).then($=>{m.value=$.data;const k=$.data.map(w=>({[w.field]:w.show_default_value!==!1?w.default_value:void 0})).reduce((w,R)=>({...w,...R}),{});d("refresh",k)})},M=async()=>{var t;(t=v.value)==null||t.validate().then(()=>{d("refresh",o.value),r.value=!1})},s=u(null),l=()=>{const t={...o.value,ttsModelId:h.value};K.playDemoText(y,t,V).then(async i=>{if(i.type==="application/json"){const k=await i.text();de(k);return}const g=new Blob([i],{type:"audio/mp3"}),$=URL.createObjectURL(g);s.value instanceof HTMLAudioElement?(s.value.src=$,s.value.play()):console.error("audioPlayer.value is not an instance of HTMLAudioElement")}).catch(i=>{console.log("err: ",i)})};return U({open:_,reset_default:f}),(t,i)=>{const g=n("AppIcon"),$=n("el-button"),k=n("el-dialog");return P(),X(ee,null,[a(k,{"align-center":"",title:t.$t("common.paramSetting"),class:"aiMode-param-dialog",modelValue:r.value,"onUpdate:modelValue":i[2]||(i[2]=w=>r.value=w),style:{width:"550px"},"append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:e(()=>[c("div",qe,[c("span",Ue,[a($,{onClick:l,loading:V.value},{default:e(()=>[a(g,{iconName:"app-video-play",class:"mr-4"}),S(" "+p(t.$t("views.application.applicationForm.form.voicePlay.listeningTest")),1)]),_:1},8,["loading"])]),c("span",xe,[a($,{onClick:i[1]||(i[1]=O(w=>r.value=!1,["prevent"]))},{default:e(()=>[S(p(t.$t("common.cancel")),1)]),_:1}),a($,{type:"primary",onClick:M,loading:b.value},{default:e(()=>[S(p(t.$t("common.confirm")),1)]),_:1},8,["loading"])])])]),default:e(()=>[a(Y,{modelValue:o.value,"onUpdate:modelValue":i[0]||(i[0]=w=>o.value=w),model:o.value,"label-position":"top","require-asterisk-position":"right",render_data:m.value,ref_key:"dynamicsFormRef",ref:v},null,8,["modelValue","model","render_data"])]),_:1},8,["title","modelValue"]),c("audio",{ref_key:"audioPlayer",ref:s,controls:"",hidden:"hidden"},null,512)],64)}}});const Le=G(Ae,[["__scopeId","data-v-ca3e78b4"]]),ze={class:"dialog-footer p-16"},Ee=E({__name:"ReasoningParamSettingDialog",emits:["refresh"],setup(A,{expose:U,emit:x}){const y=x,h=u({reasoning_content_start:"<think>",reasoning_content_end:"</think>"}),m=u(!1),d=u(!1);Q(m,r=>{r||(h.value={reasoning_content_start:"<think>",reasoning_content_end:"</think>"})});const v=r=>{h.value={...h.value,...r},m.value=!0},o=()=>{y("refresh",h.value),m.value=!1};return U({open:v}),(r,b)=>{const V=n("el-text"),D=n("el-input"),_=n("el-form-item"),f=n("el-col"),M=n("el-row"),s=n("el-form"),l=n("el-button"),t=n("el-dialog");return P(),T(t,{"align-center":"",title:r.$t("common.setting"),class:"param-dialog",modelValue:m.value,"onUpdate:modelValue":b[4]||(b[4]=i=>m.value=i),style:{width:"550px"},"append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:e(()=>[c("span",ze,[a(l,{onClick:b[2]||(b[2]=O(i=>m.value=!1,["prevent"]))},{default:e(()=>[S(p(r.$t("common.cancel")),1)]),_:1}),a(l,{type:"primary",onClick:b[3]||(b[3]=i=>o()),loading:d.value},{default:e(()=>[S(p(r.$t("common.save")),1)]),_:1},8,["loading"])])]),default:e(()=>[a(s,{"label-position":"top",ref:"paramFormRef",model:h.value,class:"p-12-16"},{default:e(()=>[a(V,{type:"info",class:"color-secondary"},{default:e(()=>[S(p(r.$t("views.application.applicationForm.form.reasoningContent.tooltip")),1)]),_:1}),a(M,{class:"mt-16",gutter:20},{default:e(()=>[a(f,{span:12},{default:e(()=>[a(_,{label:r.$t("views.application.applicationForm.form.reasoningContent.start")},{default:e(()=>[a(D,{modelValue:h.value.reasoning_content_start,"onUpdate:modelValue":b[0]||(b[0]=i=>h.value.reasoning_content_start=i),rows:6,maxlength:"50",placeholder:"<think>"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),a(f,{span:12},{default:e(()=>[a(_,{label:r.$t("views.application.applicationForm.form.reasoningContent.end")},{default:e(()=>[a(D,{modelValue:h.value.reasoning_content_end,"onUpdate:modelValue":b[1]||(b[1]=i=>h.value.reasoning_content_end=i),rows:6,maxlength:"50",placeholder:"</think>"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])}}});export{Oe as A,Le as T,Ee as _,Ie as a,Be as b};

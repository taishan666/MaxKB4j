import{cp as j,cq as w,di as oe,cu as u,cx as r,cF as h,cA as l,cB as t,cz as o,cE as M,cK as v,cJ as s,cN as B,cy as U,cC as Z,cD as Y,cT as ce,dl as de,cr as O,c_ as re,cZ as P,cH as H,ev as se,cR as G,d1 as ne,d6 as pe,ct as _e,cU as me,cV as ue,cv as ve,ew as J,ex as $e,dz as fe,eb as we,ey as ge,ep as be,cY as ee,ez as he,dx as ye,dm as te}from"./index-938a5085.js";import{_ as ie}from"./ParagraphForm.vue_vue_type_script_setup_true_lang-dfa061ab.js";const ke={class:"bold title p-24",style:{"padding-bottom":"0"}},Ce={class:"flex align-center"},Le={class:"p-24",style:{"padding-top":"16px"}},Ve={key:1,class:"p-24"},Te={class:"dialog-footer"},Re=j({__name:"EditParagraphDialog",props:{isConnect:Boolean},emits:["updateContent"],setup(z,{expose:R,emit:S}){const V=S,k=w(!1),a=w({}),$=w(),d=w(),_=w(!1),b=w("");oe(k,i=>{i||(a.value={})});const C=i=>{a.value=ce.cloneDeep(i),k.value=!0};function T(i,e){a.value.problem_list.splice(e,1)}function y(){var i,e,n;b.value.trim()&&((i=a.value)!=null&&i.problem_list.some(c=>c.content===b.value.trim())||(n=(e=a.value)==null?void 0:e.problem_list)==null||n.push({content:b.value.trim()}),b.value="",_.value=!1)}function E(){_.value=!0,de(()=>{var i;(i=d.value)==null||i.focus()})}const f=async()=>{var i,e;await((i=$.value)==null?void 0:i.validate())&&(V("updateContent",{problem_list:a.value.problem_list,...(e=$.value)==null?void 0:e.form}),k.value=!1)};return R({open:C}),(i,e)=>{const n=u("el-col"),c=u("el-divider"),p=u("Plus"),g=u("el-icon"),D=u("el-button"),A=u("el-input"),L=u("auto-tooltip"),I=u("TagEllipsis"),X=u("el-scrollbar"),Q=u("el-row"),q=u("el-dialog");return r(),h(q,{title:i.$t("views.paragraph.editParagraph"),modelValue:k.value,"onUpdate:modelValue":e[3]||(e[3]=x=>k.value=x),width:"80%","destroy-on-close":"",class:"paragraph-dialog","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:l(()=>[t("span",Te,[o(D,{onClick:e[2]||(e[2]=M(x=>k.value=!1,["prevent"]))},{default:l(()=>[v(s(i.$t("common.cancel")),1)]),_:1}),o(D,{type:"primary",onClick:f},{default:l(()=>[v(s(i.$t("common.save")),1)]),_:1})])]),default:l(()=>[z.isConnect?(r(),h(Q,{key:0},{default:l(()=>[o(n,{span:18,class:"p-24"},{default:l(()=>[o(ie,{ref_key:"paragraphFormRef",ref:$,data:a.value,isEdit:!0},null,8,["data"])]),_:1}),o(n,{span:6,class:"border-l",style:{width:"300px"}},{default:l(()=>[t("p",ke,[t("span",Ce,[t("span",null,s(i.$t("views.paragraph.relatedProblem.title")),1),o(c,{direction:"vertical",class:"mr-4"}),o(D,{text:"",onClick:E},{default:l(()=>[o(g,null,{default:l(()=>[o(p)]),_:1})]),_:1})])]),o(X,{height:"500px"},{default:l(()=>[t("div",Le,[_.value?(r(),h(A,{key:0,modelValue:b.value,"onUpdate:modelValue":e[0]||(e[0]=x=>b.value=x),placeholder:i.$t("views.paragraph.relatedProblem.placeholder"),onChange:y,onBlur:e[1]||(e[1]=x=>_.value=!1),ref_key:"inputRef",ref:d,class:"mb-8"},null,8,["modelValue","placeholder"])):B("",!0),(r(!0),U(Z,null,Y(a.value.problem_list,(x,N)=>(r(),h(I,{key:N,onClose:K=>T(x,N),class:"question-tag",type:"info",effect:"plain",closable:""},{default:l(()=>[o(L,{content:x.content},{default:l(()=>[v(s(x.content),1)]),_:2},1032,["content"])]),_:2},1032,["onClose"]))),128))])]),_:1})]),_:1})]),_:1})):(r(),U("div",Ve,[o(ie,{ref_key:"paragraphFormRef",ref:$,data:a.value,isEdit:!0},null,8,["data"])]))]),_:1},8,["title","modelValue"])}}}),Se={class:"flex-between"},De={class:"lighter mt-12"},Fe={class:"lighter mt-12"},xe=j({__name:"ParagraphList",props:{modelValue:{},isConnect:{type:Boolean}},emits:["update:modelValue"],setup(z,{emit:R}){const S=w(30),V=w(1),k=w(0),a=w(),$=R,d=w(!1),_=(f,i)=>{k.value=i,a.value.open(f)},b=z,C=O(()=>b.modelValue.slice(0,S.value*(V.value-1)+S.value)),T=()=>{d.value=!0,V.value+=1,d.value=!1},y=f=>{const i=[...b.modelValue];b.isConnect&&f.title&&!(f!=null&&f.problem_list.some(e=>e.content===f.title.trim()))&&f.problem_list.push({content:f.title.trim()}),i[k.value]=ce.cloneDeep(f),$("update:modelValue",i)},E=(f,i)=>{re(`${P("views.paragraph.delete.confirmTitle")}${f.title||"-"} ?`,P("views.paragraph.delete.confirmMessage"),{confirmButtonText:P("common.confirm"),confirmButtonClass:"danger"}).then(()=>{const e=[...b.modelValue];e.splice(i,1),$("update:modelValue",e)}).catch(()=>{})};return(f,i)=>{const e=u("EditPen"),n=u("el-icon"),c=u("el-button"),p=u("Delete"),g=u("el-text"),D=u("el-card"),A=u("InfiniteScroll");return r(),U("div",null,[o(A,{size:C.value.length,total:f.modelValue.length,page_size:S.value,current_page:V.value,"onUpdate:current_page":i[0]||(i[0]=L=>V.value=L),onLoad:i[1]||(i[1]=L=>T()),loading:d.value},{default:l(()=>[(r(!0),U(Z,null,Y(C.value,(L,I)=>(r(),h(D,{key:I,shadow:"never",class:"card-never mb-16"},{default:l(()=>[t("div",Se,[t("span",null,s(L.title||"-"),1),t("div",null,[o(c,{link:"",onClick:X=>_(L,I)},{default:l(()=>[o(n,null,{default:l(()=>[o(e)]),_:1})]),_:2},1032,["onClick"]),o(c,{link:"",onClick:X=>E(L,I)},{default:l(()=>[o(n,null,{default:l(()=>[o(p)]),_:1})]),_:2},1032,["onClick"])])]),t("div",De,s(L.content),1),t("div",Fe,[o(g,{type:"info"},{default:l(()=>[v(s(L.content.length)+" "+s(f.$t("views.paragraph.character_count")),1)]),_:2},1024)])]),_:2},1024))),128))]),_:1},8,["size","total","page_size","current_page","loading"]),o(Re,{ref_key:"EditParagraphDialogRef",ref:a,onUpdateContent:y,isConnect:f.isConnect},null,8,["isConnect"])])}}}),Pe={class:"flex-center"},Ue=["src"],ze={class:"ml-4"},Ee={class:"mb-16"},Ae={key:0,class:"paragraph-list"},Me=j({__name:"ParagraphPreview",props:{data:{type:Array,default:()=>[]},isConnect:Boolean},setup(z){const R=w(0);return(S,V)=>{const k=u("el-text"),a=u("el-scrollbar"),$=u("el-tab-pane"),d=u("el-tabs");return r(),h(d,{modelValue:R.value,"onUpdate:modelValue":V[0]||(V[0]=_=>R.value=_),class:"paragraph-tabs"},{default:l(()=>[(r(!0),U(Z,null,Y(z.data,(_,b)=>(r(),h($,{key:b,label:_.name,name:b},{label:l(()=>[t("div",Pe,[t("img",{src:H(se)(_&&(_==null?void 0:_.name)),alt:"",height:"16"},null,8,Ue),t("span",ze,s(_==null?void 0:_.name),1)])]),default:l(()=>[t("div",Ee,[o(k,{type:"info"},{default:l(()=>[v(s(_.content.length)+" "+s(S.$t("views.paragraph.title")),1)]),_:2},1024)]),R.value==b?(r(),U("div",Ae,[o(a,null,{default:l(()=>[o(xe,{modelValue:_.content,"onUpdate:modelValue":C=>_.content=C,isConnect:z.isConnect},null,8,["modelValue","onUpdate:modelValue","isConnect"])]),_:2},1024)])):B("",!0)]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])}}});const Ie=G(Me,[["__scopeId","data-v-3c94fa77"]]),Be={class:"set-rules"},Xe={class:"title-decoration-1 mb-16"},Ne={class:"set-rules__right"},He={class:"mb-4"},Qe={class:"mb-4"},qe={class:"set-rules__form"},Oe={class:"form-item mb-16"},Ze={class:"title flex align-center mb-8"},je={style:{"margin-right":"4px"}},Ke={class:"form-item mb-16"},Je={class:"title mb-8"},Ye={class:"form-item mb-16"},Ge={class:"title mb-8"},We={style:{"margin-top":"4px"}},et={class:"text-right mt-8"},tt={class:"title-decoration-1 mb-8"},lt=j({__name:"SetRules",setup(z,{expose:R}){const{dataset:S}=ne(),V=O(()=>S.documentsFiles),k=w([]),a=w("1"),$=w(!1),d=w([]),_=w(!1),b=w(!1),C=w(!0),T=pe({patterns:[],limit:500,with_filter:!0});function y(i){i&&C.value&&(d.value=d.value.map(e=>({...e,content:e.content.map(n=>({...n,problem_list:n.title.trim()?[{content:n.title.trim()}]:[]}))})),C.value=!1)}function E(){$.value=!0;let i=new FormData;V.value.forEach(e=>{e!=null&&e.raw&&i.append("file",e==null?void 0:e.raw)}),a.value==="2"&&Object.keys(T).forEach(e=>{e=="patterns"?T.patterns.forEach(n=>i.append("patterns",n)):i.append(e,T[e])}),J.postSplitDocument(i).then(e=>{const n=e.data;n.map(c=>{c.name.length>128&&(c.name=$e(c.name,128)),b.value&&c.content.map(p=>{p.problem_list=p.title.trim()?[{content:p.title.trim()}]:[]})}),d.value=n,$.value=!1}).catch(()=>{$.value=!1})}const f=()=>{J.listSplitPattern(_).then(i=>{k.value=i.data})};return oe(a,()=>{a.value==="2"&&f()}),_e(()=>{E()}),R({paragraphList:d,checkedConnect:b,loading:$}),(i,e)=>{const n=u("el-text"),c=u("el-radio"),p=u("el-card"),g=u("AppIcon"),D=u("el-tooltip"),A=u("el-option"),L=u("el-select"),I=u("el-slider"),X=u("el-switch"),Q=u("el-radio-group"),q=u("el-scrollbar"),x=u("el-checkbox"),N=u("el-button"),K=u("el-col"),W=u("el-row"),m=me("loading");return r(),U("div",Be,[o(W,null,{default:l(()=>[o(K,{span:10,class:"p-24"},{default:l(()=>[t("h4",Xe,s(i.$t("views.document.setRules.title.setting")),1),t("div",Ne,[o(q,null,{default:l(()=>[t("div",{class:"left-height",onClick:e[5]||(e[5]=M(()=>{},["stop"]))},[o(Q,{modelValue:a.value,"onUpdate:modelValue":e[4]||(e[4]=F=>a.value=F),class:"set-rules__radio"},{default:l(()=>[o(p,{shadow:"never",class:ue(["mb-16",a.value==="1"?"active":""])},{default:l(()=>[o(c,{value:"1",size:"large"},{default:l(()=>[t("p",He,s(i.$t("views.document.setRules.intelligent.label")),1),o(n,{type:"info"},{default:l(()=>[v(s(i.$t("views.document.setRules.intelligent.text")),1)]),_:1})]),_:1})]),_:1},8,["class"]),o(p,{shadow:"never",class:ue(["mb-16",a.value==="2"?"active":""])},{default:l(()=>[o(c,{value:"2",size:"large"},{default:l(()=>[t("p",Qe,s(i.$t("views.document.setRules.advanced.label")),1),o(n,{type:"info"},{default:l(()=>[v(s(i.$t("views.document.setRules.advanced.text")),1)]),_:1})]),_:1}),a.value==="2"?(r(),h(p,{key:0,shadow:"never",class:"card-never mt-16",style:{"margin-left":"30px"}},{default:l(()=>[t("div",qe,[t("div",Oe,[t("div",Ze,[t("span",je,s(i.$t("views.document.setRules.patterns.label")),1),o(D,{effect:"dark",content:i.$t("views.document.setRules.patterns.tooltip"),placement:"right"},{default:l(()=>[o(g,{iconName:"app-warning",class:"app-warning-icon"})]),_:1},8,["content"])]),t("div",{onClick:e[1]||(e[1]=M(()=>{},["stop"]))},[o(L,{modelValue:T.patterns,"onUpdate:modelValue":e[0]||(e[0]=F=>T.patterns=F),multiple:"","allow-create":"","default-first-option":"",filterable:"",placeholder:i.$t("views.document.setRules.patterns.placeholder")},{default:l(()=>[(r(!0),U(Z,null,Y(k.value,(F,ae)=>(r(),h(A,{key:ae,label:F.key,value:F.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])])]),t("div",Ke,[t("div",Je,s(i.$t("views.document.setRules.limit.label")),1),o(I,{modelValue:T.limit,"onUpdate:modelValue":e[2]||(e[2]=F=>T.limit=F),"show-input":"","show-input-controls":!1,min:50,max:1e5},null,8,["modelValue"])]),t("div",Ye,[t("div",Ge,s(i.$t("views.document.setRules.with_filter.label")),1),o(X,{size:"small",modelValue:T.with_filter,"onUpdate:modelValue":e[3]||(e[3]=F=>T.with_filter=F)},null,8,["modelValue"]),t("div",We,[o(n,{type:"info"},{default:l(()=>[v(s(i.$t("views.document.setRules.with_filter.text")),1)]),_:1})])])])]),_:1})):B("",!0)]),_:1},8,["class"])]),_:1},8,["modelValue"])])]),_:1}),t("div",null,[o(x,{modelValue:b.value,"onUpdate:modelValue":e[6]||(e[6]=F=>b.value=F),onChange:y,style:{"white-space":"normal"}},{default:l(()=>[v(s(i.$t("views.document.setRules.checkedConnect.label")),1)]),_:1},8,["modelValue"])]),t("div",et,[o(N,{onClick:E},{default:l(()=>[v(s(i.$t("views.document.buttons.preview")),1)]),_:1})])])]),_:1}),o(K,{span:14,class:"p-24 border-l"},{default:l(()=>[ve((r(),U("div",null,[t("h4",tt,s(i.$t("views.document.setRules.title.preview")),1),o(Ie,{data:d.value,"onUpdate:data":e[7]||(e[7]=F=>d.value=F),isConnect:b.value},null,8,["data","isConnect"])])),[[m,$.value]])]),_:1})]),_:1})])}}});const ot=G(lt,[["__scopeId","data-v-ad74046c"]]),st={class:"mt-8"},nt={class:"bold"},at={class:"bold"},ut={class:"bold"},it={class:"result-success"},ct={class:"bolder"},dt={class:"flex-between"},rt={class:"flex"},pt=["src"],_t={class:"ml-8"},mt=j({__name:"ResultSuccess",props:{data:{type:Object,default:()=>{}}},setup(z){const R=z,S=fe(),V=O(()=>{var a;return(a=R.data)==null?void 0:a.documentList.reduce(($,d)=>$+=d.paragraphCount,0)}),k=O(()=>{var a;return((a=R.data)==null?void 0:a.documentList.reduce(($,d)=>$+=d.charLength,0))||0});return(a,$)=>{const d=u("el-text"),_=u("el-divider"),b=u("el-button"),C=u("el-result"),T=u("SuccessFilled"),y=u("el-icon"),E=u("CircleCloseFilled"),f=u("Loading"),i=u("el-card"),e=u("el-scrollbar");return r(),h(e,null,{default:l(()=>{var n;return[o(C,{icon:"success",title:`🎉 ${a.$t("views.dataset.ResultSuccess.title")} 🎉`},{"sub-title":l(()=>{var c;return[t("div",st,[t("span",nt,s(((c=z.data)==null?void 0:c.documentList.length)||0),1),o(d,{type:"info",class:"ml-4"},{default:l(()=>[v(s(a.$t("common.fileUpload.document")),1)]),_:1}),o(_,{direction:"vertical"}),t("span",at,s(V.value||0),1),o(d,{type:"info",class:"ml-4"},{default:l(()=>[v(s(a.$t("views.dataset.ResultSuccess.paragraph")),1)]),_:1}),o(_,{direction:"vertical"}),t("span",ut,s(H(we)(k.value)||0),1),o(d,{type:"info",class:"ml-4"},{default:l(()=>[v(s(a.$t("common.character")),1)]),_:1})])]}),extra:l(()=>[o(b,{onClick:$[0]||($[0]=c=>H(S).push({path:"/dataset"}))},{default:l(()=>[v(s(a.$t("views.dataset.ResultSuccess.buttons.toDataset")),1)]),_:1}),o(b,{type:"primary",onClick:$[1]||($[1]=c=>{var p;return H(S).push({path:`/dataset/${(p=z.data)==null?void 0:p.id}/document`})})},{default:l(()=>[v(s(a.$t("views.dataset.ResultSuccess.buttons.toDocument")),1)]),_:1})]),_:1},8,["title"]),t("div",it,[t("p",ct,s(a.$t("views.dataset.ResultSuccess.documentList")),1),(r(!0),U(Z,null,Y((n=z.data)==null?void 0:n.documentList,(c,p)=>(r(),h(i,{shadow:"never",class:"file-List-card mt-8",key:p},{default:l(()=>[t("div",dt,[t("div",rt,[t("img",{src:H(se)(c&&(c==null?void 0:c.name)),alt:"",width:"40"},null,8,pt),t("div",_t,[t("p",null,s(c&&(c==null?void 0:c.name)),1),o(d,{type:"info",size:"small"},{default:l(()=>[v(s(H(ge)(c&&(c==null?void 0:c.charLength))),1)]),_:2},1024)])]),t("div",null,[o(d,{type:"info",class:"mr-16"},{default:l(()=>[v(s(c&&(c==null?void 0:c.paragraphCount))+" "+s(a.$t("views.dataset.ResultSuccess.paragraphCount")),1)]),_:2},1024),c.status==="1"?(r(),h(d,{key:0},{default:l(()=>[o(y,{class:"success"},{default:l(()=>[o(T)]),_:1})]),_:1})):c.status==="2"?(r(),h(d,{key:1},{default:l(()=>[o(y,{class:"danger"},{default:l(()=>[o(E)]),_:1})]),_:1})):c.status==="0"?(r(),h(d,{key:2},{default:l(()=>[o(y,{class:"is-loading primary"},{default:l(()=>[o(f)]),_:1}),v(" "+s(a.$t("views.dataset.ResultSuccess.loading"))+"... ",1)]),_:1})):B("",!0)])])]),_:2},1024))),128))])]}),_:1})}}});const vt=G(mt,[["__scopeId","data-v-837abff8"]]),le="/assets/upload-icon-d03fdea5.svg",ft={class:"title-decoration-1 mb-8"},gt={class:"mt-16 mb-16"},bt={class:"update-info flex p-8-12 border-r-4 mb-16 w-full"},$t={class:"mt-4"},wt={class:"ml-16 lighter"},ht={class:"el-upload__text"},yt={class:"upload__decoration"},kt={class:"update-info flex p-8-12 border-r-4 mb-16 w-full"},Ct={class:"mt-4"},Lt={class:"ml-16 lighter"},Vt={class:"el-upload__text"},Tt={class:"upload__decoration"},Rt={class:"update-info flex p-8-12 border-r-4 mb-16 w-full"},St={class:"mt-4"},Dt={class:"ml-16 lighter"},Ft={class:"el-upload__text"},xt={class:"upload__decoration"},Pt={class:"flex-between"},Ut={class:"flex"},zt=["src"],Et={class:"ml-8"},At=j({__name:"UploadComponent",setup(z,{expose:R}){const{dataset:S}=ne(),V=O(()=>S.documentsFiles),k=O(()=>S.documentsType),a=w({fileType:"txt",fileList:[]}),$=pe({fileList:[{required:!0,message:P("views.document.upload.requiredMessage"),trigger:"change"}]}),d=w();oe(a.value,e=>{S.saveDocumentsType(e.fileType),S.saveDocumentsFile(e.fileList)});function _(e){J.exportQATemplate(`${e}${P("views.document.upload.template")}.${e=="csv"?e:"xlsx"}`,e)}function b(e){J.exportTableTemplate(`${e}${P("views.document.upload.template")}.${e=="csv"?e:"xlsx"}`,e)}function C(){a.value.fileList=[]}function T(e){a.value.fileList.splice(e,1)}const y=(e,n)=>{if(!((e==null?void 0:e.size)/1024/1024<100))return ee(P("views.document.upload.errorMessage1")),n.splice(-1,1),!1;if(!he(e==null?void 0:e.name,a.value.fileType))return(e==null?void 0:e.name)!==".DS_Store"&&ee(P("views.document.upload.errorMessage2")),n.splice(-1,1),!1;if((e==null?void 0:e.size)===0)return ee(P("views.document.upload.errorMessage3")),n.splice(-1,1),!1},E=()=>{ee(P("views.document.upload.errorMessage4"))},f=e=>{let n=null;de(()=>{document.querySelector(".el-upload__input")!=null&&(n=document.querySelector(".el-upload__input"),n.webkitdirectory=e)})};function i(){if(d.value)return d.value.validate(e=>e)}return _e(()=>{k.value&&(a.value.fileType=k.value),V.value&&(a.value.fileList=V.value)}),be(()=>{a.value={fileType:"txt",fileList:[]}}),R({validate:i,form:a}),(e,n)=>{var W;const c=u("el-radio-button"),p=u("el-radio-group"),g=u("AppIcon"),D=u("el-button"),A=u("el-upload"),L=u("el-form-item"),I=u("el-form"),X=u("el-text"),Q=u("Delete"),q=u("el-icon"),x=u("el-card"),N=u("el-col"),K=u("el-row");return r(),U(Z,null,[t("h4",ft,s(e.$t("views.document.uploadDocument")),1),o(I,{ref_key:"FormRef",ref:d,model:a.value,rules:$,"label-position":"top","require-asterisk-position":"right"},{default:l(()=>[t("div",gt,[o(p,{modelValue:a.value.fileType,"onUpdate:modelValue":n[0]||(n[0]=m=>a.value.fileType=m),onChange:C,class:"app-radio-button-group"},{default:l(()=>[o(c,{value:"txt"},{default:l(()=>[v(s(e.$t("views.document.fileType.txt.label")),1)]),_:1}),o(c,{value:"table"},{default:l(()=>[v(s(e.$t("views.document.fileType.table.label")),1)]),_:1}),o(c,{value:"QA"},{default:l(()=>[v(s(e.$t("views.document.fileType.QA.label")),1)]),_:1})]),_:1},8,["modelValue"])]),a.value.fileType==="QA"?(r(),h(L,{key:0,prop:"fileList"},{default:l(()=>[t("div",bt,[t("div",$t,[o(g,{iconName:"app-warning-colorful",style:{"font-size":"16px"}})]),t("div",wt,[t("p",null,[v(s(e.$t("views.document.fileType.QA.tip1"))+" ",1),o(D,{type:"primary",link:"",onClick:n[1]||(n[1]=m=>_("excel"))},{default:l(()=>[v(s(e.$t("views.document.upload.download"))+" Excel "+s(e.$t("views.document.upload.template")),1)]),_:1}),o(D,{type:"primary",link:"",onClick:n[2]||(n[2]=m=>_("csv"))},{default:l(()=>[v(s(e.$t("views.document.upload.download"))+" CSV "+s(e.$t("views.document.upload.template")),1)]),_:1})]),t("p",null,s(e.$t("views.document.fileType.QA.tip2")),1),t("p",null,s(e.$t("views.document.fileType.QA.tip3")),1)])]),o(A,{webkitdirectory:!1,class:"w-full mb-4",drag:"",multiple:"","file-list":a.value.fileList,"onUpdate:fileList":n[5]||(n[5]=m=>a.value.fileList=m),action:"#","auto-upload":!1,"show-file-list":!1,accept:".xlsx, .xls, .csv,.zip",limit:50,"on-exceed":E,"on-change":y,onClick:n[6]||(n[6]=M(m=>f(!1),["prevent"]))},{default:l(()=>[n[17]||(n[17]=t("img",{src:le,alt:""},null,-1)),t("div",ht,[t("p",null,[v(s(e.$t("views.document.upload.uploadMessage"))+" ",1),t("em",{class:"hover",onClick:n[3]||(n[3]=M(m=>f(!1),["prevent"]))},s(e.$t("views.document.upload.selectFile")),1),t("em",{class:"hove ml-4",onClick:n[4]||(n[4]=M(m=>f(!0),["prevent"]))},s(e.$t("views.document.upload.selectFiles")),1)]),t("div",yt,[t("p",null,s(e.$t("views.document.upload.formats"))+"XLS、XLSX、CSV、ZIP",1)])])]),_:1},8,["file-list"])]),_:1})):a.value.fileType==="table"?(r(),h(L,{key:1,prop:"fileList"},{default:l(()=>[t("div",kt,[t("div",Ct,[o(g,{iconName:"app-warning-colorful",style:{"font-size":"16px"}})]),t("div",Lt,[t("p",null,[v(s(e.$t("views.document.fileType.table.tip1"))+" ",1),o(D,{type:"primary",link:"",onClick:n[7]||(n[7]=m=>b("excel"))},{default:l(()=>[v(s(e.$t("views.document.upload.download"))+" Excel "+s(e.$t("views.document.upload.template")),1)]),_:1}),o(D,{type:"primary",link:"",onClick:n[8]||(n[8]=m=>b("csv"))},{default:l(()=>[v(s(e.$t("views.document.upload.download"))+" CSV "+s(e.$t("views.document.upload.template")),1)]),_:1})]),t("p",null,s(e.$t("views.document.fileType.table.tip2")),1),t("p",null,s(e.$t("views.document.fileType.table.tip3")),1),t("p",null,s(e.$t("views.document.fileType.table.tip4")),1)])]),o(A,{webkitdirectory:!1,class:"w-full mb-4",drag:"",multiple:"","file-list":a.value.fileList,"onUpdate:fileList":n[11]||(n[11]=m=>a.value.fileList=m),action:"#","auto-upload":!1,"show-file-list":!1,accept:".xlsx, .xls, .csv",limit:50,"on-exceed":E,"on-change":y,onClick:n[12]||(n[12]=M(m=>f(!1),["prevent"]))},{default:l(()=>[n[18]||(n[18]=t("img",{src:le,alt:""},null,-1)),t("div",Vt,[t("p",null,[v(s(e.$t("views.document.upload.uploadMessage"))+" ",1),t("em",{class:"hover",onClick:n[9]||(n[9]=M(m=>f(!1),["prevent"]))},s(e.$t("views.document.upload.selectFile")),1),t("em",{class:"hover ml-4",onClick:n[10]||(n[10]=M(m=>f(!0),["prevent"]))},s(e.$t("views.document.upload.selectFiles")),1)]),t("div",Tt,[t("p",null,s(e.$t("views.document.upload.formats"))+"XLS、XLSX、CSV",1)])])]),_:1},8,["file-list"])]),_:1})):(r(),h(L,{key:2,prop:"fileList"},{default:l(()=>[t("div",Rt,[t("div",St,[o(g,{iconName:"app-warning-colorful",style:{"font-size":"16px"}})]),t("div",Dt,[t("p",null,s(e.$t("views.document.fileType.txt.tip1")),1),t("p",null,s(e.$t("views.document.fileType.txt.tip2")),1)])]),o(A,{webkitdirectory:!1,class:"w-full",drag:"",multiple:"","file-list":a.value.fileList,"onUpdate:fileList":n[15]||(n[15]=m=>a.value.fileList=m),action:"#","auto-upload":!1,"show-file-list":!1,accept:".txt, .md, .log, .docx, .pdf, .html,.zip,.xlsx,.xls,.csv",limit:50,"on-exceed":E,"on-change":y,onClick:n[16]||(n[16]=M(m=>f(!1),["prevent"]))},{default:l(()=>[n[19]||(n[19]=t("img",{src:le,alt:""},null,-1)),t("div",Ft,[t("p",null,[v(s(e.$t("views.document.upload.uploadMessage"))+" ",1),t("em",{class:"hover",onClick:n[13]||(n[13]=M(m=>f(!1),["prevent"]))},s(e.$t("views.document.upload.selectFile")),1),t("em",{class:"hover ml-4",onClick:n[14]||(n[14]=M(m=>f(!0),["prevent"]))},s(e.$t("views.document.upload.selectFiles")),1)]),t("div",xt,[t("p",null,s(e.$t("views.document.upload.formats"))+"TXT、Markdown、PDF、DOCX、HTML、XLS、XLSX、CSV、ZIP ",1)])])]),_:1},8,["file-list"])]),_:1}))]),_:1},8,["model","rules"]),(W=a.value.fileList)!=null&&W.length?(r(),h(K,{key:0,gutter:8},{default:l(()=>[(r(!0),U(Z,null,Y(a.value.fileList,(m,F)=>(r(),h(N,{key:F,span:12,class:"mb-8"},{default:l(()=>[o(x,{shadow:"never",class:"file-List-card"},{default:l(()=>[t("div",Pt,[t("div",Ut,[t("img",{src:H(se)(m&&(m==null?void 0:m.name)),alt:"",width:"40"},null,8,zt),t("div",Et,[t("p",null,s(m&&(m==null?void 0:m.name)),1),o(X,{type:"info",size:"small"},{default:l(()=>[v(s(H(ge)(m&&(m==null?void 0:m.size))||"0K"),1)]),_:2},1024)])]),o(D,{text:"",onClick:ae=>T(F)},{default:l(()=>[o(q,null,{default:l(()=>[o(Q)]),_:1})]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})):B("",!0)],64)}}});const Mt=G(At,[["__scopeId","data-v-4c1ca5fe"]]),It={class:"create-dataset__main flex"},Bt={class:"create-dataset__component main-calc-height"},Xt={key:0,class:"upload-document p-24"},Nt={key:0,class:"create-dataset__footer text-right border-t"},Ht=j({__name:"UploadDocumentDataset",setup(z){const{dataset:R,document:S}=ne(),V=O(()=>R.documentsFiles),k=O(()=>R.documentsType),a=fe(),$=ye(),{query:{id:d}}=$,_=w(),b=w(),C=w(!1),T=w(!1),y=w(0),E=w(null);async function f(){if(T.value=!0,await b.value.validate())if(k.value==="QA"){let p=new FormData;V.value.forEach(g=>{g!=null&&g.raw&&p.append("file",g==null?void 0:g.raw)}),d&&J.postQADocument(d,p,C).then(g=>{te(P("common.submitSuccess")),e(),a.push({path:`/dataset/${d}/document`})})}else if(k.value==="table"){let p=new FormData;V.value.forEach(g=>{g!=null&&g.raw&&p.append("file",g==null?void 0:g.raw)}),d&&J.postTableDocument(d,p,C).then(g=>{te(P("common.submitSuccess")),e(),a.push({path:`/dataset/${d}/document`})})}else y.value++>2&&(y.value=0);else T.value=!1}const i=()=>{y.value=0};function e(){R.saveDocumentsFile([]),R.saveDocumentsType("")}function n(){var g;C.value=!0;const p=[];(g=_.value)==null||g.paragraphList.map(D=>{var A;(A=_.value)!=null&&A.checkedConnect||D.content.map(L=>{delete L.problem_list}),p.push({name:D.name,paragraphs:D.content})}),d&&S.asyncPostDocument(d,p).then(()=>{te(P("common.submitSuccess")),e(),a.push({path:`/dataset/${d}/document`})}).catch(()=>{C.value=!1})}function c(){var p;((p=V.value)==null?void 0:p.length)>0?re(P("common.tip"),P("views.document.tip.saveMessage"),{confirmButtonText:P("common.confirm"),type:"warning"}).then(()=>{a.go(-1),e()}).catch(()=>{}):a.go(-1)}return be(()=>{e()}),(p,g)=>{const D=u("back-button"),A=u("el-scrollbar"),L=u("el-button"),I=u("LayoutContainer"),X=me("loading");return r(),h(I,{header:p.$t("views.document.uploadDocument"),class:"create-dataset"},{backButton:l(()=>[o(D,{onClick:c})]),default:l(()=>{var Q,q,x,N;return[ve((r(),U("div",It,[t("div",Bt,[o(A,null,{default:l(()=>[y.value===0?(r(),U("div",Xt,[o(Mt,{ref_key:"UploadComponentRef",ref:b},null,512)])):y.value===1?(r(),h(ot,{key:1,ref_key:"SetRulesRef",ref:_},null,512)):y.value===2?(r(),h(vt,{key:2,data:E.value},null,8,["data"])):B("",!0)]),_:1})])])),[[X,C.value]]),y.value!==2?(r(),U("div",Nt,[o(L,{onClick:g[0]||(g[0]=K=>H(a).go(-1)),disabled:((Q=_.value)==null?void 0:Q.loading)||C.value},{default:l(()=>[v(s(p.$t("common.cancel")),1)]),_:1},8,["disabled"]),y.value===1?(r(),h(L,{key:0,onClick:i,disabled:((q=_.value)==null?void 0:q.loading)||C.value},{default:l(()=>[v(s(p.$t("views.document.buttons.prev")),1)]),_:1},8,["disabled"])):B("",!0),y.value===0?(r(),h(L,{key:1,onClick:f,type:"primary",disabled:((x=_.value)==null?void 0:x.loading)||C.value},{default:l(()=>[v(s(k.value==="txt"?p.$t("views.document.buttons.next"):p.$t("views.document.buttons.import")),1)]),_:1},8,["disabled"])):B("",!0),y.value===1?(r(),h(L,{key:2,onClick:n,type:"primary",disabled:((N=_.value)==null?void 0:N.loading)||C.value},{default:l(()=>[v(s(p.$t("views.document.buttons.import")),1)]),_:1},8,["disabled"])):B("",!0)])):B("",!0)]}),_:1},8,["header"])}}});const Ot=G(Ht,[["__scopeId","data-v-01e47550"]]);export{Ot as default};

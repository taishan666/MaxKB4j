import{cp as Ee,dz as Pe,cq as j,d1 as Me,cx as Le,cy as xe,dl as Ae,dL as Re,cY as Ie,cR as We}from"./index-6a81634c.js";const E=typeof window<"u"?window:void 0,P=typeof document<"u"?document:void 0,p=typeof navigator<"u"?navigator:void 0,M=typeof location<"u"?location:void 0;function Ne(){return(M==null?void 0:M.href)||""}const v=(p==null?void 0:p.userAgent)||"",Oe=(p==null?void 0:p.platform)||"";var Ce;(Ce=v==null?void 0:v.match(/wxwork\/([\d.]+)/i))==null||Ce[1];qe();function qe(){const e=(p==null?void 0:p.maxTouchPoints)??1,t=/Mac/i.test(Oe);return t&&e>2?{isMac:!1,isIOS:!0}:{isMac:t,isIOS:/\b(iPhone|iPad|iPod)\b/i.test(v)}}const ze={config:"preVerifyJsApi",onMenuShareTimeline:"menu:share:timeline",onMenuShareAppMessage:"menu:share:appmessage",onMenuShareWechat:"menu:share:wechat",onMenuShareQQ:"menu:share:qq",onMenuShareWeibo:"menu:share:weiboApp",onMenuShareQZone:"menu:share:QZone",previewImage:"imagePreview",getLocation:"geoLocation",openProductSpecificView:"openProductViewWithPid",addCard:"batchAddCard",openCard:"batchViewCard",chooseWXPay:"getBrandWCPayRequest",openEnterpriseRedPacket:"getRecevieBizHongBaoRequest",startSearchBeacons:"startMonitoringBeacons",stopSearchBeacons:"stopMonitoringBeacons",onSearchBeacons:"onBeaconsInRange",consumeAndShareCard:"consumedShareCard",openAddress:"editAddress",getBrandWCPayRequest:"getBrandWCPayRequest"};for(const e of Object.keys(ze));function Be(...e){console.error("[wwsdk]",...e)}Ne();function Ve(e,t,n){if(Fe(e))try{return e.call(n,t)}catch(o){Be(o)}}function Fe(e){return typeof e=="function"}let Y=!!(E!=null&&E.WeixinJSBridge);Promise.resolve();Y||new Promise(e=>{P==null||P.addEventListener("WeixinJSBridgeReady",()=>{Y=!0,e()})});function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var H,J,K,Q,G,$,U,Z,X,ee,te,ne,oe,ae,re,ie,se,ce,le,ue,de,pe,fe,me;function De(e){const t=document.createElement("iframe"),{style:n}=t;n.display="block",n.border="none",n.background="transparent",t.referrerPolicy="origin",t.setAttribute("frameborder","0"),t.setAttribute("allowtransparency","true");const o=je(e);return o&&o.appendChild(t),t}function je(e){return typeof e=="string"?document.querySelector(e):e}(function(e){e.CLProximityUnknown="0",e.CLProximityImmediate="1",e.CLProximityNear="2",e.CLProximityFar="3"})(H||(H={})),function(e){e.wgs84="wgs84",e.gcj02="gcj02"}(J||(J={})),function(e){e.wifi="wifi",e.network2g="2g",e.network3g="3g",e.network4g="4g",e.none="none",e.unknown="unknown"}(K||(K={})),function(e){e.original="original",e.compressed="compressed"}(Q||(Q={})),function(e){e.album="album",e.camera="camera"}(G||(G={})),function(e){e.normal="normal",e.batch="batch",e.front="front",e.batch_front="batch_front"}($||($={})),function(e){e[e.common=0]="common",e[e.corp_training=1]="corp_training",e[e.edu_normal_class=2]="edu_normal_class",e[e.edu_small_class=3]="edu_small_class"}(U||(U={})),function(e){e[e.normal=0]="normal",e[e.scan=1]="scan"}(Z||(Z={})),function(e){e[e.chat=0]="chat",e[e.qrcode=1]="qrcode"}(X||(X={})),function(e){e.contact_profile="contact_profile",e.single_chat_tools="single_chat_tools",e.group_chat_tools="group_chat_tools",e.chat_attachment="chat_attachment",e.single_kf_tools="single_kf_tools",e.chain_single_chat_tools="chain_single_chat_tools",e.chain_group_chat_tools="chain_group_chat_tools",e.normal="normal"}(ee||(ee={})),function(e){e.permission="permission",e.datazone_permission="datazone_permission"}(te||(te={})),function(e){e.release="release",e.trial="trial",e.develop="develop"}(ne||(ne={})),function(e){e[e.internal=1]="internal",e[e.external=2]="external"}(oe||(oe={})),function(e){e[e.mediaid=1]="mediaid",e[e.url=2]="url",e[e.localId=4]="localId"}(ae||(ae={})),function(e){e.None="None",e.HWOpenTalk="HWOpenTalk",e.VoIP="VoIP",e.SystemCall="SystemCall"}(re||(re={})),function(e){e.qrCode="qrCode",e.barCode="barCode"}(ie||(ie={})),function(e){e.single="single",e.multi="multi"}(se||(se={})),function(e){e.department="department",e.user="user"}(ce||(ce={})),function(e){e.single="single",e.multi="multi"}(le||(le={})),function(e){e.department="department",e.user="user"}(ue||(ue={})),function(e){e[e.all=0]="all",e[e.unselected=1]="unselected"}(de||(de={})),function(e){e.single="single",e.multi="multi"}(pe||(pe={})),function(e){e.create_approval="10001",e.view_approval="10002"}(fe||(fe={})),function(e){e.link="link",e.text="text"}(me||(me={}));const Ye=Ke();let He=0;function Je(){return`${Ye}-${He++}`}function Ke(){return Math.random().toString(36).slice(2)}function Qe(e){return e&&typeof e=="object"?{...e,message:e.message,stack:e.stack}:e}function he(e){try{return typeof e=="string"?JSON.parse(e):e}catch{}}function Ge(e,t){const n=new Map;return{invoke:function(o,a){return a!=null&&a.dropResult?(e({type:"ww-iframe-handle:call",args:o},a),Promise.resolve(void 0)):new Promise((l,u)=>{const s=Je();n.set(s,{resolve:l,reject:u}),e({type:"ww-iframe-handle:call",uid:s,args:o},a)})},handleCallMessage:async function(o,a){if(!o.uid)return t(o.args,a);try{e({type:"ww-iframe-handle:response",uid:o.uid,kind:"resolve",args:await t(o.args,a)})}catch(l){throw e({type:"ww-iframe-handle:response",uid:o.uid,kind:"reject",args:Qe(l)}),l}},handleResponseMessage:function(o){const a=n.get(o.uid);a&&(a[o.kind](o.args),n.delete(o.uid))}}}function $e(e,t,n){const o=[];let a=!1,l=!1;function u(i){if(i.origin!==t||e.contentWindow!==i.source)return;const r=he(i.data);typeof(r==null?void 0:r.type)=="string"&&r.type.startsWith("ww-iframe-handle:")&&D(r,i)}window.addEventListener("message",u);const s=new MessageChannel;s.port1.onmessage=i=>{D(he(i.data),i)};const{invoke:c,handleCallMessage:k,handleResponseMessage:f}=Ge(function(i,r){a?w(i,r):o.push({msg:i,opts:r})},n);function D(i,r){switch(i.type){case"ww-iframe-handle:ready":return function(y){if(!a){a=!0,y.supportChannel&&(w({type:"ww-iframe-handle:set-port",port:s.port2},{transfer:[s.port2],serialize:!1}),l=!0);for(const g of o)w(g.msg,g.opts)}}(i);case"ww-iframe-handle:call":return k(i,r);case"ww-iframe-handle:response":return void f(i)}}function w(i,r){var g;const y=(r==null?void 0:r.serialize)===!1?i:JSON.stringify(i);l?s.port1.postMessage(y,r==null?void 0:r.transfer):(g=e.contentWindow)==null||g.postMessage(y,t,r==null?void 0:r.transfer)}return e.addEventListener("load",()=>{a||w({type:"ww-iframe-handle:init"})}),{el:e,invoke:c,dispose:function(){window.removeEventListener("message",u),s.port1.onmessage=null}}}function Ue(e,t,n){Ve(t[e.name],e.payload||e.data,n)}for(var Ct={null:null,true:!0,false:!1,NaN:NaN,Infinity:1/0},Ze="await break case catch class const continue debugger default delete do else enum export extends false finally for function if import in instanceof new null return super switch this throw true try typeof var void while with yield".split(" "),Xe={},L=0,ge=Ze;L<ge.length;L++){var et=ge[L];Xe[et]=!0}var N,C,O,m;(function(e){e.serviceApp="ServiceApp",e.corpApp="CorpApp"})(N||(N={})),function(e){e.zh="zh",e.en="en"}(C||(C={})),function(e){e.top="top",e.callback="callback",e.self="self"}(O||(O={})),function(e){e.middle="middle",e.small="small"}(m||(m={}));const _e={[m.middle]:["480px","416px"],[m.small]:["320px","380px"]};function tt(e){var s;const{width:t,height:n}=nt((s=e.params)==null?void 0:s.panel_size),o=De(e.el),{style:a}=o;a.width=t,a.height=n;const{dispose:l}=$e(o,"https://login.work.weixin.qq.com",c=>{if(c.type==="call")return Ue(c,e);throw new Error(`Unknown message type '${c.type}'`)}),u=new URL("https://login.work.weixin.qq.com/wwlogin/sso/login");for(const c of Object.keys(e.params||{}))u.searchParams.set(c,e.params[c]);return u.searchParams.set("version","2.2.5"),o.src=u.href,{el:o,unmount(){var c;l(),(c=o.parentNode)==null||c.removeChild(o)}}}function nt(e=m.middle){const t=_e[e]||_e[m.middle];return{width:t[0],height:t[1]}}function Te(e){return typeof Symbol=="function"?Symbol(e):e}var we;(function(e){e[e.int32=1]="int32",e[e.float64=2]="float64",e[e.boolean=3]="boolean",e[e.null=4]="null",e[e[void 0]=5]="undefined",e[e.valueRef=6]="valueRef"})(we||(we={}));var ye,ve;(function(e){e[e.set=1]="set",e[e.call=2]="call",e[e.dispose=3]="dispose"})(ye||(ye={})),function(e){e[e.value=1]="value",e[e.ref=2]="ref"}(ve||(ve={}));const B=Te("__WECOM_REFLECT_ID__");function ot(e,t){return t.get?t.get.call(e):t.value}function Se(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function T(e,t){return ot(e,Se(e,t,"get"))}function at(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function S(e,t,n){at(e,t),t.set(e,n)}function rt(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}function b(e,t,n){return rt(e,Se(e,t,"set"),n),n}const q=new WeakMap,z=new WeakMap;function V(e,t){q.set(e,t),z.set(t,e)}function be(e){return q.has(e)?q.get(e):e}function ke(e){return z.has(e)?z.get(e):e}var x=new WeakMap,A=new WeakMap;let it=B;class st{setTransform(t){T(this,A).setTransform(t),T(this,x).call(this,"setTransform",[t])}constructor(t,n){_(this,it,void 0),S(this,x,{writable:!0,value:void 0}),S(this,A,{writable:!0,value:void 0}),b(this,x,t),b(this,A,n),t.bind(this),V(this,n)}}var R=new WeakMap,I=new WeakMap;let ct=B;class W{addColorStop(t,n){T(this,I).addColorStop(t,n),T(this,R).call(this,"addColorStop",[t,n])}constructor(t,n){_(this,ct,void 0),S(this,R,{writable:!0,value:void 0}),S(this,I,{writable:!0,value:void 0}),b(this,R,t),b(this,I,n),t.bind(this),V(this,n)}}const lt=["fillStyle","filter","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","imageSmoothingQuality","shadowBlur","shadowColor","shadowOffsetX","shadowOffsetY","strokeStyle"],ut=["direction","font","fontKerning","fontStretch","fontVariantCaps","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","textAlign","textBaseline","textRendering","wordSpacing"],dt=["arc","arcTo","beginPath","bezierCurveTo","clip","closePath","ellipse","lineTo","moveTo","quadraticCurveTo","rect","reset","resetTransform","restore","rotate","roundRect","save","scale","setLineDash","setTransform","transform","translate"],pt=["clearRect","drawFocusIfNeeded","drawImage","fill","fillRect","fillText","stroke","strokeRect","strokeText"],ft=["getContextAttributes","getLineDash","getTransform","isContextLost","isPointInPath","isPointInStroke","measureText"],mt=[["createConicGradient",W],["createLinearGradient",W],["createPattern",st],["createRadialGradient",W]],d=Te("__WECOM_INTERNAL__");let ht=d,gt=B;class _t{constructor(t,n,o){_(this,"canvas",void 0),_(this,ht,void 0),_(this,gt,void 0),this.canvas=t,this[d]={store:n,native:o,props:Object.create(null)},n.bind(this),V(this,o)}}const h=_t.prototype;for(const e of lt)Object.defineProperty(h,e,{configurable:!0,enumerable:!0,get(){const{native:t,props:n}=this[d];return n[e]??ke(t[e])},set(t){const{store:n,props:o}=this[d];o[e]=be(t),n.set(this,e,t)}});for(const e of ut)Object.defineProperty(h,e,{configurable:!0,enumerable:!0,get(){return ke(this[d].native[e])},set(t){const{store:n,native:o}=this[d];o[e]=be(t),n.set(this,e,t)}});for(const e of ft)h[e]=function(...t){const{native:n}=this[d];return F(n,e,t)};for(const e of dt)h[e]=function(...t){const{store:n,native:o}=this[d];F(o,e,t),n.call(this,e,t)};for(const e of pt)h[e]=function(...t){const{store:n}=this[d];n.call(this,e,t)};for(const[e,t]of mt)h[e]=function(...n){const{store:o,native:a}=this[d],l=F(a,e,n),u=new t(o,l);return o.call(this,e,n,u),u};function F(e,t,n){switch(n.length){case 1:return e[t](n[0]);case 2:return e[t](n[0],n[1]);case 3:return e[t](n[0],n[1],n[2]);case 4:return e[t](n[0],n[1],n[2],n[3]);case 5:return e[t](n[0],n[1],n[2],n[3],n[4]);case 6:return e[t](n[0],n[1],n[2],n[3],n[4],n[5]);default:return e[t](...n)}}const wt={id:"wecom-qr",class:"wecom-qr",style:{"margin-left":"50px"}},yt=Ee({__name:"wecomQrCode",props:{config:{}},setup(e){const t=Pe(),n=j({}),o=j({isWeComLogin:!1}),{user:a}=Me(),l=e;return(async()=>{await Ae();const s={corpId:l.config.corp_id,agentId:l.config.agent_id},c=localStorage.getItem("MaxKB-locale")||Re()||"en-US",k=window.location.origin;try{n.value=tt({el:"#wecom-qr",params:{login_type:N.corpApp,appid:s.corpId||"",agentid:s.agentId,redirect_uri:k,state:"fit2cloud-wecom-qr",lang:c==="zh-CN"||c==="zh-Hant"?C.zh:C.en,redirect_type:O.callback,panel_size:m.small},onCheckWeComLogin:o.value,async onLoginSuccess({code:f}){a.wecomCallback(f).then(()=>{setTimeout(()=>{t.push({name:"home"})})})},onLoginFail(f){Ie(`${f.errMsg}`)}})}catch(f){console.error("Error initializing login panel:",f)}})(),(s,c)=>(Le(),xe("div",wt))}});const Tt=We(yt,[["__scopeId","data-v-36176f3b"]]);export{Tt as default};

import{cp as J,dy as K,d1 as Z,cq as u,d6 as O,cZ as _,ct as P,cu as r,cU as Q,cx as d,cF as p,cA as s,cB as l,cz as o,cv as W,cy as U,cJ as m,eD as X,dw as Y,cK as b,cN as f,dv as j,cC as ee,cD as te,cH as ae,dD as se,c_ as le,em as k,dn as q,cR as oe}from"./index-27b17fb7.js";const ne={class:"dataset-setting main-calc-height"},re={class:"p-24"},de={class:"title-decoration-1 mb-16"},ce={class:"flex align-center"},ie={class:"flex align-center"},ue={key:0},pe={class:"title-decoration-1 mb-16"},me={class:"flex-between"},ve={class:"flex align-center"},_e=["src"],fe={class:"text-right"},ye=J({__name:"DatasetSetting",setup(ge){const A=K(),{params:{id:y}}=A,{dataset:M}=Z(),I=u(),g=u(),h=u(!1),i=u({}),B=u([]),w=u([]),C=u(""),n=u({sourceUrl:"",selector:""}),S=O({sourceUrl:[{required:!0,message:_("views.dataset.datasetForm.form.sourceUrl.requiredMessage"),trigger:"blur"}]});async function L(){var t;await((t=g.value)==null?void 0:t.validate())&&await I.value.validate(a=>{if(a){const c=i.value.type==="1"?{applicationIdList:w.value,meta:n.value,...g.value.form}:{applicationIdList:w.value,...g.value.form};C.value!==g.value.form.embeddingModelId?le(_("common.tip"),_("views.dataset.tip.updateModeMessage"),{confirmButtonText:_("views.dataset.setting.vectorization")}).then(()=>{k.putDataset(y,c,h).then(v=>{k.putReEmbeddingDataset(y).then(()=>{q(_("common.saveSuccess"))})})}).catch(()=>{}):k.putDataset(y,c,h).then(v=>{q(_("common.saveSuccess"))})}})}function R(){M.asyncGetDatasetDetail(y,h).then(t=>{var a,c;i.value=t.data,C.value=(a=t.data)==null?void 0:a.embeddingModelId,i.value.type==="1"&&(n.value=t.data.meta),w.value=(c=t.data)==null?void 0:c.applicationIdList,k.listUsableApplication(y,h).then(v=>{B.value=v.data})})}return P(()=>{R()}),(t,a)=>{const c=r("AppAvatar"),v=r("el-text"),$=r("el-card"),D=r("el-form-item"),V=r("el-input"),z=r("el-form"),N=r("el-col"),T=r("el-row"),x=r("el-button"),E=r("el-scrollbar"),G=r("LayoutContainer"),H=Q("loading");return d(),p(G,{header:t.$t("common.setting")},{default:s(()=>[l("div",ne,[o(E,null,{default:s(()=>[W((d(),U("div",re,[l("h4",de,m(t.$t("views.dataset.datasetForm.title.info")),1),o(X,{ref_key:"BaseFormRef",ref:g,data:i.value},null,8,["data"]),o(z,{ref_key:"webFormRef",ref:I,rules:S,model:n.value,"label-position":"top","require-asterisk-position":"right"},{default:s(()=>[o(D,{label:t.$t("views.dataset.datasetForm.form.datasetType.label"),required:""},{default:s(()=>{var e;return[i.value.type==="0"?(d(),p($,{key:0,shadow:"never",class:"mb-8",style:{width:"50%"}},{default:s(()=>[l("div",ce,[o(c,{class:"mr-8 avatar-blue",shape:"square",size:32},{default:s(()=>a[4]||(a[4]=[l("img",{src:Y,style:{width:"58%"},alt:""},null,-1)])),_:1}),l("div",null,[l("div",null,m(t.$t("views.dataset.general")),1),o(v,{type:"info"},{default:s(()=>[b(m(t.$t("views.dataset.datasetForm.form.datasetType.generalInfo")),1)]),_:1})])])]),_:1})):f("",!0),((e=i.value)==null?void 0:e.type)==="1"?(d(),p($,{key:1,shadow:"never",class:"mb-8",style:{width:"50%"}},{default:s(()=>[l("div",ie,[o(c,{class:"mr-8 avatar-purple",shape:"square",size:32},{default:s(()=>a[5]||(a[5]=[l("img",{src:j,style:{width:"58%"},alt:""},null,-1)])),_:1}),l("div",null,[l("div",null,m(t.$t("views.dataset.web")),1),o(v,{type:"info"},{default:s(()=>[b(m(t.$t("views.dataset.datasetForm.form.datasetType.webInfo")),1)]),_:1})])])]),_:1})):f("",!0)]}),_:1},8,["label"]),i.value.type==="1"?(d(),p(D,{key:0,label:t.$t("views.dataset.datasetForm.form.sourceUrl.label"),prop:"sourceUrl"},{default:s(()=>[o(V,{modelValue:n.value.sourceUrl,"onUpdate:modelValue":a[0]||(a[0]=e=>n.value.sourceUrl=e),placeholder:t.$t("views.dataset.datasetForm.form.sourceUrl.placeholder"),onBlur:a[1]||(a[1]=e=>n.value.sourceUrl=n.value.sourceUrl.trim())},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):f("",!0),i.value.type==="1"?(d(),p(D,{key:1,label:t.$t("views.dataset.datasetForm.form.selector.label")},{default:s(()=>[o(V,{modelValue:n.value.selector,"onUpdate:modelValue":a[2]||(a[2]=e=>n.value.selector=e),placeholder:t.$t("views.dataset.datasetForm.form.selector.placeholder"),onBlur:a[3]||(a[3]=e=>n.value.selector=n.value.selector.trim())},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):f("",!0)]),_:1},8,["rules","model"]),w.value.length>0?(d(),U("div",ue,[l("h4",pe,m(t.$t("views.dataset.relatedApplications")),1),o(T,{gutter:12},{default:s(()=>[(d(!0),U(ee,null,te(B.value.filter(e=>w.value.some(F=>F===(e==null?void 0:e.id))),(e,F)=>(d(),p(N,{span:12,key:F,class:"mb-16"},{default:s(()=>[o($,{shadow:"never"},{default:s(()=>[l("div",me,[l("div",ve,[ae(se)(e==null?void 0:e.icon)?(d(),p(c,{key:0,shape:"square",size:32,style:{background:"none"},class:"mr-12"},{default:s(()=>[l("img",{src:e==null?void 0:e.icon,alt:""},null,8,_e)]),_:2},1024)):e!=null&&e.name?(d(),p(c,{key:1,name:e==null?void 0:e.name,pinyinColor:"",shape:"square",size:32,class:"mr-12"},null,8,["name"])):f("",!0),b(" "+m(e.name),1)])])]),_:2},1024)]),_:2},1024))),128))]),_:1})])):f("",!0),l("div",fe,[o(x,{onClick:L,type:"primary"},{default:s(()=>[b(m(t.$t("common.save")),1)]),_:1})])])),[[H,h.value]])]),_:1})])]),_:1},8,["header"])}}});const we=oe(ye,[["__scopeId","data-v-5fb4340c"]]);export{we as default};

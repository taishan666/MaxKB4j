import{cp as re,dy as pe,cq as d,cr as A,ct as de,cu as n,cU as ue,cx as p,cy as v,cz as t,cA as a,cB as s,cK as r,cJ as i,cv as M,e8 as _e,cN as w,cF as k,cH as me,cC as ve,cD as fe,cV as $,dP as he,cw as E,el as ge,em as ye,cT as J,cZ as be,en as we,eo as Q,cQ as ke,cR as $e}from"./index-ba87ae2c.js";import{_ as Ce}from"./ParagraphDialog.vue_vue_type_script_setup_true_lang-7627761c.js";import"./ParagraphForm.vue_vue_type_script_setup_true_lang-f7da2b13.js";const Ve="/ui/assets/hit-test-empty-4afe2647.png",xe={class:"hit-test"},Te={class:"hit-test__main p-16"},De={key:0,class:"question-title clearfix"},Fe={class:"avatar"},Ae={class:"content"},Me={class:"text break-all"},Se={class:"hit-test-height"},Ne={class:"active-button primary"},ze={class:"footer-content flex-between"},Re={key:0},Be={key:0},Ie={key:1,class:"ml-4"},He={class:"hit-test__operate p-24 pt-0"},qe={class:"mb-16"},Pe={class:"title mb-8"},Ue={class:"mb-4"},Ke={class:"mb-4"},Le={class:"mb-4"},je={class:"mb-16"},Ee={class:"title mb-8"},Je={class:"mb-16"},Qe={class:"title mb-8"},Ze={class:"text-right"},Ge={class:"operate-textarea flex"},Oe={class:"operate"},We={src:ge,alt:""},Xe={src:ye,alt:""},Ye=re({__name:"index",setup(et){const Z=pe(),{meta:{activeMenu:S},params:{id:N}}=Z,z=d(),_=d(!1),f=d([]),R=d(""),u=d(""),C=d({similarity:.6,topNumber:5,searchMode:"embedding"}),V=d(!0),c=d({}),h=d(!1),g=d(""),y=A(()=>!u.value),G=A(()=>S.includes("application")),O=A(()=>S.includes("dataset"));function W(e){e==="keywords"?c.value.similarity=0:c.value.similarity=.6}function B(e){e==="open"?(h.value=!0,c.value=J.cloneDeep(C.value)):e==="close"&&(h.value=!1,C.value=J.cloneDeep(c.value))}function X(e){R.value=be("views.paragraph.paragraphDetail"),z.value.open(e)}function I(e){e.ctrlKey?u.value+=`
`:(e.preventDefault(),!y.value&&!_.value&&H())}function H(){const e={queryText:u.value,...C.value};O.value?we.getDatasetHitTest(N,e,_).then(o=>{f.value=o.data&&Q(o.data,"comprehensive_score",!0),g.value=u.value,u.value="",V.value=!1}):G.value&&ke.getApplicationHitTest(N,e,_).then(o=>{f.value=o.data&&Q(o.data,"comprehensive_score",!0),g.value=u.value,u.value="",V.value=!1})}function Y(e){if(e){const o=f.value.filter(m=>m.id===e.id)[0];o.content=e.content,o.title=e.title}else f.value=[],H()}return de(()=>{}),(e,o)=>{const m=n("el-text"),q=n("AppAvatar"),P=n("el-empty"),ee=n("Document"),te=n("el-icon"),U=n("AppIcon"),ae=n("CardBox"),x=n("el-col"),K=n("el-row"),oe=n("el-scrollbar"),le=n("LayoutContainer"),b=n("el-button"),T=n("el-radio"),D=n("el-card"),se=n("el-radio-group"),L=n("el-input-number"),ie=n("el-popover"),ne=n("el-input"),ce=ue("loading");return p(),v("div",xe,[t(le,null,{header:a(()=>[s("h4",null,[r(i(e.$t("views.application.hitTest.title"))+" ",1),t(m,{type:"info",class:"ml-4"},{default:a(()=>[r(i(e.$t("views.application.hitTest.text")),1)]),_:1})])]),default:a(()=>[M((p(),v("div",Te,[g.value?(p(),v("div",De,[s("div",Fe,[t(q,null,{default:a(()=>o[8]||(o[8]=[s("img",{src:_e,style:{width:"54%"},alt:""},null,-1)])),_:1})]),s("div",Ae,[s("h4",Me,i(g.value),1)])])):w("",!0),t(oe,null,{default:a(()=>[s("div",Se,[V.value?(p(),k(P,{key:0,image:me(Ve),description:e.$t("views.application.hitTest.emptyMessage1"),style:{"padding-top":"160px"},"image-size":125},null,8,["image","description"])):f.value.length==0?(p(),k(P,{key:1,description:e.$t("views.application.hitTest.emptyMessage2"),style:{"padding-top":"160px"},"image-size":125},null,8,["description"])):(p(),k(K,{key:2},{default:a(()=>[(p(!0),v(ve,null,fe(f.value,(l,j)=>(p(),k(x,{xs:24,sm:12,md:12,lg:8,xl:6,key:j,class:"p-8"},{default:a(()=>[t(ae,{shadow:"hover",title:l.title||"-",description:l.content,class:$(["document-card layout-bg layout-bg cursor",l.isActive?"":"disabled"]),showIcon:!1,onClick:F=>X(l)},{icon:a(()=>[t(q,{class:"mr-12 avatar-light",size:22},{default:a(()=>[r(i(j+1+""),1)]),_:2},1024)]),footer:a(()=>[s("div",ze,[t(m,null,{default:a(()=>[t(te,null,{default:a(()=>[t(ee)]),_:1}),r(" "+i(l==null?void 0:l.documentName),1)]),_:2},1024),l.trample_num||l.star_num?(p(),v("div",Re,[l.star_num?(p(),v("span",Be,[t(U,{iconName:"app-like-color"}),r(" "+i(l.star_num),1)])):w("",!0),l.trample_num?(p(),v("span",Ie,[t(U,{iconName:"app-oppose-color"}),r(" "+i(l.trample_num),1)])):w("",!0)])):w("",!0)])]),default:a(()=>{var F;return[s("div",Ne,i((F=l.similarity)==null?void 0:F.toFixed(3)),1)]}),_:2},1032,["title","description","class","onClick"])]),_:2},1024))),128))]),_:1}))])]),_:1})])),[[ce,_.value]]),t(Ce,{ref_key:"ParagraphDialogRef",ref:z,title:R.value,onRefresh:Y},null,8,["title"])]),_:1}),s("div",He,[t(ie,{visible:h.value,placement:"right-end",width:500,trigger:"click"},{reference:a(()=>[t(b,{icon:"Setting",class:"mb-8",onClick:o[0]||(o[0]=l=>B("open"))},{default:a(()=>[r(i(e.$t("common.paramSetting")),1)]),_:1})]),default:a(()=>[s("div",qe,[s("div",Pe,i(e.$t("views.application.applicationForm.dialog.selectSearchMode")),1),t(se,{modelValue:c.value.searchMode,"onUpdate:modelValue":o[1]||(o[1]=l=>c.value.searchMode=l),class:"card__radio",onChange:W},{default:a(()=>[t(D,{shadow:"never",class:$(["mb-16",c.value.searchMode==="embedding"?"active":""])},{default:a(()=>[t(T,{value:"embedding",size:"large"},{default:a(()=>[s("p",Ue,i(e.$t("views.application.applicationForm.dialog.vectorSearch")),1),t(m,{type:"info"},{default:a(()=>[r(i(e.$t("views.application.applicationForm.dialog.vectorSearchTooltip")),1)]),_:1})]),_:1})]),_:1},8,["class"]),t(D,{shadow:"never",class:$(["mb-16",c.value.searchMode==="keywords"?"active":""])},{default:a(()=>[t(T,{value:"keywords",size:"large"},{default:a(()=>[s("p",Ke,i(e.$t("views.application.applicationForm.dialog.fullTextSearch")),1),t(m,{type:"info"},{default:a(()=>[r(i(e.$t("views.application.applicationForm.dialog.fullTextSearchTooltip")),1)]),_:1})]),_:1})]),_:1},8,["class"]),t(D,{shadow:"never",class:$(["mb-16",c.value.searchMode==="blend"?"active":""])},{default:a(()=>[t(T,{value:"blend",size:"large"},{default:a(()=>[s("p",Le,i(e.$t("views.application.applicationForm.dialog.hybridSearch")),1),t(m,{type:"info"},{default:a(()=>[r(i(e.$t("views.application.applicationForm.dialog.hybridSearchTooltip")),1)]),_:1})]),_:1})]),_:1},8,["class"])]),_:1},8,["modelValue"])]),t(K,{gutter:20},{default:a(()=>[t(x,{span:12},{default:a(()=>[s("div",je,[s("div",Ee,i(e.$t("views.application.applicationForm.dialog.similarityThreshold")),1),t(L,{modelValue:c.value.similarity,"onUpdate:modelValue":o[2]||(o[2]=l=>c.value.similarity=l),min:0,max:c.value.searchMode==="blend"?2:1,precision:3,step:.1,"value-on-clear":0,"controls-position":"right",class:"w-full"},null,8,["modelValue","max"])])]),_:1}),t(x,{span:12},{default:a(()=>[s("div",Je,[s("div",Qe,i(e.$t("views.application.applicationForm.dialog.topReferences")),1),t(L,{modelValue:c.value.topNumber,"onUpdate:modelValue":o[3]||(o[3]=l=>c.value.topNumber=l),min:1,max:1e4,"controls-position":"right",class:"w-full"},null,8,["modelValue"])])]),_:1})]),_:1}),s("div",Ze,[t(b,{onClick:o[4]||(o[4]=l=>h.value=!1)},{default:a(()=>[r(i(e.$t("common.cancel")),1)]),_:1}),t(b,{type:"primary",onClick:o[5]||(o[5]=l=>B("close"))},{default:a(()=>[r(i(e.$t("common.confirm")),1)]),_:1})])]),_:1},8,["visible"]),s("div",Ge,[t(ne,{ref:"quickInputRef",modelValue:u.value,"onUpdate:modelValue":o[6]||(o[6]=l=>u.value=l),type:"textarea",placeholder:e.$t("common.inputPlaceholder"),autosize:{minRows:1,maxRows:8},onKeydown:o[7]||(o[7]=he(l=>I(l),["enter"]))},null,8,["modelValue","placeholder"]),s("div",Oe,[t(b,{text:"",class:"sent-button",disabled:y.value||_.value,onClick:I},{default:a(()=>[M(s("img",We,null,512),[[E,y.value||_.value]]),M(s("img",Xe,null,512),[[E,!y.value&&!_.value]])]),_:1},8,["disabled"])])])])])}}});const lt=$e(Ye,[["__scopeId","data-v-b06ebee3"]]);export{lt as default};

import{cp as O,dy as Z,d1 as j,cq as i,d6 as x,cZ as f,di as W,cu as n,cx as A,cF as C,cA as t,cB as r,cz as a,cE as X,cK as _,cJ as u,cH as Y,cN as ee,ep as oe,dn as N,ex as te,en as ae,cT as le}from"./index-2f436c9e.js";const se={class:"content-height"},ne={class:"update-info flex border-r-4 mb-16 p-8-12"},ie={class:"mt-4"},re={class:"ml-12 lighter"},pe={class:"dialog-footer"},ce=O({__name:"index",emits:["refresh"],setup(de,{expose:B,emit:R}){var k;const S=Z(),{params:{id:g,documentId:z}}=S,{model:U,prompt:h,user:$}=j(),y=R,c=i(!1),p=i(!1),M=i(null),b=i([]),m=i(""),w=i("error"),P={all:["0","1","2","3","4","5","n"],error:["0","1","3","4","5","n"]},V=i(),I=(k=$.userInfo)==null?void 0:k.id,l=i(h.get(I)),T=x({modelId:[{required:!0,message:f("views.application.applicationForm.form.aiModel.placeholder"),trigger:"blur"}],prompt:[{required:!0,message:f("views.application.applicationForm.form.prompt.placeholder"),trigger:"blur"}]});W(p,e=>{var o;e||(l.value=h.get(I),(o=V.value)==null||o.clearValidate())});const D=(e,o)=>{H(),b.value=e,m.value=o,p.value=!0},G=async e=>{e&&await e.validate((o,F)=>{var v;if(o){if(h.save((v=$.userInfo)==null?void 0:v.id,l.value),m.value==="paragraph"){const d={...l.value,paragraph_id_list:b.value};oe.batchGenerateRelated(g,z,d,c).then(()=>{N(f("views.document.generateQuestion.successMessage")),y("refresh"),p.value=!1})}else if(m.value==="document"){const d={...l.value,documentIdList:b.value,state_list:P[w.value]};te.batchGenerateRelated(g,d,c).then(()=>{N(f("views.document.generateQuestion.successMessage")),y("refresh"),p.value=!1})}}})};function H(){c.value=!0,ae.getDatasetModel(g).then(e=>{M.value=le.groupBy(e==null?void 0:e.data,"provider"),c.value=!1}).catch(()=>{c.value=!1})}return B({open:D}),(e,o)=>{const F=n("AppIcon"),v=n("ModelSelect"),d=n("el-form-item"),L=n("el-input"),Q=n("el-radio"),E=n("el-radio-group"),J=n("el-form"),q=n("el-button"),K=n("el-dialog");return A(),C(K,{title:e.$t("views.document.generateQuestion.title"),modelValue:p.value,"onUpdate:modelValue":o[5]||(o[5]=s=>p.value=s),width:"650","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:t(()=>[r("span",pe,[a(q,{onClick:o[3]||(o[3]=X(s=>p.value=!1,["prevent"]))},{default:t(()=>[_(u(e.$t("common.cancel")),1)]),_:1}),a(q,{type:"primary",onClick:o[4]||(o[4]=s=>G(V.value)),disabled:!Y(U)||c.value},{default:t(()=>[_(u(e.$t("common.confirm")),1)]),_:1},8,["disabled"])])]),default:t(()=>[r("div",se,[a(J,{ref_key:"FormRef",ref:V,model:l.value,rules:T,"label-position":"top","require-asterisk-position":"right"},{default:t(()=>[r("div",ne,[r("div",ie,[a(F,{iconName:"app-warning-colorful",style:{"font-size":"16px"}})]),r("div",re,[r("p",null,u(e.$t("views.document.generateQuestion.tip1",{data:"{data}"})),1),r("p",null,u(e.$t("views.document.generateQuestion.tip2")+"<question></question>"+e.$t("views.document.generateQuestion.tip3")),1),r("p",null,u(e.$t("views.document.generateQuestion.tip4")),1)])]),a(d,{label:e.$t("views.application.applicationForm.form.aiModel.label"),prop:"modelId"},{default:t(()=>[a(v,{modelValue:l.value.modelId,"onUpdate:modelValue":o[0]||(o[0]=s=>l.value.modelId=s),placeholder:e.$t("views.application.applicationForm.form.aiModel.placeholder"),options:M.value},null,8,["modelValue","placeholder","options"])]),_:1},8,["label"]),a(d,{label:e.$t("views.application.applicationForm.form.prompt.label"),prop:"prompt"},{default:t(()=>[a(L,{modelValue:l.value.prompt,"onUpdate:modelValue":o[1]||(o[1]=s=>l.value.prompt=s),placeholder:e.$t("views.application.applicationForm.form.prompt.placeholder"),rows:7,type:"textarea"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),m.value==="document"?(A(),C(d,{key:0,label:e.$t("components.selectParagraph.title"),prop:"state"},{default:t(()=>[a(E,{modelValue:w.value,"onUpdate:modelValue":o[2]||(o[2]=s=>w.value=s),class:"radio-block"},{default:t(()=>[a(Q,{value:"error",size:"large"},{default:t(()=>[_(u(e.$t("components.selectParagraph.error")),1)]),_:1}),a(Q,{value:"all",size:"large"},{default:t(()=>[_(u(e.$t("components.selectParagraph.all")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"])):ee("",!0)]),_:1},8,["model","rules"])])]),_:1},8,["title","modelValue"])}}});export{ce as _};

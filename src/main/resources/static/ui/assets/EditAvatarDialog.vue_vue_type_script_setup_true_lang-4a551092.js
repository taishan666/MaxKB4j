import{cp as q,d1 as F,dy as M,cq as c,di as j,cu as u,cx as g,cF as w,cA as a,cB as l,cz as i,cE as x,cK as A,cJ as p,cN as V,dD as y,cT as P,cY as k,cZ as v,eg as J,dn as C,e4 as K}from"./index-27b17fb7.js";const Y={class:"mt-8"},Z={class:"flex mt-8"},G=["src"],H={class:"el-upload__tip info mt-16"},Q={class:"dialog-footer"},ee=q({__name:"EditAvatarDialog",emits:["refresh"],setup(W,{expose:O,emit:$}){const{application:z}=F(),U=M(),{params:{id:h}}=U,D=$,r=c(null),d=c(null),t=c(!1),m=c(!1),f=c(null),n=c("default");j(t,e=>{e||(r.value=null,d.value=null)});const S=e=>{n.value=y(e.icon)?"custom":"default",d.value=y(e.icon)?e.icon:null,f.value=P.cloneDeep(e),t.value=!0},L=e=>{if((e==null?void 0:e.size)/1024/1024<10)r.value=e,d.value=URL.createObjectURL(e.raw);else return k(v("views.applicationOverview.appInfo.EditAvatarDialog.fileSizeExceeded")),!1};function N(){if(n.value==="default")z.asyncPutApplication(h,{icon:J},m).then(e=>{D("refresh"),C(v("common.saveSuccess")),t.value=!1});else if(n.value==="custom"&&r.value){let e=new FormData;e.append("file",r.value.raw),K.putAppIcon(h,e,m).then(o=>{D("refresh"),C(v("common.saveSuccess")),t.value=!1})}else k(v("views.applicationOverview.appInfo.EditAvatarDialog.uploadImagePrompt"))}return O({open:S}),(e,o)=>{const E=u("AppAvatar"),b=u("el-radio"),_=u("el-button"),R=u("el-upload"),B=u("el-radio-group"),T=u("el-dialog");return g(),w(T,{title:e.$t("views.applicationOverview.appInfo.EditAvatarDialog.title"),modelValue:t.value,"onUpdate:modelValue":o[2]||(o[2]=s=>t.value=s),"close-on-click-modal":!1,"close-on-press-escape":!1},{footer:a(()=>[l("span",Q,[i(_,{onClick:o[1]||(o[1]=x(s=>t.value=!1,["prevent"]))},{default:a(()=>[A(p(e.$t("common.cancel")),1)]),_:1}),i(_,{type:"primary",onClick:N,loading:m.value},{default:a(()=>[A(p(e.$t("common.save")),1)]),_:1},8,["loading"])])]),default:a(()=>[i(B,{modelValue:n.value,"onUpdate:modelValue":o[0]||(o[0]=s=>n.value=s),class:"radio-block mb-16"},{default:a(()=>[l("div",null,[i(b,{value:"default"},{default:a(()=>{var s,I;return[l("p",null,p(e.$t("views.applicationOverview.appInfo.EditAvatarDialog.default")),1),(s=f.value)!=null&&s.name?(g(),w(E,{key:0,name:(I=f.value)==null?void 0:I.name,pinyinColor:"",class:"mt-8 mb-8",shape:"square",size:32},null,8,["name"])):V("",!0)]}),_:1})]),l("div",Y,[i(b,{value:"custom"},{default:a(()=>[l("p",null,p(e.$t("views.applicationOverview.appInfo.EditAvatarDialog.customizeUpload")),1),l("div",Z,[d.value?(g(),w(E,{key:0,shape:"square",size:32,style:{background:"none"},class:"mr-16"},{default:a(()=>[l("img",{src:d.value,alt:""},null,8,G)]),_:1})):V("",!0),i(R,{ref:"uploadRef",action:"#","auto-upload":!1,"show-file-list":!1,accept:"image/jpeg, image/png, image/gif","on-change":L},{default:a(()=>[i(_,{icon:"Upload",disabled:n.value!=="custom"},{default:a(()=>[A(p(e.$t("views.applicationOverview.appInfo.EditAvatarDialog.upload")),1)]),_:1},8,["disabled"])]),_:1},512)]),l("div",H,p(e.$t("views.applicationOverview.appInfo.EditAvatarDialog.sizeTip")),1)]),_:1})])]),_:1},8,["modelValue"])]),_:1},8,["title","modelValue"])}}});export{ee as _};

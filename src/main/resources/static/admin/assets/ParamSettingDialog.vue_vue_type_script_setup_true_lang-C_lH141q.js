import{ay as oe,aP as te,aQ as J,aB as m,aC as F,aD as u,b3 as me,aE as k,aF as b,aG as l,b4 as G,bF as ie,aH as t,aI as i,aJ as c,aT as S,aY as K,aZ as ee,aU as ue,aK as M,cY as H,aW as D,b5 as se,co as pe,b8 as ce,cZ as fe,a_ as le,c_ as ve,ca as ae}from"./admin-C9Qix2xa.js";const _e={class:"active-breadcrumb"},be={class:"flex align-center",style:{display:"inline-flex"}},ye={class:"mr-4"},ge={class:"flex align-center",style:{display:"inline-flex"}},he={class:"mr-4"},we={class:"color-danger ml-4",style:{color:"red"}},$e={class:"flex align-center",style:{display:"inline-flex"}},ke={class:"flex-between mr-4"},Fe={class:"dialog-footer"},Ve=oe({__name:"EditModel",emits:["change","submit"],setup(ne,{expose:E,emit:U}){const N=te(),g=J(()=>N.path.includes("shared")?"systemShare":N.path.includes("resource-management")?"systemManage":"workspace"),y=m(),f=m(),I=U,V=m(!1),B=m(!1),$=m(!1),C=m(!1),R=m([]),h=m(),q=m([]),o=m([]),n=m(!1),r=m({name:{required:!0,trigger:"blur",message:F("views.model.modelForm.modelName.requiredMessage")},modelType:{required:!0,trigger:"change",message:F("views.model.modelForm.modelType.requiredMessage")},modelName:{required:!0,trigger:"change",message:F("views.model.modelForm.base_model.requiredMessage")}}),d=m({name:"",modelType:"",modelName:""}),v=m({}),_=J({get:()=>({...v.value,...d.value}),set:a=>{v.value=a}}),P=a=>{y.value&&H.getModelCreateForm(y.value.provider,_.value.modelType,a).then(e=>{var w;o.value=e.data,h.value&&((w=f.value)==null||w.render(o.value,h.value.credential))})},A=(a,e)=>{e&&(d.value.modelName=""),y.value&&H.listBaseModel(y.value.provider,a,C).then(w=>{q.value=w.data})},L=(a,e)=>{h.value=e,D({type:"model",systemType:g.value}).getModelById(e.id,B).then(w=>{h.value=w.data,H.listModelType(e.provider,$).then(Y=>{R.value=Y.data,A(e.modelType)}),y.value=a,d.value={name:e.name,modelType:e.modelType,modelName:e.modelName},_.value=e.credential,P(e.modelName)}),n.value=!0},T=()=>{var a,e;d.value={name:"",modelType:"",modelName:""},(e=(a=f.value)==null?void 0:a.ruleFormRef)==null||e.resetFields(),v.value={},o.value=[],q.value=[],n.value=!1},p=()=>{var a;(a=f.value)==null||a.validate().then(()=>{h.value&&D({type:"model",systemType:g.value}).updateModel(h.value.id,{...d.value,credential:v.value},V).then(e=>{se(F("views.model.tip.updateSuccessMessage")),T(),I("submit")})})};return E({open:L,close:T}),(a,e)=>{const w=u("el-breadcrumb-item"),Y=u("el-breadcrumb"),Q=u("AppIcon"),W=u("el-tooltip"),de=u("el-input"),Z=u("el-form-item"),j=u("el-option"),O=u("el-select"),X=u("el-button"),re=u("el-dialog"),z=me("loading");return b(),k(re,{modelValue:n.value,"onUpdate:modelValue":e[6]||(e[6]=s=>n.value=s),width:"600px","close-on-click-modal":!1,"close-on-press-escape":!1,"destroy-on-close":!0,"before-close":T},{header:l(({close:s,titleId:qe,titleClass:Pe})=>[t(Y,{separator:">"},{default:l(()=>[t(w,null,{default:l(()=>{var x;return[i("span",_e,c(`${a.$t("common.edit")} ${(x=y.value)==null?void 0:x.name}`),1)]}),_:1})]),_:1})]),footer:l(()=>[i("span",Fe,[t(X,{onClick:T},{default:l(()=>[M(c(a.$t("common.cancel")),1)]),_:1}),t(X,{type:"primary",onClick:p,loading:V.value},{default:l(()=>[M(c(a.$t("common.modify")),1)]),_:1},8,["loading"])])]),default:l(()=>[G((b(),k(ie,{modelValue:_.value,"onUpdate:modelValue":e[5]||(e[5]=s=>_.value=s),render_data:o.value,model:_.value,ref_key:"dynamicsFormRef",ref:f,"label-position":"top","require-asterisk-position":"right"},{default:l(()=>[t(Z,{prop:"name",rules:r.value.name},{label:l(()=>[i("div",be,[i("div",ye,[i("span",null,c(a.$t("views.model.modelForm.modelName.label")),1)]),t(W,{effect:"dark",placement:"right"},{content:l(()=>[i("p",null,c(a.$t("views.model.modelForm.modelName.tooltip")),1)]),default:l(()=>[t(Q,{iconName:"app-warning",class:"app-warning-icon"})]),_:1})])]),default:l(()=>[t(de,{modelValue:d.value.name,"onUpdate:modelValue":e[0]||(e[0]=s=>d.value.name=s),maxlength:"64","show-word-limit":"",placeholder:a.$t("views.model.modelForm.modelName.placeholder")},null,8,["modelValue","placeholder"])]),_:1},8,["rules"]),t(Z,{prop:"modelType",rules:r.value.modelType},{label:l(()=>[i("span",null,c(a.$t("views.model.modelForm.modelType.label")),1)]),default:l(()=>[G((b(),k(O,{disabled:"",onChange:e[1]||(e[1]=s=>A(s,!0)),modelValue:d.value.modelType,"onUpdate:modelValue":e[2]||(e[2]=s=>d.value.modelType=s),class:"w-full m-2",placeholder:a.$t("views.model.modelForm.modelType.placeholder")},{default:l(()=>[(b(!0),S(K,null,ee(R.value,s=>(b(),k(j,{key:s.value,label:s.key,value:s.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])),[[z,$.value]])]),_:1},8,["rules"]),t(Z,{prop:"modelName",rules:r.value.modelName},{label:l(()=>[i("div",ge,[i("div",he,[i("span",null,c(a.$t("views.model.modelForm.base_model.label")),1),i("span",we,c(a.$t("views.model.modelForm.base_model.tooltip")),1)])])]),default:l(()=>[G((b(),k(O,{onChange:e[3]||(e[3]=s=>P(s)),modelValue:d.value.modelName,"onUpdate:modelValue":e[4]||(e[4]=s=>d.value.modelName=s),class:"w-full m-2",placeholder:a.$t("views.model.modelForm.base_model.requiredMessage"),filterable:"","allow-create":"","default-first-option":""},{default:l(()=>[(b(!0),S(K,null,ee(q.value,s=>(b(),k(j,{key:s.name,value:s.name},{default:l(()=>[i("div",$e,[i("div",ke,[i("span",null,c(s.name),1)]),s.desc?(b(),k(W,{key:0,effect:"dark",placement:"right"},{content:l(()=>[i("p",null,c(s.desc),1)]),default:l(()=>[t(Q,{iconName:"app-warning",class:"app-warning-icon"})]),_:2},1024)):ue("",!0)])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","placeholder"])),[[z,C.value]])]),_:1},8,["rules"])]),_:1},8,["modelValue","render_data","model"])),[[z,B.value]])]),_:1},8,["modelValue"])}}}),Se=pe(Ve,[["__scopeId","data-v-228e9acd"]]),Te={key:0},Me={key:1},Ne={class:"mr-4"},Ce={class:"dialog-footer"},Ue=oe({__name:"ParamSettingDialog",setup(ne,{expose:E}){const U=te(),N=J(()=>U.path.includes("shared")?"systemShare":U.path.includes("resource-management")?"systemManage":"workspace"),g=m(!1),y=m(!1),f=m([]),I=m(),V=m(null),B=o=>{V.value=o,y.value=!0,g.value=!0,D({type:"model",systemType:N.value}).getModelParamsForm(o.id,g).then(n=>{g.value=!1,f.value=n.data}).catch(()=>{g.value=!1})},$=()=>{y.value=!1};function C(o,n){var r;(r=I.value)==null||r.open(o,n)}function R(o){f.value.splice(o,1)}function h(o,n){for(let r=0;r<f.value.length;r++){const d=f.value[r].field;let v=f.value[r].label;v&&v.input_type==="TooltipLabel"&&(v=v.label);let _=o.label;if(_&&_.input_type==="TooltipLabel"&&(_=_.label),d===o.field&&n!==r){ae(F("views.model.tip.errorMessage")+o.field);return}if(v===_&&n!==r){ae(F("views.model.tip.errorMessage")+v);return}}n!==null?f.value.splice(n,1,o):f.value.push(o)}function q(){V.value&&D({type:"model",systemType:N.value}).updateModelParamsForm(V.value.id,f.value,g).then(o=>{se(F("views.model.tip.saveSuccessMessage")),$()})}return E({open:B,close:$}),(o,n)=>{const r=u("el-button"),d=u("el-table-column"),v=u("el-tag"),_=u("el-switch"),P=u("AppIcon"),A=u("el-tooltip"),L=u("el-table"),T=u("el-dialog");return b(),S(K,null,[t(T,{title:o.$t("views.model.modelForm.title.paramSetting"),modelValue:y.value,"onUpdate:modelValue":n[2]||(n[2]=p=>y.value=p),width:"800px","close-on-click-modal":!1,"close-on-press-escape":!1,"destroy-on-close":!0,"before-close":$},{footer:l(()=>[i("span",Ce,[t(r,{onClick:$},{default:l(()=>[M(c(o.$t("common.cancel")),1)]),_:1}),t(r,{type:"primary",onClick:q,loading:g.value},{default:l(()=>[M(c(o.$t("common.save")),1)]),_:1},8,["loading"])])]),default:l(()=>[t(r,{type:"primary",onClick:n[0]||(n[0]=p=>C()),class:"mb-12"},{default:l(()=>[M(c(o.$t("common.param.addParam")),1)]),_:1}),t(L,{data:f.value,class:"mb-16"},{default:l(()=>[t(d,{prop:"label",label:o.$t("dynamicsForm.paramForm.name.label"),"show-overflow-tooltip":""},{default:l(({row:p})=>[p.label&&p.label.input_type==="TooltipLabel"?(b(),S("span",Te,c(p.label.label),1)):(b(),S("span",Me,c(p.label),1))]),_:1},8,["label"]),t(d,{prop:"field",label:o.$t("dynamicsForm.paramForm.field.label"),"show-overflow-tooltip":""},null,8,["label"]),t(d,{label:o.$t("dynamicsForm.paramForm.input_type.label"),width:"110px"},{default:l(({row:p})=>[t(v,{type:"info",class:"info-tag"},{default:l(()=>{var a;return[M(c((a=ce(fe).find(e=>e.value===p.input_type))==null?void 0:a.label),1)]}),_:2},1024)]),_:1},8,["label"]),t(d,{prop:"default_value",label:o.$t("dynamicsForm.default.label"),"show-overflow-tooltip":""},null,8,["label"]),t(d,{label:o.$t("common.required")},{default:l(({row:p})=>[i("div",{onClick:n[1]||(n[1]=le(()=>{},["stop"]))},[t(_,{disabled:"",size:"small",modelValue:p.required,"onUpdate:modelValue":a=>p.required=a},null,8,["modelValue","onUpdate:modelValue"])])]),_:1},8,["label"]),t(d,{label:o.$t("common.operation"),align:"left",width:"90"},{default:l(({row:p,$index:a})=>[i("span",Ne,[t(A,{effect:"dark",content:o.$t("common.modify"),placement:"top"},{default:l(()=>[t(r,{type:"primary",text:"",onClick:le(e=>C(p,a),["stop"])},{default:l(()=>[t(P,{iconName:"app-edit"})]),_:2},1032,["onClick"])]),_:2},1032,["content"])]),t(A,{effect:"dark",content:o.$t("common.delete"),placement:"top"},{default:l(()=>[t(r,{type:"primary",text:"",onClick:e=>R(a)},{default:l(()=>[t(P,{iconName:"app-delete"})]),_:2},1032,["onClick"])]),_:2},1032,["content"])]),_:1},8,["label"])]),_:1},8,["data"])]),_:1},8,["title","modelValue"]),t(ve,{ref_key:"AddParamRef",ref:I,onRefresh:h},null,512)],64)}}});export{Se as E,Ue as _};

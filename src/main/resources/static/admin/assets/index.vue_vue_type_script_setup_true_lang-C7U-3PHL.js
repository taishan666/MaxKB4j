import{ay as Y,aZ as x,aA as ee,aB as r,aP as ae,aC as y,aQ as te,aD as i,aE as N,aF as U,aG as t,aI as u,aH as o,b1 as oe,aJ as c,aK as b,aU as A,b6 as le,b2 as V,b3 as T,aV as se}from"./admin-BOU8h_tu.js";const ne={class:"content-height"},re={class:"update-info flex border-r-6 mb-16 p-8-12"},ie={class:"mt-4"},pe={class:"ml-12 lighter"},ue={class:"dialog-footer"},me=Y({__name:"index",props:{apiType:{}},emits:["refresh"],setup(G,{expose:P,emit:z}){var R;const f=G,D=x(),{params:{id:w,documentId:H}}=D,{model:K,prompt:M,user:L}=ee(),Q=z,d=r(!1),s=r(!1),C=r(null),$=r([]),g=r(""),h=r("error"),S={all:["0","1","2","3","4","5","n"],error:["0","1","3","4","5","n"]},k=r(),I=r(null),B=(R=L.userInfo)==null?void 0:R.id,l=r(M.get(B)),j=ae({modelId:[{required:!0,message:y("views.application.form.aiModel.placeholder"),trigger:"blur"}],prompt:[{required:!0,message:y("views.application.form.prompt.placeholder"),trigger:"blur"}]});te(s,a=>{var e;a||(l.value=M.get(B),(e=k.value)==null||e.clearValidate())});const E=(a,e,p)=>{I.value=p,O(),$.value=a,g.value=e,s.value=!0},J=async a=>{a&&await a.validate((e,p)=>{var _,v;if(e){if(M.save((_=L.userInfo)==null?void 0:_.id,l.value),g.value==="paragraph"){const m={...l.value,paragraphIdList:$.value};V({type:"paragraph",systemType:f.apiType}).putBatchGenerateRelated(w,H,m,d).then(()=>{T(y("views.document.generateQuestion.successMessage")),Q("refresh"),s.value=!1})}else if(g.value==="document"){const m={...l.value,documentIdList:$.value,stateList:S[h.value]};V({type:"document",systemType:f.apiType}).putBatchGenerateRelated(w,m,d).then(()=>{T(y("views.document.generateQuestion.successMessage")),Q("refresh"),s.value=!1})}else if(g.value==="knowledge"){const m={...l.value,stateList:S[h.value]};V({type:"knowledge",systemType:f.apiType}).putGenerateRelated(w||((v=I.value)==null?void 0:v.id),m,d).then(()=>{T(y("views.document.generateQuestion.successMessage")),s.value=!1})}}})};function O(){var e;d.value=!0;const a=f.apiType==="systemManage"?{modelType:"LLM",workspaceId:(e=I.value)==null?void 0:e.workspaceId}:{modelType:"LLM"};V({type:"model",systemType:f.apiType}).getSelectModelList(a).then(p=>{C.value=se.groupBy(p==null?void 0:p.data,"provider"),d.value=!1}).catch(()=>{d.value=!1})}return P({open:E,dialogVisible:s}),(a,e)=>{const p=i("AppIcon"),_=i("ModelSelect"),v=i("el-form-item"),m=i("el-input"),q=i("el-radio"),Z=i("el-radio-group"),W=i("el-form"),F=i("el-button"),X=i("el-dialog");return U(),N(X,{title:a.$t("views.document.generateQuestion.title"),modelValue:s.value,"onUpdate:modelValue":e[5]||(e[5]=n=>s.value=n),width:"650","close-on-click-modal":!1,"close-on-press-escape":!1,onClick:e[6]||(e[6]=A(()=>{},["stop"]))},{footer:t(()=>[u("span",ue,[o(F,{onClick:e[3]||(e[3]=A(n=>s.value=!1,["prevent"]))},{default:t(()=>[b(c(a.$t("common.cancel")),1)]),_:1}),o(F,{type:"primary",onClick:e[4]||(e[4]=n=>J(k.value)),disabled:!le(K)||d.value},{default:t(()=>[b(c(a.$t("common.confirm")),1)]),_:1},8,["disabled"])])]),default:t(()=>[u("div",ne,[o(W,{ref_key:"FormRef",ref:k,model:l.value,rules:j,"label-position":"top","require-asterisk-position":"right"},{default:t(()=>[u("div",re,[u("div",ie,[o(p,{iconName:"app-warning-colorful",style:{"font-size":"16px"}})]),u("div",pe,[u("p",null,c(a.$t("views.document.generateQuestion.tip1",{data:"{data}"})),1),u("p",null,c(a.$t("views.document.generateQuestion.tip2")+"<question></question>"+a.$t("views.document.generateQuestion.tip3")),1),u("p",null,c(a.$t("views.document.generateQuestion.tip4")),1)])]),o(v,{label:a.$t("views.application.form.aiModel.label"),prop:"modelId"},{default:t(()=>[o(_,{modelValue:l.value.modelId,"onUpdate:modelValue":e[0]||(e[0]=n=>l.value.modelId=n),placeholder:a.$t("views.application.form.aiModel.placeholder"),options:C.value,showFooter:"","model-type":"LLM"},null,8,["modelValue","placeholder","options"])]),_:1},8,["label"]),o(v,{label:a.$t("views.application.form.prompt.label"),prop:"prompt"},{default:t(()=>[o(m,{modelValue:l.value.prompt,"onUpdate:modelValue":e[1]||(e[1]=n=>l.value.prompt=n),placeholder:a.$t("views.application.form.prompt.placeholder"),rows:7,type:"textarea"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),["document","knowledge"].includes(g.value)?(U(),N(v,{key:0,label:a.$t("components.selectParagraph.title"),prop:"state"},{default:t(()=>[o(Z,{modelValue:h.value,"onUpdate:modelValue":e[2]||(e[2]=n=>h.value=n),class:"radio-block"},{default:t(()=>[o(q,{value:"error",size:"large"},{default:t(()=>[b(c(a.$t("components.selectParagraph.error")),1)]),_:1}),o(q,{value:"all",size:"large"},{default:t(()=>[b(c(a.$t("components.selectParagraph.all")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"])):oe("",!0)]),_:1},8,["model","rules"])])]),_:1},8,["title","modelValue"])}}});export{me as _};

import{ee as ge,ef as he,aJ as B,aQ as oe,aR as ee,cE as S,cF as _e,d4 as N,aS as c,d0 as le,aT as g,aM as r,aW as q,cI as o,cU as ie,aN as n,aL as V,aU as C,aO as l,cN as E,aV as e,eg as ce,aX as t,eh as be,aP as me,d2 as re,cO as te,dI as Ae,d5 as ke,dx as ue,aK as fe,cT as we,cG as Q,d$ as de,dL as G,dM as X,dN as y,dP as H,dO as j,cH as Ie,ei as $e,cP as ne,dc as Z,ej as Ce,ek as Ee,el as Re,cX as Ne}from"./admin-DFhI7UQw.js";import{_ as Se}from"./ResetPassword.vue_vue_type_script_setup_true_lang-Cbrz8AzK.js";import{_ as Pe,s as Y}from"./SettingAPIKeyDialog.vue_vue_type_script_setup_true_lang-BExrTQ72.js";const ve="/license",xe=M=>he(`${ve}/profile`,void 0,M),De=(M,s)=>ge(`${ve}/profile`,M,void 0,s),pe={getLicense:xe,putLicense:De},Ke=["id"],Oe={class:"about-ui"},Me={class:"flex"},Te={class:"label"},Ue={class:"flex"},Le={class:"label"},Ve={key:0,class:"color-danger"},We={class:"flex"},Ge={class:"label"},ze={class:"flex"},Be={class:"label"},Fe={class:"flex"},Xe={class:"label"},He={class:"flex"},je={class:"label"},Ye={key:0,class:"mt-16 flex align-center"},qe={class:"border-t text-center mt-16 p-16 pb-0"},Je=B({__name:"AboutDialog",setup(M,{expose:s}){const{user:p,theme:d}=oe(),b=ee(()=>d.isDefaultTheme()),f=S(!1),h=S(!1),_=S(null),w=S(!1);_e(f,v=>{v||(w.value&&window.location.reload(),w.value=!1)});const P=()=>{p.showXpack()&&z(),f.value=!0},I=v=>{const a=new FormData;a.append("license_file",v.raw),pe.putLicense(a,h).then(u=>{z(),w.value=!0})},F=ee(()=>p?p.getEditionName()==="PE"?N("layout.about.edition.professional"):p.getEditionName()==="EE"?N("layout.about.edition.enterprise"):N("layout.about.edition.community"):"-");function z(){pe.getLicense(h).then(v=>{var a;_.value=(a=v.data)==null?void 0:a.license})}return s({open:P}),(v,a)=>{const u=c("LogoFull"),T=c("el-button"),i=c("el-upload"),A=c("el-text"),U=c("el-dialog"),k=le("hasPermission"),x=le("loading");return r(),g(U,{modelValue:f.value,"onUpdate:modelValue":a[0]||(a[0]=D=>f.value=D),class:q(["about-dialog border-r-6",b.value?"":"dialog-custom-header"])},{header:o(({titleId:D,titleClass:R})=>[n("div",{class:q(["logo flex-center",R]),id:D},[t(u,{height:"59px"})],10,Ke)]),default:o(()=>{var D,R,W,L,K,O,m;return[ie((r(),V("div",Oe,[n("div",Me,[n("span",Te,l(v.$t("layout.about.authorize")),1),n("span",null,l(((D=_.value)==null?void 0:D.corporation)||"-"),1)]),n("div",Ue,[n("span",Le,l(v.$t("layout.about.expiredTime")),1),n("span",null,[E(l(((R=_.value)==null?void 0:R.expired)||"-")+" ",1),(W=_.value)!=null&&W.expired&&e(ce)((L=_.value)==null?void 0:L.expired)?(r(),V("span",Ve,"（"+l(e(ce)((K=_.value)==null?void 0:K.expired))+"）",1)):C("",!0)])]),n("div",We,[n("span",Ge,l(v.$t("layout.about.edition.label")),1),n("span",null,l(F.value),1)]),n("div",ze,[n("span",Be,l(v.$t("layout.about.version")),1),n("span",null,l(e(p).version),1)]),n("div",Fe,[n("span",Xe,l(v.$t("layout.about.serialNo")),1),n("span",null,l(((O=_.value)==null?void 0:O.serialNo)||"-"),1)]),n("div",He,[n("span",je,l(v.$t("layout.about.remark")),1),n("span",null,l(((m=_.value)==null?void 0:m.remark)||"-"),1)]),e(p).showXpack()?(r(),V("div",Ye,[ie((r(),g(i,{ref:"uploadRef",action:"#","auto-upload":!1,"show-file-list":!1,"on-change":I},{default:o(()=>[t(T,{class:"border-primary mr-16"},{default:o(()=>[E(l(v.$t("layout.about.update"))+" License ",1)]),_:1})]),_:1})),[[k,new(e(be))("ADMIN")]])])):C("",!0)])),[[x,h.value]]),n("div",qe,[t(A,{type:"info"},{default:o(()=>[E(l(v.$t("layout.copyright")),1)]),_:1})])]}),_:1},8,["modelValue","class"])}}}),Qe={style:{"margin-top":"10px"}},Ze={class:"vertical-middle lighter break-all"},et={class:"mr-4"},tt=B({__name:"APIKeyDialog",props:{userId:{type:String,default:""}},emits:["addData"],setup(M,{expose:s,emit:p}){const d=me(),{params:{id:b}}=d,f=window.location.origin+"/doc/",h=S(),_=S(!1),w=S(!1),P=S(null);_e(_,i=>{i||(P.value=null)});function I(i){h.value.open(i,"USER")}function F(i){ke(`${N("views.applicationOverview.appInfo.APIKeyDialog.msgConfirm1")}: ${i.secretKey}?`,N(N("views.applicationOverview.appInfo.APIKeyDialog.msgConfirm2")),{confirmButtonText:N("common.confirm"),cancelButtonText:N("common.cancel"),confirmButtonClass:"color-danger"}).then(()=>{Y.delAPIKey(i.id,w).then(()=>{ue(N("common.deleteSuccess")),u()})}).catch(()=>{})}function z(i,A){const U={isActive:i},k=i?N("views.applicationOverview.appInfo.APIKeyDialog.enabledSuccess"):N("views.applicationOverview.appInfo.APIKeyDialog.disabledSuccess");Y.putAPIKey(A.id,U,w).then(x=>{ue(k),u()})}function v(){Y.postAPIKey(w).then(i=>{u()})}const a=()=>{u(),_.value=!0};function u(){Y.getAPIKey().then(i=>{i.data.sort((A,U)=>A.name<U.name?1:-1),P.value=i.data})}function T(){u()}return s({open:a}),(i,A)=>{const U=c("el-text"),k=c("AppIcon"),x=c("el-button"),D=c("el-card"),R=c("el-table-column"),W=c("el-switch"),L=c("el-tooltip"),K=c("el-table"),O=c("el-dialog");return r(),g(O,{title:i.$t("layout.apiKey"),modelValue:_.value,"onUpdate:modelValue":A[2]||(A[2]=m=>_.value=m),width:"800","close-on-click-modal":!1,"close-on-press-escape":!1},{default:o(()=>[t(D,{shadow:"never",class:"layout-bg mb-16"},{default:o(()=>[t(U,{type:"info",class:"color-secondary"},{default:o(()=>[E(l(i.$t("layout.apiServiceAddress")),1)]),_:1}),n("p",Qe,[n("span",{class:"vertical-middle lighter break-all"},l(f)),t(x,{type:"primary",text:"",onClick:A[0]||(A[0]=m=>e(re)(f))},{default:o(()=>[t(k,{iconName:"app-copy"})]),_:1})])]),_:1}),t(x,{type:"primary",class:"mb-16",onClick:v},{default:o(()=>[E(l(i.$t("common.create")),1)]),_:1}),t(K,{data:P.value,class:"mb-16",loading:w.value},{default:o(()=>[t(R,{prop:"secretKey",label:"API Key"},{default:o(({row:m})=>[n("span",Ze,l(m.secretKey),1),t(x,{type:"primary",text:"",onClick:$=>e(re)(m.secretKey)},{default:o(()=>[t(k,{iconName:"app-copy"})]),_:2},1032,["onClick"])]),_:1}),t(R,{label:i.$t("common.status.label"),width:"80"},{default:o(({row:m})=>[n("div",{onClick:A[1]||(A[1]=te(()=>{},["stop"]))},[t(W,{size:"small",modelValue:m.isActive,"onUpdate:modelValue":$=>m.isActive=$,onChange:$=>z($,m)},null,8,["modelValue","onUpdate:modelValue","onChange"])])]),_:1},8,["label"]),t(R,{prop:"name",label:i.$t("common.createDate"),width:"170"},{default:o(({row:m})=>[E(l(e(Ae)(m.createTime)),1)]),_:1},8,["label"]),t(R,{label:i.$t("common.setting"),align:"left",width:"80"},{default:o(({row:m})=>[n("span",et,[t(L,{effect:"dark",content:i.$t("common.setting"),placement:"top"},{default:o(()=>[t(x,{type:"primary",text:"",onClick:te($=>I(m),["stop"])},{default:o(()=>[t(k,{iconName:"app-setting"})]),_:2},1032,["onClick"])]),_:2},1032,["content"])]),t(L,{effect:"dark",content:i.$t("common.delete"),placement:"top"},{default:o(()=>[t(x,{type:"primary",text:"",onClick:$=>F(m)},{default:o(()=>[t(k,{iconName:"app-delete"})]),_:2},1032,["onClick"])]),_:2},1032,["content"])]),_:1},8,["label"])]),_:1},8,["data","loading"]),t(Pe,{ref_key:"SettingAPIKeyDialogRef",ref:h,onRefresh:T},null,512)]),_:1},8,["title","modelValue"])}}}),ot={class:"flex-center cursor"},nt=["title"],st={class:"userInfo flex align-center"},at={class:"mr-12 flex align-center"},lt={style:{width:"90%"}},it={class:"bold mb-4",style:{"font-size":"14px"}},ct={class:"color-secondary lighter"},rt={class:"flex-between w-full"},ut={class:"flex-between w-full",style:{"line-height":"22px",padding:"12px 11px"}},dt=B({__name:"index",setup(M){const{user:s,login:p}=oe(),d=fe(),b=S(),f=S(),h=S(),_=a=>{s.postUserLanguage(a)},w=()=>{var a;(a=b.value)==null||a.open()};function P(){f.value.open()}const I=()=>{var a;(a=h.value)==null||a.open()},F={系统管理员:"layout.about.inner_admin",工作空间管理员:"layout.about.inner_wsm",普通用户:"layout.about.inner_user"},z=ee(()=>{var a,u;return s.userInfo?(u=(a=s.userInfo)==null?void 0:a.roleName)==null?void 0:u.map(T=>{const i=F[T];return i?N(i):T}):[]}),v=()=>{p.logout().then(()=>{var a;(a=s==null?void 0:s.userInfo)!=null&&a.source&&["CAS","OIDC","OAuth2"].includes(s.userInfo.source)?d.push({name:"login",query:{login_mode:"manual"}}):d.push({name:"login"})})};return we(()=>{var a,u;(a=s.userInfo)!=null&&a.isEditPassword&&((u=h.value)==null||u.open())}),(a,u)=>{var L;const T=c("el-avatar"),i=c("CaretBottom"),A=c("el-icon"),U=c("TagGroup"),k=c("el-dropdown-item"),x=c("ArrowRight"),D=c("Check"),R=c("el-dropdown-menu"),W=c("el-dropdown");return r(),V(Q,null,[t(W,{trigger:"click",type:"primary"},{dropdown:o(()=>[t(R,{class:"avatar-dropdown"},{default:o(()=>{var K,O,m;return[n("div",st,[n("div",at,[t(T,{size:30},{default:o(()=>u[3]||(u[3]=[n("img",{src:de,style:{width:"54%"},alt:""},null,-1)])),_:1,__:[3]})]),n("div",lt,[n("p",it,[E(l((K=e(s).userInfo)==null?void 0:K.nickname)+" ",1),n("span",ct,"("+l((O=e(s).userInfo)==null?void 0:O.username)+")",1)]),(m=e(s).userInfo)!=null&&m.roleName&&e(s).userInfo.roleName.length>0?(r(),V(Q,{key:0},[e(G)([e(X).IS_EE,e(X).IS_PE],"OR")?(r(),g(U,{key:0,size:"small",tags:z.value},null,8,["tags"])):C("",!0)],64)):C("",!0)])]),e(G)([e(y).EXTENDS_ADMIN,e(y).EXTENDS_WORKSPACE_MANAGE,e(y).ADMIN,e(y).WORKSPACE_MANAGE],"OR")?(r(),g(k,{key:0,class:"border-t",onClick:u[0]||(u[0]=$=>e(d).push({path:"/system/user"}))},{default:o(()=>[n("div",rt,l(a.$t("views.system.title")),1)]),_:1})):C("",!0),e(G)(new(e(H))([e(y).ADMIN,e(y).WORKSPACE_MANAGE,e(y).USER],[e(j).CHANGE_PASSWORD],[],"OR"),"OR")?(r(),g(k,{key:1,onClick:I},{default:o(()=>[E(l(a.$t("views.login.resetPassword")),1)]),_:1})):C("",!0),n("div",null,[e(G)(new(e(H))([e(y).ADMIN],[e(j).SYSTEM_API_KEY_EDIT],[e(X).IS_EE,e(X).IS_PE],"OR"),"OR")?(r(),g(k,{key:0,class:"p-8",onClick:P},{default:o(()=>[E(l(a.$t("layout.apiKey")),1)]),_:1})):C("",!0)]),e(G)(new(e(H))([e(y).ADMIN,e(y).WORKSPACE_MANAGE,e(y).USER],[e(j).SWITCH_LANGUAGE],[],"OR"),"OR")?(r(),g(k,{key:2,style:{padding:"0"},onClick:u[1]||(u[1]=te(()=>{},["stop"]))},{default:o(()=>[t(W,{class:"w-full",trigger:"hover",placement:"left-start"},{dropdown:o(()=>[t(R,{style:{width:"180px"}},{default:o(()=>[(r(!0),V(Q,null,Ie(e($e),($,ye)=>(r(),g(k,{key:ye,value:$.value,onClick:J=>_($.value),class:"flex-between"},{default:o(()=>{var J,se,ae;return[n("span",{class:q($.value===((J=e(s).userInfo)==null?void 0:J.language)?"primary":"")},l($.label),3),$.value===((se=e(s).userInfo)==null?void 0:se.language)?(r(),g(A,{key:0,class:q($.value===((ae=e(s).userInfo)==null?void 0:ae.language)?"primary":"")},{default:o(()=>[t(D)]),_:2},1032,["class"])):C("",!0)]}),_:2},1032,["value","onClick"]))),128))]),_:1})]),default:o(()=>[n("div",ut,[n("span",null,l(a.$t("layout.language")),1),t(A,null,{default:o(()=>[t(x)]),_:1})])]),_:1})]),_:1})):C("",!0),e(G)(new(e(H))([e(y).ADMIN,e(y).USER,e(y).WORKSPACE_MANAGE],[e(j).ABOUT_READ],[],"OR"),"OR")?(r(),g(k,{key:3,onClick:w},{default:o(()=>[E(l(a.$t("layout.about.title")),1)]),_:1})):C("",!0),t(k,{class:"border-t",onClick:v},{default:o(()=>[E(l(a.$t("layout.logout")),1)]),_:1})]}),_:1})]),default:o(()=>{var K,O;return[n("div",ot,[t(T,{size:30},{default:o(()=>u[2]||(u[2]=[n("img",{src:de,style:{width:"54%"},alt:""},null,-1)])),_:1,__:[2]}),n("span",{class:"ml-8 color-text-primary ellipsis",title:(K=e(s).userInfo)==null?void 0:K.nickname},l((O=e(s).userInfo)==null?void 0:O.nickname),9,nt),t(A,{class:"el-icon--right"},{default:o(()=>[t(i)]),_:1})])]}),_:1}),t(tt,{"user-id":(L=e(s).userInfo)==null?void 0:L.id,ref_key:"APIKeyDialogRef",ref:f},null,8,["user-id"]),t(Se,{ref_key:"resetPasswordRef",ref:h},null,512),t(Je,{ref_key:"AboutDialogRef",ref:b},null,512)],64)}}}),pt=ne(dt,[["__scopeId","data-v-3d94e051"]]),_t={class:"flex align-center"},mt=B({__name:"index",setup(M){const{theme:s}=oe();function p(d){window.open(d,"_blank")}return(d,b)=>{var h,_,w;const f=c("el-tooltip");return r(),V("div",_t,[(h=e(s).themeInfo)!=null&&h.showProject?(r(),g(f,{key:0,effect:"dark",content:d.$t("layout.github"),placement:"top"},{default:o(()=>[t(Z,{iconName:"app-github",class:"cursor color-secondary mr-8 ml-8",style:{"font-size":"20px"},onClick:b[0]||(b[0]=P=>{var I;return p((I=e(s).themeInfo)==null?void 0:I.projectUrl)})})]),_:1},8,["content"])):C("",!0),(_=e(s).themeInfo)!=null&&_.showUserManual?(r(),g(f,{key:1,effect:"dark",content:d.$t("layout.wiki"),placement:"top"},{default:o(()=>[t(Z,{iconName:"app-user-manual",class:"cursor color-secondary mr-8 ml-8",style:{"font-size":"20px"},onClick:b[1]||(b[1]=P=>{var I;return p((I=e(s).themeInfo)==null?void 0:I.userManualUrl)})})]),_:1},8,["content"])):C("",!0),(w=e(s).themeInfo)!=null&&w.showForum?(r(),g(f,{key:2,effect:"dark",content:d.$t("layout.forum"),placement:"top"},{default:o(()=>[t(Z,{iconName:"app-help",class:"cursor color-secondary mr-8 ml-8",style:{"font-size":"20px"},onClick:b[2]||(b[2]=P=>{var I;return p((I=e(s).themeInfo)==null?void 0:I.forumUrl)})})]),_:1},8,["content"])):C("",!0)])}}}),ft=ne(mt,[["__scopeId","data-v-bff0fa46"]]),vt={class:"app-top-bar-container border-b flex-center"},yt={class:"logo mt-4"},gt={class:"flex-between w-full align-center"},ht={class:"flex align-center mr-8"},bt=B({__name:"SystemHeader",setup(M){const s=fe();return(p,d)=>{const b=c("LogoFull"),f=c("el-divider"),h=c("AppIcon"),_=c("el-button");return r(),V("div",vt,[n("div",yt,[t(b)]),n("div",gt,[n("h4",null,[t(f,{class:"ml-16 mr-16",direction:"vertical"}),E(l(p.$t("views.system.title")),1)]),n("div",ht,[t(ft),t(f,{class:"ml-8 mr-8",direction:"vertical"}),e(G)([e(y).USER.getWorkspaceRole,e(y).EXTENDS_USER.getWorkspaceRole,e(y).EXTENDS_WORKSPACE_MANAGE.getWorkspaceRole,e(y).WORKSPACE_MANAGE.getWorkspaceRole],"OR")?(r(),g(_,{key:0,link:"",onClick:d[0]||(d[0]=w=>e(s).push({path:"/"})),style:{color:"var(--el-text-color-primary)"}},{default:o(()=>[t(h,{class:"mr-8",iconName:"app-workspace",style:{"font-size":"16px"}}),E(" "+l(p.$t("views.workspace.toWorkspace")),1)]),_:1})):C("",!0)])]),t(pt)])}}}),It=ne(bt,[["__scopeId","data-v-c20e3067"]]),$t=B({__name:"index",setup(M){const s=me(),p=S([]);return Ce(()=>{const{name:d,meta:b}=s;d&&!p.value.includes(d)&&p.value.push(d)}),(d,b)=>{const f=c("router-view");return r(),g(f,null,{default:o(({Component:h})=>[t(Ee,{appear:"",name:"fade-transform",mode:"out-in"},{default:o(()=>[(r(),g(Re,{include:p.value},[(r(),g(Ne(h),{key:e(s).path}))],1032,["include"]))]),_:2},1024)]),_:1})}}});export{pt as A,It as S,ft as T,$t as _};

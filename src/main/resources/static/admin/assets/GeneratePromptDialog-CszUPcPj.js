import{ay as de,aQ as Z,aP as me,aB as n,b_ as xe,aE as D,aG as e,aD as t,aH as l,bF as Te,aI as r,aU as J,aK as T,aJ as p,a_ as re,aW as ce,aF as w,aC as oe,aX as Re,aR as ne,c5 as Ue,a$ as Le,b4 as ue,b3 as he,bC as pe,co as ge,aA as ye,e0 as Ae,aT as ee,aZ as $e,aY as we,ce as De,b$ as Ve,e1 as Se,c9 as Fe,b8 as Ie,c3 as Pe,dw as qe,aS as Ne,cT as ze,cq as Ce,cU as Oe,e2 as Ke,bK as ke,cx as He,c7 as Ee,c8 as Be,cn as We}from"./admin-C1F6ScCT.js";const Ge={class:"dialog-footer"},Yl=de({__name:"AIModeParamSettingDialog",emits:["refresh"],setup(se,{expose:E,emit:B}){const q=me(),A=Z(()=>q.path.includes("resource-management")?"systemManage":"workspace"),x=n([]),P=B,N=n(),i=n({}),d=n(!1),c=n(!1),m=(o,u)=>ce({type:"model",systemType:A.value}).getModelParamsForm(o,c),v=n(""),g=Z(()=>xe.model[A.value]),F=(o,u,_)=>{v.value=o,i.value={},m(o).then(k=>{var b;x.value=k.data,(b=N.value)==null||b.render(x.value,_)}),d.value=!0},L=(o,u)=>{m(o).then($=>{x.value=$.data;const k=$.data.map(b=>b.show_default_value===!1?{[b.field]:void 0}:{[b.field]:b.defaultValue}).reduce((b,h)=>({...b,...h}),{});P("refresh",k)})},z=async()=>{var o;(o=N.value)==null||o.validate().then(()=>{P("refresh",i.value),d.value=!1})};return E({open:F,reset_default:L}),(o,u)=>{const _=t("el-button"),$=t("el-dialog");return w(),D($,{"align-center":"",title:o.$t("common.paramSetting"),modelValue:d.value,"onUpdate:modelValue":u[2]||(u[2]=k=>d.value=k),style:{width:"550px"},"append-to-body":"","destroy-on-close":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:e(()=>[r("span",Ge,[l(_,{onClick:u[1]||(u[1]=re(k=>d.value=!1,["prevent"]))},{default:e(()=>[T(p(o.$t("common.cancel")),1)]),_:1}),g.value.paramSetting(v.value)?(w(),D(_,{key:0,type:"primary",onClick:z,loading:c.value},{default:e(()=>[T(p(o.$t("common.confirm")),1)]),_:1},8,["loading"])):J("",!0)])]),default:e(()=>[l(Te,{modelValue:i.value,"onUpdate:modelValue":u[0]||(u[0]=k=>i.value=k),model:i.value,"label-position":"top","require-asterisk-position":"right",render_data:x.value,ref_key:"dynamicsFormRef",ref:N},null,8,["modelValue","model","render_data"])]),_:1},8,["title","modelValue"])}}}),je={class:"p-8"},Je={class:"mb-4"},Qe={class:"mb-4"},Xe={class:"mb-4"},Ye={class:"flex align-center"},Ze={class:"mr-4"},el={class:"flex align-center"},ll={class:"mr-4"},al={class:"dialog-footer"},Zl=de({__name:"ParamSettingDialog",emits:["refresh"],setup(se,{expose:E,emit:B}){const q=B,A=n(),x=n(),P={ai_questioning:"{question}",designated_answer:oe("views.application.dialog.designated_answer")},N=oe("views.application.dialog.defaultPrompt1",{question:"{question}"})+"<data></data>"+oe("views.application.dialog.defaultPrompt2"),i=n({knowledgeSetting:{searchMode:"embedding",topN:3,similarity:.6,maxParagraphCharNumber:5e3,noReferencesSetting:{status:"ai_questioning",value:"{question}"}},problemOptimization:!1,problemOptimizationPrompt:N}),d=n({ai_questioning:P.ai_questioning,designated_answer:P.designated_answer}),c=Re({ai_questioning:[{required:!0,message:oe("views.application.form.aiModel.placeholder"),trigger:"blur"}],designated_answer:[{required:!0,message:oe("views.application.form.prompt.requiredMessage"),trigger:"blur"}]}),m=n(!1),v=n(!1),g=n(!1);ne(m,o=>{var u;o||(d.value={ai_questioning:P.ai_questioning,designated_answer:P.designated_answer},(u=x.value)==null||u.clearValidate())});const F=(o,u)=>{g.value=Ue(u),i.value={knowledgeSetting:Le.cloneDeep(o.knowledgeSetting),problemOptimization:o.problemOptimization,problemOptimizationPrompt:o.problemOptimizationPrompt},g.value||(d.value[i.value.knowledgeSetting.noReferencesSetting.status]=i.value.knowledgeSetting.noReferencesSetting.value),m.value=!0},L=async o=>{if(g.value)delete i.value.noReferencesSetting,q("refresh",i.value),m.value=!1;else{if(!o)return;await o.validate((u,_)=>{u&&(i.value.knowledgeSetting.noReferencesSetting.value=d.value[i.value.knowledgeSetting.noReferencesSetting.status],q("refresh",i.value),m.value=!1)})}};function z(o){o==="keywords"?i.value.knowledgeSetting.similarity=0:i.value.knowledgeSetting.similarity=.6}return E({open:F}),(o,u)=>{const _=t("el-text"),$=t("el-radio"),k=t("el-card"),b=t("el-radio-group"),h=t("el-form-item"),S=t("el-tooltip"),C=t("el-input-number"),O=t("el-col"),y=t("el-row"),a=t("el-slider"),f=t("el-input"),M=t("el-form"),K=t("el-switch"),G=t("el-scrollbar"),H=t("el-button"),le=t("el-dialog"),ae=he("loading");return w(),D(le,{class:"scrollbar-dialog","align-center":"",title:o.$t("common.paramSetting"),modelValue:m.value,"onUpdate:modelValue":u[11]||(u[11]=I=>m.value=I),width:"550px","append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:e(()=>[r("span",al,[l(H,{onClick:u[9]||(u[9]=re(I=>m.value=!1,["prevent"]))},{default:e(()=>[T(p(o.$t("common.cancel")),1)]),_:1}),l(H,{type:"primary",onClick:u[10]||(u[10]=I=>L(x.value)),loading:v.value},{default:e(()=>[T(p(o.$t("common.save")),1)]),_:1},8,["loading"])])]),default:e(()=>[l(G,{"max-height":"550"},{default:e(()=>[r("div",je,[ue((w(),D(M,{"label-position":"top",ref_key:"paramFormRef",ref:A,model:i.value},{default:e(()=>[l(h,{label:o.$t("views.application.dialog.selectSearchMode")},{default:e(()=>[l(b,{modelValue:i.value.knowledgeSetting.searchMode,"onUpdate:modelValue":u[0]||(u[0]=I=>i.value.knowledgeSetting.searchMode=I),class:"card__radio",onChange:z},{default:e(()=>[l(k,{shadow:"never",class:pe(["mb-16",i.value.searchMode==="embedding"?"active":""])},{default:e(()=>[l($,{value:"embedding",size:"large"},{default:e(()=>[r("p",Je,p(o.$t("views.application.dialog.vectorSearch")),1),l(_,{type:"info"},{default:e(()=>[T(p(o.$t("views.application.dialog.vectorSearchTooltip")),1)]),_:1})]),_:1})]),_:1},8,["class"]),l(k,{shadow:"never",class:pe(["mb-16",i.value.knowledgeSetting.searchMode==="keywords"?"active":""])},{default:e(()=>[l($,{value:"keywords",size:"large"},{default:e(()=>[r("p",Qe,p(o.$t("views.application.dialog.fullTextSearch")),1),l(_,{type:"info"},{default:e(()=>[T(p(o.$t("views.application.dialog.fullTextSearchTooltip")),1)]),_:1})]),_:1})]),_:1},8,["class"]),l(k,{shadow:"never",class:pe(i.value.knowledgeSetting.searchMode==="hybrid"?"active":"")},{default:e(()=>[l($,{value:"hybrid",size:"large"},{default:e(()=>[r("p",Xe,p(o.$t("views.application.dialog.hybridSearch")),1),l(_,{type:"info"},{default:e(()=>[T(p(o.$t("views.application.dialog.hybridSearchTooltip")),1)]),_:1})]),_:1})]),_:1},8,["class"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(y,{gutter:10},{default:e(()=>[l(O,{span:12},{default:e(()=>[l(h,null,{label:e(()=>[r("div",Ye,[r("span",Ze,p(o.$t("views.application.dialog.similarityThreshold")),1),l(S,{effect:"dark",content:o.$t("views.application.dialog.similarityTooltip"),placement:"right"},{default:e(()=>[l(ge,{iconName:"app-warning",class:"app-warning-icon"})]),_:1},8,["content"])])]),default:e(()=>[l(C,{modelValue:i.value.knowledgeSetting.similarity,"onUpdate:modelValue":u[1]||(u[1]=I=>i.value.knowledgeSetting.similarity=I),min:0,max:i.value.knowledgeSetting.searchMode==="hybrid"?2:1,precision:3,step:.1,"value-on-clear":0,"controls-position":"right",class:"w-full"},null,8,["modelValue","max"])]),_:1})]),_:1}),l(O,{span:12},{default:e(()=>[l(h,{label:o.$t("views.application.dialog.topReferences")},{default:e(()=>[l(C,{modelValue:i.value.knowledgeSetting.topN,"onUpdate:modelValue":u[2]||(u[2]=I=>i.value.knowledgeSetting.topN=I),min:1,max:1e4,"value-on-clear":1,"controls-position":"right",class:"w-full"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),l(h,{label:o.$t("views.application.dialog.maxCharacters")},{default:e(()=>[l(a,{modelValue:i.value.knowledgeSetting.maxParagraphCharNumber,"onUpdate:modelValue":u[3]||(u[3]=I=>i.value.knowledgeSetting.maxParagraphCharNumber=I),"show-input":"","show-input-controls":!1,min:500,max:1e5,class:"custom-slider"},null,8,["modelValue"])]),_:1},8,["label"]),g.value?J("",!0):(w(),D(h,{key:0,label:o.$t("views.application.dialog.noReferencesAction")},{default:e(()=>[l(M,{"label-position":"top",ref_key:"noReferencesFormRef",ref:x,model:d.value,rules:c,"hide-required-asterisk":!0,class:"w-full"},{default:e(()=>[l(b,{modelValue:i.value.knowledgeSetting.noReferencesSetting.status,"onUpdate:modelValue":u[5]||(u[5]=I=>i.value.knowledgeSetting.noReferencesSetting.status=I),class:"radio-block-avatar"},{default:e(()=>[l($,{value:"ai_questioning"},{default:e(()=>[r("p",null,p(o.$t("views.application.dialog.continueQuestioning")),1)]),_:1}),l($,{value:"designated_answer"},{default:e(()=>[r("p",null,p(o.$t("views.application.dialog.provideAnswer")),1),i.value.knowledgeSetting.noReferencesSetting.status==="designated_answer"?(w(),D(h,{key:0,prop:"designated_answer"},{default:e(()=>[l(f,{modelValue:d.value.designated_answer,"onUpdate:modelValue":u[4]||(u[4]=I=>d.value.designated_answer=I),rows:2,type:"textarea",maxlength:"2048",placeholder:P.designated_answer},null,8,["modelValue","placeholder"])]),_:1})):J("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["model","rules"])]),_:1},8,["label"])),g.value?J("",!0):(w(),D(h,{key:1,onClick:u[7]||(u[7]=re(()=>{},["prevent"]))},{label:e(()=>[r("div",el,[r("span",ll,p(o.$t("views.application.form.problemOptimization.label")),1)])]),default:e(()=>[l(K,{size:"small",modelValue:i.value.problemOptimization,"onUpdate:modelValue":u[6]||(u[6]=I=>i.value.problemOptimization=I)},null,8,["modelValue"])]),_:1})),i.value.problemOptimization?(w(),D(h,{key:2,label:o.$t("views.application.form.prompt.label")},{default:e(()=>[l(f,{modelValue:i.value.problemOptimizationPrompt,"onUpdate:modelValue":u[8]||(u[8]=I=>i.value.problemOptimizationPrompt=I),rows:6,type:"textarea",maxlength:"2048",placeholder:N},null,8,["modelValue"])]),_:1},8,["label"])):J("",!0)]),_:1},8,["model"])),[[ae,v.value]])])]),_:1})]),_:1},8,["title","modelValue"])}}}),tl={class:"flex-between mb-8"},ol={class:"flex"},nl=["id"],sl={class:"p-8"},il={class:"layout-bg"},rl={class:"flex-between p-16 ml-8"},ul={class:"p-16-24 pt-0",style:{height:"calc(100vh - 200px)"}},dl=["title"],cl={class:"flex-between"},pl={class:"flex"},ea=de({__name:"AddKnowledgeDialog",props:{data:{type:Array,default:()=>[]},loading:Boolean},emits:["addData"],setup(se,{expose:E,emit:B}){const q=me(),A=se,x=B,{folder:P,user:N}=ye(),i=Z(()=>q.path.includes("shared")?"systemShare":q.path.includes("resource-management")?"systemManage":"workspace"),d=n(!1),c=n([]),m=n(""),v=n(""),g=n([]),F=n([]),L=n(!1),z=Z(()=>m.value?g.value.filter(a=>a.embeddingModelId===m.value):g.value);ne(d,a=>{a||(c.value=[],m.value="",v.value="",g.value=[],F.value=[])}),ne(v,a=>{var f;console.log("val",a),console.log((f=h.value)==null?void 0:f.id),a?g.value=F.value.filter(M=>{var K;return M.name.includes(a)&&M.folderId===((K=h.value)==null?void 0:K.id)}):g.value=F.value.filter(M=>{var K;return M.folderId===((K=h.value)==null?void 0:K.id)})});function o(){var a,f;c.value.length>0?m.value=(f=(a=F.value)==null?void 0:a.find(M=>M.id===c.value[0]))==null?void 0:f.embeddingModelId:c.value.length===0&&(m.value="")}function u(){c.value=[],m.value=""}const _=a=>{c.value=a,O(),c.value.length>0&&(m.value=A.data.filter(f=>f.id===c.value[0])[0].embeddingModelId),d.value=!0},$=()=>{x("addData",F.value.filter(a=>c.value.includes(a.id))),d.value=!1},k=()=>{v.value="",F.value=[],y()},b=n([]),h=n({}),S=n(!1);function C(a){var f;a.id!==((f=h.value)==null?void 0:f.id)&&(h.value=a,y())}function O(){const a={};P.asyncGetFolder("KNOWLEDGE",a,i.value,S).then(f=>{var M;b.value=f.data,h.value=((M=f.data)==null?void 0:M[0])||{},y()})}function y(){var f;const a=((f=h.value)==null?void 0:f.id)||N.getWorkspaceId();ce({type:"knowledge",isShared:a==="share",systemType:i.value}).getKnowledgeList({folderId:a},L).then(M=>{F.value=Ae([...F.value,...M.data],"id"),g.value=M.data})}return E({open:_}),(a,f)=>{const M=t("el-text"),K=t("Refresh"),G=t("el-icon"),H=t("el-button"),le=t("el-input"),ae=t("el-col"),I=t("el-row"),Q=t("el-empty"),U=t("el-scrollbar"),te=t("el-dialog"),ie=he("loading");return w(),D(te,{title:a.$t("views.application.dialog.addKnowledge"),modelValue:d.value,"onUpdate:modelValue":f[3]||(f[3]=s=>d.value=s),width:"1000","append-to-body":"",class:"addKnowledge-dialog","align-center":"","close-on-click-modal":!1,"close-on-press-escape":!1},{header:e(({titleId:s,titleClass:R})=>[r("div",tl,[r("div",ol,[r("h4",{id:s,class:pe([R,"mr-8"])},p(a.$t("views.application.dialog.addKnowledge")),11,nl),l(M,{type:"info"},{default:e(()=>[T(p(a.$t("views.application.dialog.addKnowledgePlaceholder")),1)]),_:1})]),l(H,{link:"",class:"mr-24",onClick:k},{default:e(()=>[l(G,{size:18},{default:e(()=>[l(K)]),_:1})]),_:1})])]),footer:e(()=>[r("div",cl,[r("div",pl,[c.value.length>0?(w(),D(M,{key:0,type:"info",class:"color-secondary mr-8"},{default:e(()=>[T(p(a.$t("common.selected"))+" "+p(c.value.length),1)]),_:1})):J("",!0),c.value.length>0?(w(),D(H,{key:1,link:"",type:"primary",onClick:u},{default:e(()=>[T(p(a.$t("common.clear")),1)]),_:1})):J("",!0)]),r("span",null,[l(H,{onClick:f[2]||(f[2]=re(s=>d.value=!1,["prevent"]))},{default:e(()=>[T(p(a.$t("common.cancel")),1)]),_:1}),l(H,{type:"primary",onClick:$},{default:e(()=>[T(p(a.$t("common.add")),1)]),_:1})])])]),default:e(()=>[l(Ve,{showCollapse:"",class:"application-manage"},{left:e(()=>{var s;return[r("div",sl,[ue(l(De,{data:b.value,currentNodeKey:(s=h.value)==null?void 0:s.id,onHandleNodeClick:C,canOperation:!1,showShared:"",shareTitle:a.$t("views.shared.shared_knowledge"),treeStyle:{height:"calc(100vh - 240px)"}},null,8,["data","currentNodeKey","shareTitle"]),[[ie,S.value]])])]}),default:e(()=>[r("div",il,[r("div",rl,[r("h4",null,p(a.$t("views.knowledge.title")),1),l(le,{modelValue:v.value,"onUpdate:modelValue":f[0]||(f[0]=s=>v.value=s),placeholder:a.$t("common.search"),"prefix-icon":"Search",class:"w-240 mr-8",clearable:""},null,8,["modelValue","placeholder"])]),l(U,null,{default:e(()=>[r("div",ul,[z.value.length?ue((w(),D(I,{key:0,gutter:12},{default:e(()=>[(w(!0),ee(we,null,$e(z.value.filter(s=>s.resourceType!=="folder"),(s,R)=>(w(),D(ae,{span:8,key:R,class:"mb-16"},{default:e(()=>[l(Se,{"value-field":"id",data:s,modelValue:c.value,"onUpdate:modelValue":f[1]||(f[1]=W=>c.value=W),onChange:o},{default:e(()=>[r("span",{class:"ellipsis cursor ml-12",title:s.name},p(s.name),9,dl)]),_:2},1032,["data","modelValue"])]),_:2},1024))),128))]),_:1})),[[ie,L.value]]):(w(),D(Q,{key:1,description:a.$t("common.noData")},null,8,["description"]))])]),_:1})])]),_:1})]),_:1},8,["title","modelValue"])}}}),ml={class:"flex-between"},vl={class:"dialog-footer"},la=de({__name:"TTSModeParamSettingDialog",emits:["refresh"],setup(se,{expose:E,emit:B}){const q=me(),{params:{id:A}}=q,x=Z(()=>q.path.includes("resource-management")?"systemManage":"workspace"),P=n(""),N=n([]),i=B,d=n(),c=n({}),m=n(!1),v=n(!1),g=n(!1),F=(_,$,k)=>{c.value={},P.value=_,ce({type:"model",systemType:x.value}).getModelParamsForm(_,v).then(b=>{var S;N.value=b.data;const h=b.data.map(C=>({[C.field]:C.show_default_value!==!1?C.defaultValue:void 0})).reduce((C,O)=>({...C,...O}),{});k&&Object.keys(k).forEach(C=>{C in h||delete k[C]}),k={...h,...k},(S=d.value)==null||S.render(N.value,k)}),m.value=!0},L=(_,$)=>{ce({type:"model",systemType:x.value}).getModelParamsForm(_,v).then(k=>{N.value=k.data;const b=k.data.map(h=>({[h.field]:h.show_default_value!==!1?h.defaultValue:void 0})).reduce((h,S)=>({...h,...S}),{});console.log("model_setting_data: ",b),i("refresh",b)})},z=async()=>{var _;(_=d.value)==null||_.validate().then(()=>{i("refresh",c.value),m.value=!1})},o=n(null),u=()=>{const _={...c.value,ttsModelId:P.value};ce({type:"application",systemType:x.value}).playDemoText(A,_,g).then(async $=>{if($.type==="application/json"){const h=await $.text();Fe(h);return}const k=new Blob([$],{type:"audio/mp3"}),b=URL.createObjectURL(k);o.value instanceof HTMLAudioElement?(o.value.src=b,o.value.play()):console.error("audioPlayer.value is not an instance of HTMLAudioElement")}).catch($=>{console.log("err: ",$)})};return E({open:F,reset_default:L}),(_,$)=>{const k=t("el-button"),b=t("el-dialog");return w(),ee(we,null,[l(b,{"align-center":"",title:_.$t("common.paramSetting"),modelValue:m.value,"onUpdate:modelValue":$[2]||($[2]=h=>m.value=h),style:{width:"550px"},"append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:e(()=>[r("div",ml,[l(k,{onClick:u,loading:g.value},{default:e(()=>[l(ge,{iconName:"app-video-play",class:"mr-4"}),T(" "+p(_.$t("views.application.form.voicePlay.listeningTest")),1)]),_:1},8,["loading"]),r("span",vl,[l(k,{onClick:$[1]||($[1]=re(h=>m.value=!1,["prevent"]))},{default:e(()=>[T(p(_.$t("common.cancel")),1)]),_:1}),l(k,{type:"primary",onClick:z,loading:v.value},{default:e(()=>[T(p(_.$t("common.confirm")),1)]),_:1},8,["loading"])])])]),default:e(()=>[l(Te,{modelValue:c.value,"onUpdate:modelValue":$[0]||($[0]=h=>c.value=h),model:c.value,"label-position":"top","require-asterisk-position":"right",render_data:N.value,ref_key:"dynamicsFormRef",ref:d},null,8,["modelValue","model","render_data"])]),_:1},8,["title","modelValue"]),r("audio",{ref_key:"audioPlayer",ref:o,controls:"",hidden:"hidden"},null,512)],64)}}}),fl={class:"dialog-footer p-16"},aa=de({__name:"ReasoningParamSettingDialog",emits:["refresh"],setup(se,{expose:E,emit:B}){const q=B,A=n({reasoningContent_start:"<think>",reasoningContent_end:"</think>"}),x=n(!1),P=n(!1);ne(x,d=>{d||(A.value={reasoningContent_start:"<think>",reasoningContent_end:"</think>"})});const N=d=>{A.value={...A.value,...d},x.value=!0},i=()=>{q("refresh",A.value),x.value=!1};return E({open:N}),(d,c)=>{const m=t("el-text"),v=t("el-input"),g=t("el-form-item"),F=t("el-col"),L=t("el-row"),z=t("el-form"),o=t("el-button"),u=t("el-dialog");return w(),D(u,{"align-center":"",title:d.$t("common.setting"),class:"param-dialog",modelValue:x.value,"onUpdate:modelValue":c[4]||(c[4]=_=>x.value=_),style:{width:"550px"},"append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:e(()=>[r("span",fl,[l(o,{onClick:c[2]||(c[2]=re(_=>x.value=!1,["prevent"]))},{default:e(()=>[T(p(d.$t("common.cancel")),1)]),_:1}),l(o,{type:"primary",onClick:c[3]||(c[3]=_=>i()),loading:P.value},{default:e(()=>[T(p(d.$t("common.save")),1)]),_:1},8,["loading"])])]),default:e(()=>[l(z,{"label-position":"top",ref:"paramFormRef",model:A.value},{default:e(()=>[l(m,{type:"info",class:"color-secondary"},{default:e(()=>[T(p(d.$t("views.application.form.reasoningContent.tooltip")),1)]),_:1}),l(L,{class:"mt-16",gutter:20},{default:e(()=>[l(F,{span:12},{default:e(()=>[l(g,{label:d.$t("views.application.form.reasoningContent.start")},{default:e(()=>[l(v,{type:"textarea",modelValue:A.value.reasoningContent_start,"onUpdate:modelValue":c[0]||(c[0]=_=>A.value.reasoningContent_start=_),rows:6,maxlength:"50",placeholder:"<think>"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),l(F,{span:12},{default:e(()=>[l(g,{label:d.$t("views.application.form.reasoningContent.end")},{default:e(()=>[l(v,{type:"textarea",modelValue:A.value.reasoningContent_end,"onUpdate:modelValue":c[1]||(c[1]=_=>A.value.reasoningContent_end=_),rows:6,maxlength:"50",placeholder:"</think>"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])}}}),_l={class:"flex-between mb-8"},gl={class:"flex"},hl=["id"],yl={class:"p-8"},wl={class:"layout-bg"},bl={class:"flex-between p-16 ml-8"},kl={class:"p-16-24 pt-0",style:{height:"calc(100vh - 200px)"}},$l=["src"],Vl=["title"],Sl={class:"flex-between"},Cl={class:"flex"},ta=de({__name:"ToolDialog",emits:["refresh"],setup(se,{expose:E,emit:B}){const q=me(),A=B,{folder:x,user:P}=ye(),N=Z(()=>q.path.includes("shared")?"systemShare":q.path.includes("resource-management")?"systemManage":"workspace"),i=n(!1),d=n([]),c=n(""),m=n([]),v=n([]),g=n("CUSTOM"),F=n(!1);ne(i,y=>{y||(d.value=[],c.value="",m.value=[],v.value=[])}),ne(c,y=>{y?m.value=v.value.filter(a=>a.name.includes(y)&&a.toolType===g.value):m.value=v.value.filter(a=>a.toolType===g.value)});function L(){}function z(){d.value=[]}const o=y=>{d.value=y||[],C(),i.value=!0},u=()=>{A("refresh",{toolIds:d.value}),i.value=!1},_=()=>{c.value="",v.value=[],O()};function $(){m.value=v.value.filter(y=>y.name.includes(c.value)&&y.toolType===g.value)}const k=n([]),b=n({}),h=n(!1);function S(y){var a;y.id!==((a=b.value)==null?void 0:a.id)&&(b.value=y,O())}function C(){const y={};x.asyncGetFolder("TOOL",y,N.value,h).then(a=>{var f;k.value=a.data,b.value=((f=a.data)==null?void 0:f[0])||{},O()})}function O(){var a;const y=((a=b.value)==null?void 0:a.id)||P.getWorkspaceId();ce({type:"tool",isShared:y==="share",systemType:"workspace"}).getToolList({folderId:y}).then(f=>{var M,K,G;v.value=((M=f.data)==null?void 0:M.tools)||f.data||[],v.value=(K=v.value)==null?void 0:K.filter(H=>H.isActive),m.value=f.data.tools||f.data,m.value=(G=m.value)==null?void 0:G.filter(H=>H.isActive&&H.toolType===g.value)})}return E({open:o}),(y,a)=>{const f=t("Refresh"),M=t("el-icon"),K=t("el-button"),G=t("el-divider"),H=t("el-radio-button"),le=t("el-radio-group"),ae=t("el-input"),I=t("el-avatar"),Q=t("ToolIcon"),U=t("el-col"),te=t("el-row"),ie=t("el-empty"),s=t("el-scrollbar"),R=t("el-text"),W=t("el-dialog"),j=he("loading");return w(),D(W,{modelValue:i.value,"onUpdate:modelValue":a[4]||(a[4]=V=>i.value=V),width:"1000","append-to-body":"",class:"addTool-dialog","align-center":"","close-on-click-modal":!1,"close-on-press-escape":!1},{header:e(({titleId:V,titleClass:X})=>[r("div",_l,[r("div",gl,[r("h4",{id:V,class:pe([X,"mr-8"])},p(y.$t("views.tool.settingTool")),11,hl)]),l(K,{link:"",class:"mr-24",onClick:_},{default:e(()=>[l(M,{size:18},{default:e(()=>[l(f)]),_:1})]),_:1})])]),footer:e(()=>[r("div",Sl,[r("div",Cl,[d.value.length>0?(w(),D(R,{key:0,type:"info",class:"color-secondary mr-8"},{default:e(()=>[T(p(y.$t("common.selected"))+" "+p(d.value.length),1)]),_:1})):J("",!0),d.value.length>0?(w(),D(K,{key:1,link:"",type:"primary",onClick:z},{default:e(()=>[T(p(y.$t("common.clear")),1)]),_:1})):J("",!0)]),r("span",null,[l(K,{onClick:a[3]||(a[3]=re(V=>i.value=!1,["prevent"]))},{default:e(()=>[T(p(y.$t("common.cancel")),1)]),_:1}),l(K,{type:"primary",onClick:u},{default:e(()=>[T(p(y.$t("common.add")),1)]),_:1})])])]),default:e(()=>[l(Ve,{showCollapse:"",class:"application-manage"},{left:e(()=>{var V;return[r("div",yl,[ue(l(De,{data:k.value,currentNodeKey:(V=b.value)==null?void 0:V.id,onHandleNodeClick:S,canOperation:!1,showShared:"",shareTitle:y.$t("views.shared.shared_tool"),treeStyle:{height:"calc(100vh - 240px)"}},null,8,["data","currentNodeKey","shareTitle"]),[[j,h.value]])])]}),default:e(()=>[r("div",wl,[r("div",bl,[r("h4",null,p(y.$t("views.tool.title")),1),l(G,{direction:"vertical"}),l(le,{modelValue:g.value,"onUpdate:modelValue":a[0]||(a[0]=V=>g.value=V),onChange:$,class:"app-radio-button-group"},{default:e(()=>[l(H,{value:"CUSTOM"},{default:e(()=>[T(p(y.$t("views.tool.title")),1)]),_:1}),l(H,{value:"MCP"},{default:e(()=>a[5]||(a[5]=[T("MCP",-1)])),_:1,__:[5]})]),_:1},8,["modelValue"]),l(ae,{modelValue:c.value,"onUpdate:modelValue":a[1]||(a[1]=V=>c.value=V),placeholder:y.$t("common.search"),"prefix-icon":"Search",class:"w-240 mr-8",clearable:""},null,8,["modelValue","placeholder"])]),l(s,null,{default:e(()=>[r("div",kl,[m.value.length?ue((w(),D(te,{key:0,gutter:12},{default:e(()=>[(w(!0),ee(we,null,$e(m.value,(V,X)=>(w(),D(U,{span:8,key:X,class:"mb-16"},{default:e(()=>[l(Se,{"value-field":"id",data:V,modelValue:d.value,"onUpdate:modelValue":a[2]||(a[2]=ve=>d.value=ve),onChange:L},{icon:e(()=>[V!=null&&V.icon?(w(),D(I,{key:0,shape:"square",size:32,style:{background:"none"},class:"mr-8"},{default:e(()=>[r("img",{src:Ie(Pe)(V==null?void 0:V.icon),alt:""},null,8,$l)]),_:2},1024)):(w(),D(Q,{key:1,size:32,type:V==null?void 0:V.toolType},null,8,["type"]))]),default:e(()=>[r("span",{class:"ellipsis cursor ml-12",title:V.name},p(V.name),9,Vl)]),_:2},1032,["data","modelValue"])]),_:2},1024))),128))]),_:1})),[[j,F.value]]):(w(),D(ie,{key:1,description:y.$t("common.noData")},null,8,["description"]))])]),_:1})])]),_:1})]),_:1},8,["modelValue"])}}}),Tl={class:"flex-between mb-8"},Rl={class:"flex"},Dl=["id"],Il={class:"layout-bg"},Pl={class:"flex-between p-16 ml-8"},Ml={class:"p-16-24 pt-0",style:{height:"calc(100vh - 200px)"}},xl=["src"],Ul=["title"],Ll={class:"flex-between"},Al={class:"flex"},oa=de({__name:"ApplicationDialog",emits:["refresh"],setup(se,{expose:E,emit:B}){const q=me(),A=B,{folder:x,user:P}=ye(),N=Z(()=>q.path.includes("shared")?"systemShare":q.path.includes("resource-management")?"systemManage":"workspace"),i=n(!1),d=n([]),c=n(""),m=n([]),v=n([]),g=n(!1);ne(i,S=>{S||(d.value=[],c.value="",m.value=[],v.value=[])}),ne(c,S=>{S?m.value=v.value.filter(C=>C.name.includes(S)):m.value=v.value});function F(){}function L(){d.value=[]}const z=S=>{d.value=S||[],b(),i.value=!0},o=()=>{A("refresh",{applicationIds:d.value}),i.value=!1},u=()=>{c.value="",v.value=[],h()},_=n([]),$=n({}),k=n(!1);function b(){const S={};x.asyncGetFolder("APPLICATION",S,N.value,k).then(C=>{var O;_.value=C.data,$.value=((O=C.data)==null?void 0:O[0])||{},h()})}function h(){var C;const S=((C=$.value)==null?void 0:C.id)||P.getWorkspaceId();ce({type:"application",isShared:S==="share",systemType:"workspace"}).getAllApplication({folderId:S}).then(O=>{var y,a;v.value=O.data,v.value=(y=v.value)==null?void 0:y.filter(f=>f.isPublish&&f.id!==q.params.id),m.value=O.data,m.value=(a=m.value)==null?void 0:a.filter(f=>f.isPublish&&f.id!==q.params.id)})}return E({open:z}),(S,C)=>{const O=t("Refresh"),y=t("el-icon"),a=t("el-button"),f=t("el-input"),M=t("el-avatar"),K=t("el-col"),G=t("el-row"),H=t("el-empty"),le=t("el-scrollbar"),ae=t("el-text"),I=t("el-dialog"),Q=he("loading");return w(),D(I,{modelValue:i.value,"onUpdate:modelValue":C[3]||(C[3]=U=>i.value=U),width:"1000","append-to-body":"",class:"addTool-dialog","align-center":"","close-on-click-modal":!1,"close-on-press-escape":!1},{header:e(({titleId:U,titleClass:te})=>[r("div",Tl,[r("div",Rl,[r("h4",{id:U,class:pe([te,"mr-8"])},p(S.$t("views.application.settingApplication")),11,Dl)]),l(a,{link:"",class:"mr-24",onClick:u},{default:e(()=>[l(y,{size:18},{default:e(()=>[l(O)]),_:1})]),_:1})])]),footer:e(()=>[r("div",Ll,[r("div",Al,[d.value.length>0?(w(),D(ae,{key:0,type:"info",class:"color-secondary mr-8"},{default:e(()=>[T(p(S.$t("common.selected"))+" "+p(d.value.length),1)]),_:1})):J("",!0),d.value.length>0?(w(),D(a,{key:1,link:"",type:"primary",onClick:L},{default:e(()=>[T(p(S.$t("common.clear")),1)]),_:1})):J("",!0)]),r("span",null,[l(a,{onClick:C[2]||(C[2]=re(U=>i.value=!1,["prevent"]))},{default:e(()=>[T(p(S.$t("common.cancel")),1)]),_:1}),l(a,{type:"primary",onClick:o},{default:e(()=>[T(p(S.$t("common.add")),1)]),_:1})])])]),default:e(()=>[l(Ve,{showCollapse:"",class:"application-manage"},{default:e(()=>[r("div",Il,[r("div",Pl,[r("h4",null,p(S.$t("views.application.title")),1),l(f,{modelValue:c.value,"onUpdate:modelValue":C[0]||(C[0]=U=>c.value=U),placeholder:S.$t("common.search"),"prefix-icon":"Search",class:"w-240 mr-8",clearable:""},null,8,["modelValue","placeholder"])]),l(le,null,{default:e(()=>[r("div",Ml,[m.value.length?ue((w(),D(G,{key:0,gutter:12},{default:e(()=>[(w(!0),ee(we,null,$e(m.value,(U,te)=>(w(),D(K,{span:12,key:te,class:"mb-16"},{default:e(()=>[l(Se,{"value-field":"id",data:U,modelValue:d.value,"onUpdate:modelValue":C[1]||(C[1]=ie=>d.value=ie),onChange:F},{icon:e(()=>[U!=null&&U.icon?(w(),D(M,{key:0,shape:"square",size:32,style:{background:"none"},class:"mr-8"},{default:e(()=>[r("img",{src:Ie(Pe)(U==null?void 0:U.icon),alt:""},null,8,xl)]),_:2},1024)):(w(),D(qe,{key:1,size:32,type:U==null?void 0:U.toolType},null,8,["type"]))]),default:e(()=>[r("span",{class:"ellipsis cursor ml-12",title:U.name},p(U.name),9,Ul)]),_:2},1032,["data","modelValue"])]),_:2},1024))),128))]),_:1})),[[Q,g.value]]):(w(),D(H,{key:1,description:S.$t("common.noData")},null,8,["description"]))])]),_:1})])]),_:1})]),_:1},8,["modelValue"])}}}),Fl={class:"generate-prompt-dialog-bg border-r-8"},ql={class:"scrollbar-height"},Nl={class:"p-16 pb-0 lighter"},zl={key:1,shadow:"always",style:{margin:"0.5rem 0"}},Ol={key:2,class:"flex align-center"},Kl={key:0,class:"mt-8"},Hl={key:1,class:"mt-8"},El={class:"generate-prompt-operate p-16"},Bl={key:0,class:"text-center mb-8"},Wl={class:"operate-textarea"},Gl={class:"operate"},jl={class:"text-right"},Jl={src:Oe,alt:""},Ql=de({__name:"GeneratePromptDialog",emits:["replace"],setup(se,{expose:E,emit:B}){const q=B,{user:A}=ye(),x=me(),P=n([]),N=Z(()=>x.path.includes("resource-management")?"systemManage":"workspace"),i=n(""),d=n(""),c=n(""),m=n(!1),v=n(""),g=n(!1),F={INIT_TEMPLATE:`
è¯·æ ¹æ®ç”¨æˆ·æè¿°ç”Ÿæˆä¸€ä¸ªå®Œæ•´çš„AIè§’è‰²äººè®¾æ¨¡æ¿:

åº”ç”¨åç§°ï¼š{application_name}
åº”ç”¨æè¿°ï¼š{detail}
ç”¨æˆ·éœ€æ±‚ï¼š{userInput}

é‡è¦è¯´æ˜ï¼š
1. è§’è‰²è®¾å®šå¿…é¡»æœåŠ¡äº"{application_name}"åº”ç”¨çš„æ ¸å¿ƒåŠŸèƒ½
2. å…è®¸ç”¨æˆ·å¯¹è§’è‰²è®¾å®šçš„å…·ä½“å†…å®¹è¿›è¡Œè°ƒæ•´å’Œä¼˜åŒ–
3. å¦‚æœç”¨æˆ·è¦æ±‚ä¿®æ”¹æŸä¸ªæŠ€èƒ½æˆ–éƒ¨åˆ†ï¼Œåœ¨ä¿æŒåº”ç”¨ä¸»é¢˜çš„å‰æä¸‹è¿›è¡Œç›¸åº”è°ƒæ•´

è¯·æŒ‰ä»¥ä¸‹æ ¼å¼ç”Ÿæˆï¼š

å¿…é¡»ä¸¥æ ¼éµå¾ªä»¥ä¸‹è§„åˆ™ï¼š
1. **ä¸¥æ ¼ç¦æ­¢è¾“å‡ºè§£é‡Šã€å‰è¨€ã€é¢å¤–è¯´æ˜**ï¼Œåªè¾“å‡ºæœ€ç»ˆç»“æœã€‚
2. **ä¸¥æ ¼ä½¿ç”¨ä»¥ä¸‹æ ¼å¼**ï¼Œä¸èƒ½ç¼ºå°‘æ ‡é¢˜ã€ä¸èƒ½å¤šå‡ºå…¶ä»–æ®µè½ã€‚
3. **å¦‚æœç”¨æˆ·è¦æ±‚ä¿®æ”¹è§’è‰²è®¾å®šçš„æŸä¸ªéƒ¨åˆ†ï¼Œåœ¨ä¿æŒåº”ç”¨æ ¸å¿ƒåŠŸèƒ½çš„å‰æä¸‹è¿›è¡Œè°ƒæ•´**ã€‚
4. **å¦‚æœç”¨æˆ·éœ€æ±‚ä¸è§’è‰²è®¾å®šç”Ÿæˆå®Œå…¨æ— å…³ï¼ˆå¦‚é—²èŠã€å…¶ä»–è¯é¢˜ï¼‰ï¼Œåˆ™å¿½ç•¥ç”¨æˆ·éœ€æ±‚ï¼ŒåŸºäºåº”ç”¨ä¿¡æ¯ç”Ÿæˆæ ‡å‡†è§’è‰²è®¾å®š**ã€‚

# è§’è‰²:
è§’è‰²æ¦‚è¿°å’Œä¸»è¦èŒè´£çš„ä¸€å¥è¯æè¿°

## ç›®æ ‡ï¼š
è§’è‰²çš„å·¥ä½œç›®æ ‡,å¦‚æœæœ‰å¤šç›®æ ‡å¯ä»¥åˆ†ç‚¹åˆ—å‡º,ä½†å»ºè®®æ›´èšç„¦1-2ä¸ªç›®æ ‡

## æ ¸å¿ƒæŠ€èƒ½ï¼š
### æŠ€èƒ½ 1: [æŠ€èƒ½åç§°ï¼Œå¦‚ä½œå“æ¨è/ä¿¡æ¯æŸ¥è¯¢/ä¸“ä¸šåˆ†æç­‰]
1. [æ‰§è¡Œæ­¥éª¤1 - æè¿°è¯¥æŠ€èƒ½çš„ç¬¬ä¸€ä¸ªå…·ä½“æ“ä½œæ­¥éª¤ï¼ŒåŒ…æ‹¬æ¡ä»¶åˆ¤æ–­å’Œå¤„ç†æ–¹å¼]
2. [æ‰§è¡Œæ­¥éª¤2 - æè¿°è¯¥æŠ€èƒ½çš„ç¬¬äºŒä¸ªå…·ä½“æ“ä½œæ­¥éª¤ï¼ŒåŒ…æ‹¬å¦‚ä½•è·å–æˆ–å¤„ç†ä¿¡æ¯]
3. [æ‰§è¡Œæ­¥éª¤3 - æè¿°è¯¥æŠ€èƒ½çš„æœ€ç»ˆè¾“å‡ºæ­¥éª¤ï¼Œè¯´æ˜å¦‚ä½•å‘ˆç°ç»“æœ]

===å›å¤ç¤ºä¾‹===
- ğŸ“‹ [æ ‡è¯†ç¬¦]: <å…·ä½“å†…å®¹æ ¼å¼è¯´æ˜>
- ğŸ¯ [æ ‡è¯†ç¬¦]: <å…·ä½“å†…å®¹æ ¼å¼è¯´æ˜>
- ğŸ’¡ [æ ‡è¯†ç¬¦]: <å…·ä½“å†…å®¹æ ¼å¼è¯´æ˜>
===ç¤ºä¾‹ç»“æŸ===

### æŠ€èƒ½ 2: [æŠ€èƒ½åç§°]
1. [æ‰§è¡Œæ­¥éª¤1 - æè¿°è§¦å‘æ¡ä»¶å’Œåˆå§‹å¤„ç†æ–¹å¼]
2. [æ‰§è¡Œæ­¥éª¤2 - æè¿°ä¿¡æ¯è·å–å’Œæ·±åŒ–å¤„ç†çš„å…·ä½“æ–¹æ³•]
3. [æ‰§è¡Œæ­¥éª¤3 - æè¿°æœ€ç»ˆè¾“å‡ºçš„å…·ä½“è¦æ±‚å’Œæ ¼å¼]

### æŠ€èƒ½ 3: [æŠ€èƒ½åç§°]
- [æ ¸å¿ƒèƒ½åŠ›æè¿° - è¯´æ˜è¯¥æŠ€èƒ½çš„ä¸»è¦ä½œç”¨å’ŒçŸ¥è¯†åŸºç¡€]
- [åº”ç”¨æ–¹æ³• - æè¿°å¦‚ä½•è¿ç”¨è¯¥æŠ€èƒ½ä¸ºç”¨æˆ·æä¾›æœåŠ¡ï¼ŒåŒ…æ‹¬å…·ä½“çš„å®æ–½æ–¹å¼]

## å·¥ä½œæµï¼š
1. æè¿°è§’è‰²å·¥ä½œæµç¨‹çš„ç¬¬ä¸€æ­¥
2. æè¿°è§’è‰²å·¥ä½œæµç¨‹çš„ç¬¬äºŒæ­¥
3. æè¿°è§’è‰²å·¥ä½œæµç¨‹çš„ç¬¬ä¸‰æ­¥

## è¾“å‡ºæ ¼å¼ï¼š
å¦‚æœå¯¹è§’è‰²çš„è¾“å‡ºæ ¼å¼æœ‰ç‰¹å®šè¦æ±‚ï¼Œå¯ä»¥åœ¨è¿™é‡Œå¼ºè°ƒå¹¶ä¸¾ä¾‹è¯´æ˜æƒ³è¦çš„è¾“å‡ºæ ¼å¼


## é™åˆ¶ï¼š
1. **ä¸¥æ ¼é™åˆ¶å›ç­”èŒƒå›´**ï¼šä»…å›ç­”ä¸è§’è‰²è®¾å®šç›¸å…³çš„é—®é¢˜ã€‚
   - å¦‚æœç”¨æˆ·æé—®ä¸è§’è‰²æ— å…³ï¼Œå¿…é¡»ä½¿ç”¨ä»¥ä¸‹å›ºå®šæ ¼å¼å›å¤ï¼š
     â€œå¯¹ä¸èµ·ï¼Œæˆ‘åªèƒ½å›ç­”ä¸[è§’è‰²è®¾å®š]ç›¸å…³çš„é—®é¢˜ï¼Œæ‚¨çš„é—®é¢˜ä¸åœ¨æœåŠ¡èŒƒå›´å†…ã€‚â€
   - ä¸å¾—æä¾›ä»»ä½•ä¸è§’è‰²è®¾å®šæ— å…³çš„å›ç­”ã€‚
2. æè¿°è§’è‰²åœ¨äº’åŠ¨è¿‡ç¨‹ä¸­éœ€è¦éµå¾ªçš„é™åˆ¶æ¡ä»¶2
3. æè¿°è§’è‰²åœ¨äº’åŠ¨è¿‡ç¨‹ä¸­éœ€è¦éµå¾ªçš„é™åˆ¶æ¡ä»¶3

è¾“å‡ºæ—¶ä¸å¾—åŒ…å«ä»»ä½•è§£é‡Šæˆ–é™„åŠ è¯´æ˜ï¼Œåªèƒ½è¿”å›ç¬¦åˆä»¥ä¸Šæ ¼å¼çš„å†…å®¹ã€‚
  `},L=n(!1),z=n(!1),o=n(""),u=n(0);let _=null;const $=n(!1),k=()=>{_&&clearInterval(_),L.value=!0,z.value=!1,_=setInterval(()=>{if(y.value&&!z.value){const s=P.value[P.value.length-1];s&&s.role==="ai"&&(s.content=o.value),b();return}if(!z.value&&u.value<o.value.length){const s=Math.min(3,o.value.length-u.value);u.value+=s;const R=P.value[P.value.length-1];R&&R.role==="ai"&&(R.content=o.value.substring(0,u.value))}else g.value===!1&&u.value>=o.value.length&&b()},50)},b=()=>{_&&(clearInterval(_),_=null),L.value=!1,z.value=!1,g.value=!1,$.value=!0},h=Z(()=>L.value),S=()=>{z.value=!0,L.value=!1},C=()=>{u.value<o.value.length&&k()},O=s=>{let R="";const W=Re({content:"",role:"ai"});P.value.push(W),o.value="",u.value=0,$.value=!1;let j=!1;const V=({done:X,value:ve})=>{try{if(X){g.value=!1,y.value=!0;return}let Y=new TextDecoder("utf-8").decode(ve,{stream:!0});R+=Y;const fe=R.match(/data:.*}\n\n/g);if(fe)Y=fe.join(""),R=R.replace(Y,"");else return s.read().then(V);if(Y&&Y.startsWith("data:")&&fe)for(const Me in fe){const be=JSON==null?void 0:JSON.parse(fe[Me].replace("data:",""));if(be.isEnd||(o.value+=be.content,j||(j=!0,k())),be.isEnd)return Promise.resolve()}}catch(_e){return g.value=!1,b(),Promise.reject(_e)}return s.read().then(V)};return V},y=n(!1),a=Z(()=>{const s=P.value[P.value.length-1];return s&&s.role=="ai"?s.content:""}),f=Z(()=>!L.value&&z.value&&u.value<o.value.length);function M(s){y.value=!1,g.value=!0;const R=A.getWorkspaceId()||"default";P.value.push({content:s,role:"user"});const W={messages:P.value,prompt:F.INIT_TEMPLATE};N.value==="workspace"?He.generate_prompt(R,d.value,c.value,W).then(j=>{ke(()=>{Q.value&&I.value.setScrollTop(U())});const V=j.body.getReader();V.read().then(O(V))}):N.value==="systemManage"&&Ee.generate_prompt(c.value,d.value,W).then(j=>{ke(()=>{Q.value&&I.value.setScrollTop(U())});const V=j.body.getReader();V.read().then(O(V))})}const K=()=>{i.value&&M("ç»“æœä¸æ»¡æ„,è¯·æŒ‰ç…§æ ¼å¼,é‡æ–°ç”Ÿæˆ")},G=n(),H=s=>{if(!(s!=null&&s.ctrlKey)&&!(s!=null&&s.shiftKey)&&!(s!=null&&s.altKey)&&!(s!=null&&s.metaKey)){if(s==null||s.preventDefault(),!v.value.trim()||g.value||L.value||(i.value||(i.value=v.value),z.value||L.value))return;v.value&&(M(v.value),v.value="")}else le(s)},le=s=>{const R=G.value.$el.querySelector(".el-textarea__inner"),W=R.selectionStart,j=R.selectionEnd;s.preventDefault(),v.value=v.value.slice(0,W)+`
`+v.value.slice(j),ke(()=>{R.setSelectionRange(W+1,W+1)})},ae=(s,R)=>{d.value=s,c.value=R,m.value=!0,i.value="",P.value=[]},I=n(),Q=n(),U=()=>Q.value.scrollHeight,te=()=>{var s;I.value&&I.value.wrapRef.offsetHeight<((s=Q.value)==null?void 0:s.scrollHeight)&&I.value.setScrollTop(U())},ie=s=>{a.value?Be(oe("common.tip"),oe("views.application.generateDialog.exit"),{confirmButtonText:oe("common.confirm"),cancelButtonText:oe("common.cancel"),distinguishCancelAndClose:!0}).then(()=>{b(),P.value=[],o.value="",u.value=0,$.value=!1,s()}).catch(()=>{}):s()};return Ne(()=>{b()}),ne(a,()=>{te()},{deep:!0,immediate:!0}),E({open:ae}),(s,R)=>{const W=t("Loading"),j=t("el-icon"),V=t("el-scrollbar"),X=t("el-button"),ve=t("el-input"),_e=t("el-dialog");return w(),D(_e,{"align-center":"",title:s.$t("views.application.generateDialog.generatePrompt"),modelValue:m.value,"onUpdate:modelValue":R[3]||(R[3]=Y=>m.value=Y),style:{width:"600px"},"append-to-body":"","close-on-click-modal":!0,"close-on-press-escape":!0,"before-close":ie},{default:e(()=>[r("div",Fl,[r("div",ql,[r("div",Nl,[l(V,{ref_key:"scrollDiv",ref:I},{default:e(()=>[a.value?(w(),ee("div",{key:0,ref_key:"dialogScrollbar",ref:Q,class:"pre-wrap lighter",style:{"max-height":"calc(100vh - 400px)"}},p(a.value),513)):g.value?(w(),ee("p",zl,[l(j,{class:"is-loading color-primary mr-4"},{default:e(()=>[l(W)]),_:1}),T(" "+p(s.$t("views.application.generateDialog.loading"))+" ",1),R[4]||(R[4]=r("span",{class:"dotting"},null,-1))])):(w(),ee("p",Ol,[l(ge,{iconName:"app-generate-star",class:"color-primary mr-4"}),T(" "+p(s.$t("views.application.generateDialog.title")),1)]))]),_:1},512),a.value&&!g.value&&!L.value&&!f.value?(w(),ee("div",Kl,[l(X,{type:"primary",onClick:R[0]||(R[0]=()=>q("replace",a.value))},{default:e(()=>[T(p(s.$t("views.application.generateDialog.replace")),1)]),_:1}),l(X,{onClick:K,disabled:!a.value||g.value,loading:g.value},{default:e(()=>[T(p(s.$t("views.application.generateDialog.remake")),1)]),_:1},8,["disabled","loading"])])):(w(),ee("div",Hl,[f.value?(w(),D(X,{key:0,type:"primary",onClick:C,link:""},{default:e(()=>[T(p(s.$t("views.application.generateDialog.continue")),1)]),_:1})):J("",!0)]))]),r("div",El,[h.value?(w(),ee("div",Bl,[l(X,{class:"border-primary video-stop-button",onClick:S},{default:e(()=>[l(ge,{iconName:"app-video-stop",class:"mr-8"}),T(" "+p(s.$t("views.application.generateDialog.stop")),1)]),_:1})])):J("",!0),r("div",Wl,[l(ve,{ref_key:"quickInputRef",ref:G,modelValue:v.value,"onUpdate:modelValue":R[1]||(R[1]=Y=>v.value=Y),autosize:{minRows:1,maxRows:10},type:"textarea",placeholder:s.$t("views.application.generateDialog.placeholder"),maxlength:1e5,class:"chat-operate-textarea",onKeydown:R[2]||(R[2]=ze(Y=>H(Y),["enter"]))},null,8,["modelValue","placeholder"]),r("div",Gl,[r("div",jl,[l(X,{text:"",class:"sent-button",disabled:!v.value.trim()||g.value||L.value,onClick:H},{default:e(()=>[ue(r("img",Jl,null,512),[[Ce,!v.value.trim()||g.value||L.value]]),ue(l(Ke,null,null,512),[[Ce,v.value.trim()&&!g.value&&!L.value]])]),_:1},8,["disabled"])])])])])])])]),_:1},8,["title","modelValue"])}}}),na=We(Ql,[["__scopeId","data-v-2168fa76"]]);export{na as G,Yl as _,la as a,Zl as b,ea as c,aa as d,ta as e,oa as f};

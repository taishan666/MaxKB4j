import{ec as N,ek as T,el as O,ed as h,aJ as M,aP as R,aR as x,cE as m,cF as B,aT as F,aS as u,cI as t,aX as n,cO as A,aN as U,cN as P,aO as L,c_ as j,dx as z,d5 as J,aM as X}from"./admin-BcxOdjvc.js";const d="/system/api_key",q=()=>h(`${d}`),E=i=>O(`${d}`,{},void 0,i),G=(i,c)=>T(`${d}/${i}`,void 0,void 0,c),H=(i,c,f)=>N(`${d}/${i}`,c,void 0,f),Q={getAPIKey:q,postAPIKey:E,delAPIKey:G,putAPIKey:H},W={class:"dialog-footer"},Z=M({__name:"SettingAPIKeyDialog",emits:["refresh"],setup(i,{expose:c,emit:f}){const D=R(),{params:{id:V}}=D,$=x(()=>D.path.includes("resource-management")?"systemManage":"workspace"),K=f,_=m(),s=m({allowCrossDomain:!1,crossDomainList:""}),r=m(!1),v=m(!1),y=m(""),w=m("APPLICATION");B(r,o=>{o||(s.value={allowCrossDomain:!1,crossDomainList:""})});const k=(o,e)=>{var p,a;y.value=o.id,w.value=e,s.value.allowCrossDomain=o.allowCrossDomain,s.value.crossDomainList=(p=o.crossDomainList)!=null&&p.length?(a=o.crossDomainList)==null?void 0:a.join(`
`):"",r.value=!0},b=async o=>{o&&await o.validate((e,p)=>{if(e){const a={allowCrossDomain:s.value.allowCrossDomain,crossDomainList:s.value.crossDomainList?s.value.crossDomainList.split(`
`).filter(function(g){return g!==""}):[]};(w.value==="APPLICATION"?j({type:"applicationKey",systemType:$.value}).putAPIKey(V,y.value,a,v):Q.putAPIKey(y.value,a,v)).then(()=>{K("refresh"),z(J("common.settingSuccess")),r.value=!1})}})};return c({open:k}),(o,e)=>{const p=u("el-switch"),a=u("el-form-item"),C=u("el-input"),g=u("el-form"),I=u("el-button"),S=u("el-dialog");return X(),F(S,{title:o.$t("common.setting"),modelValue:r.value,"onUpdate:modelValue":e[5]||(e[5]=l=>r.value=l),"close-on-click-modal":!1,"close-on-press-escape":!1},{footer:t(()=>[U("span",W,[n(I,{onClick:e[3]||(e[3]=A(l=>r.value=!1,["prevent"]))},{default:t(()=>[P(L(o.$t("common.cancel")),1)]),_:1}),n(I,{type:"primary",onClick:e[4]||(e[4]=l=>b(_.value)),loading:v.value},{default:t(()=>[P(L(o.$t("common.save")),1)]),_:1},8,["loading"])])]),default:t(()=>[n(g,{"label-position":"top",ref_key:"settingFormRef",ref:_,model:s.value},{default:t(()=>[n(a,{label:o.$t("views.applicationOverview.appInfo.SettingAPIKeyDialog.allowCrossDomainLabel"),onClick:e[1]||(e[1]=A(()=>{},["prevent"]))},{default:t(()=>[n(p,{size:"small",modelValue:s.value.allowCrossDomain,"onUpdate:modelValue":e[0]||(e[0]=l=>s.value.allowCrossDomain=l)},null,8,["modelValue"])]),_:1},8,["label"]),n(a,null,{default:t(()=>[n(C,{modelValue:s.value.crossDomainList,"onUpdate:modelValue":e[2]||(e[2]=l=>s.value.crossDomainList=l),placeholder:o.$t("views.applicationOverview.appInfo.SettingAPIKeyDialog.crossDomainPlaceholder"),rows:10,type:"textarea"},null,8,["modelValue","placeholder"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])}}});export{Z as _,Q as s};

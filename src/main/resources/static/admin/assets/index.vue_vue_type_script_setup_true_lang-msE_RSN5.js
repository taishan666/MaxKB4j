import{eb as fe,ec as ve,aJ as F,aQ as Z,aR as ne,cE as E,cF as de,d5 as P,aS as a,d0 as se,aT as y,aM as c,aW as Y,cI as o,cU as ae,aN as n,aL as W,aU as k,aO as s,cN as R,aV as e,ed as le,aX as t,ee as ye,aP as pe,d3 as ie,cO as q,dI as ge,d6 as he,dx as ce,aK as _e,cT as be,cG as J,dX as re,dL as B,dM as X,dN as b,dP as Q,dO as H,cH as Ae,ef as we,cP as ee,eg as ke,eh as Ie,ei as $e,cX as Ce}from"./admin-B6VfIzX8.js";import{_ as Ee}from"./ResetPassword.vue_vue_type_script_setup_true_lang-D-H1Y1vM.js";import{_ as Re,s as j}from"./SettingAPIKeyDialog.vue_vue_type_script_setup_true_lang-DGn1FZlI.js";const me="/license",xe=M=>ve(`${me}/profile`,void 0,M),Ne=(M,l)=>fe(`${me}/profile`,M,void 0,l),ue={getLicense:xe,putLicense:Ne},Pe=["id"],Se={class:"about-ui"},De={class:"flex"},Ke={class:"label"},Oe={class:"flex"},Te={class:"label"},Me={key:0,class:"color-danger"},Ue={class:"flex"},Le={class:"label"},Ve={class:"flex"},We={class:"label"},Ge={class:"flex"},ze={class:"label"},Be={class:"flex"},Fe={class:"label"},Xe={key:0,class:"mt-16 flex align-center"},He={class:"border-t text-center mt-16 p-16 pb-0"},je=F({__name:"AboutDialog",setup(M,{expose:l}){const{user:d,theme:p}=Z(),h=ne(()=>p.isDefaultTheme()),f=E(!1),g=E(!1),_=E(null),A=E(!1);de(f,r=>{r||(A.value&&window.location.reload(),A.value=!1)});const S=()=>{d.showXpack()&&u(),f.value=!0},L=r=>{const I=new FormData;I.append("license_file",r.raw),ue.putLicense(I,g).then(D=>{u(),A.value=!0})},w=ne(()=>d?d.getEditionName()==="PE"?P("layout.about.edition.professional"):d.getEditionName()==="EE"?P("layout.about.edition.enterprise"):P("layout.about.edition.community"):"-");function u(){ue.getLicense(g).then(r=>{var I;_.value=(I=r.data)==null?void 0:I.license})}return l({open:S}),(r,I)=>{const D=a("LogoFull"),G=a("el-button"),i=a("el-upload"),m=a("el-text"),U=a("el-dialog"),K=se("hasPermission"),x=se("loading");return c(),y(U,{modelValue:f.value,"onUpdate:modelValue":I[0]||(I[0]=N=>f.value=N),class:Y(["about-dialog border-r-6",h.value?"":"dialog-custom-header"])},{header:o(({titleId:N,titleClass:$})=>[n("div",{class:Y(["logo flex-center",$]),id:N},[t(D,{height:"59px"})],10,Pe)]),default:o(()=>{var N,$,O,V,z,C,v;return[ae((c(),W("div",Se,[n("div",De,[n("span",Ke,s(r.$t("layout.about.authorize")),1),n("span",null,s(((N=_.value)==null?void 0:N.corporation)||"-"),1)]),n("div",Oe,[n("span",Te,s(r.$t("layout.about.expiredTime")),1),n("span",null,[R(s((($=_.value)==null?void 0:$.expired)||"-")+" ",1),(O=_.value)!=null&&O.expired&&e(le)((V=_.value)==null?void 0:V.expired)?(c(),W("span",Me,"（"+s(e(le)((z=_.value)==null?void 0:z.expired))+"）",1)):k("",!0)])]),n("div",Ue,[n("span",Le,s(r.$t("layout.about.edition.label")),1),n("span",null,s(w.value),1)]),n("div",Ve,[n("span",We,s(r.$t("layout.about.version")),1),n("span",null,s(e(d).version),1)]),n("div",Ge,[n("span",ze,s(r.$t("layout.about.serialNo")),1),n("span",null,s(((C=_.value)==null?void 0:C.serialNo)||"-"),1)]),n("div",Be,[n("span",Fe,s(r.$t("layout.about.remark")),1),n("span",null,s(((v=_.value)==null?void 0:v.remark)||"-"),1)]),e(d).showXpack()?(c(),W("div",Xe,[ae((c(),y(i,{ref:"uploadRef",action:"#","auto-upload":!1,"show-file-list":!1,"on-change":L},{default:o(()=>[t(G,{class:"border-primary mr-16"},{default:o(()=>[R(s(r.$t("layout.about.update"))+" License ",1)]),_:1})]),_:1})),[[K,new(e(ye))("ADMIN")]])])):k("",!0)])),[[x,g.value]]),n("div",He,[t(m,{type:"info"},{default:o(()=>[R(s(r.$t("layout.copyright")),1)]),_:1})])]}),_:1},8,["modelValue","class"])}}}),Ye={style:{"margin-top":"10px"}},Je={class:"vertical-middle lighter break-all"},Qe={class:"mr-4"},qe=F({__name:"APIKeyDialog",props:{userId:{type:String,default:""}},emits:["addData"],setup(M,{expose:l,emit:d}){const p=pe(),{params:{id:h}}=p,f=window.location.origin+"/doc/",g=E(),_=E(!1),A=E(!1),S=E(null);de(_,i=>{i||(S.value=null)});function L(i){g.value.open(i,"USER")}function w(i){he(`${P("views.applicationOverview.appInfo.APIKeyDialog.msgConfirm1")}: ${i.secretKey}?`,P(P("views.applicationOverview.appInfo.APIKeyDialog.msgConfirm2")),{confirmButtonText:P("common.confirm"),cancelButtonText:P("common.cancel"),confirmButtonClass:"color-danger"}).then(()=>{j.delAPIKey(i.id,A).then(()=>{ce(P("common.deleteSuccess")),D()})}).catch(()=>{})}function u(i,m){const U={isActive:i},K=i?P("views.applicationOverview.appInfo.APIKeyDialog.enabledSuccess"):P("views.applicationOverview.appInfo.APIKeyDialog.disabledSuccess");j.putAPIKey(m.id,U,A).then(x=>{ce(K),D()})}function r(){j.postAPIKey(A).then(i=>{D()})}const I=()=>{D(),_.value=!0};function D(){j.getAPIKey().then(i=>{i.data.sort((m,U)=>m.name<U.name?1:-1),S.value=i.data})}function G(){D()}return l({open:I}),(i,m)=>{const U=a("el-text"),K=a("AppIcon"),x=a("el-button"),N=a("el-card"),$=a("el-table-column"),O=a("el-switch"),V=a("el-tooltip"),z=a("el-table"),C=a("el-dialog");return c(),y(C,{title:i.$t("layout.apiKey"),modelValue:_.value,"onUpdate:modelValue":m[2]||(m[2]=v=>_.value=v),width:"800","close-on-click-modal":!1,"close-on-press-escape":!1},{default:o(()=>[t(N,{shadow:"never",class:"layout-bg mb-16"},{default:o(()=>[t(U,{type:"info",class:"color-secondary"},{default:o(()=>[R(s(i.$t("layout.apiServiceAddress")),1)]),_:1}),n("p",Ye,[n("span",{class:"vertical-middle lighter break-all"},s(f)),t(x,{type:"primary",text:"",onClick:m[0]||(m[0]=v=>e(ie)(f))},{default:o(()=>[t(K,{iconName:"app-copy"})]),_:1})])]),_:1}),t(x,{type:"primary",class:"mb-16",onClick:r},{default:o(()=>[R(s(i.$t("common.create")),1)]),_:1}),t(z,{data:S.value,class:"mb-16",loading:A.value},{default:o(()=>[t($,{prop:"secretKey",label:"API Key"},{default:o(({row:v})=>[n("span",Je,s(v.secretKey),1),t(x,{type:"primary",text:"",onClick:T=>e(ie)(v.secretKey)},{default:o(()=>[t(K,{iconName:"app-copy"})]),_:2},1032,["onClick"])]),_:1}),t($,{label:i.$t("common.status.label"),width:"80"},{default:o(({row:v})=>[n("div",{onClick:m[1]||(m[1]=q(()=>{},["stop"]))},[t(O,{size:"small",modelValue:v.isActive,"onUpdate:modelValue":T=>v.isActive=T,onChange:T=>u(T,v)},null,8,["modelValue","onUpdate:modelValue","onChange"])])]),_:1},8,["label"]),t($,{prop:"name",label:i.$t("common.createDate"),width:"170"},{default:o(({row:v})=>[R(s(e(ge)(v.createTime)),1)]),_:1},8,["label"]),t($,{label:i.$t("common.setting"),align:"left",width:"80"},{default:o(({row:v})=>[n("span",Qe,[t(V,{effect:"dark",content:i.$t("common.setting"),placement:"top"},{default:o(()=>[t(x,{type:"primary",text:"",onClick:q(T=>L(v),["stop"])},{default:o(()=>[t(K,{iconName:"app-setting"})]),_:2},1032,["onClick"])]),_:2},1032,["content"])]),t(V,{effect:"dark",content:i.$t("common.delete"),placement:"top"},{default:o(()=>[t(x,{type:"primary",text:"",onClick:T=>w(v)},{default:o(()=>[t(K,{iconName:"app-delete"})]),_:2},1032,["onClick"])]),_:2},1032,["content"])]),_:1},8,["label"])]),_:1},8,["data","loading"]),t(Re,{ref_key:"SettingAPIKeyDialogRef",ref:g,onRefresh:G},null,512)]),_:1},8,["title","modelValue"])}}}),Ze={class:"flex-center cursor"},et={class:"ml-8 color-text-primary"},tt={class:"userInfo flex align-center"},ot={class:"mr-12 flex align-center"},nt={style:{width:"90%"}},st={class:"bold mb-4",style:{"font-size":"14px"}},at={class:"flex-between w-full"},lt={class:"flex-between w-full",style:{"line-height":"22px",padding:"12px 11px"}},it=F({__name:"index",setup(M){const{user:l,login:d}=Z(),p=_e(),h=E(),f=E(),g=E(),_=u=>{l.postUserLanguage(u)},A=()=>{var u;(u=h.value)==null||u.open()};function S(){f.value.open()}const L=()=>{var u;(u=g.value)==null||u.open()},w=()=>{d.logout().then(()=>{p.push({name:"login"})})};return be(()=>{var u;(u=l.userInfo)!=null&&u.is_edit_password}),(u,r)=>{var $;const I=a("el-avatar"),D=a("CaretBottom"),G=a("el-icon"),i=a("TagGroup"),m=a("el-dropdown-item"),U=a("ArrowRight"),K=a("Check"),x=a("el-dropdown-menu"),N=a("el-dropdown");return c(),W(J,null,[t(N,{trigger:"click",type:"primary"},{dropdown:o(()=>[t(x,{class:"avatar-dropdown"},{default:o(()=>{var O,V,z;return[n("div",tt,[n("div",ot,[t(I,{size:30},{default:o(()=>r[3]||(r[3]=[n("img",{src:re,style:{width:"54%"},alt:""},null,-1)])),_:1,__:[3]})]),n("div",nt,[n("p",st,s((O=e(l).userInfo)==null?void 0:O.username),1),(V=e(l).userInfo)!=null&&V.role_name&&e(l).userInfo.role_name.length>0?(c(),W(J,{key:0},[e(B)([e(X).IS_EE,e(X).IS_PE],"OR")?(c(),y(i,{key:0,size:"small",tags:(z=e(l).userInfo)==null?void 0:z.role_name},null,8,["tags"])):k("",!0)],64)):k("",!0)])]),e(B)([e(b).EXTENDS_ADMIN,e(b).EXTENDS_WORKSPACE_MANAGE,e(b).ADMIN,e(b).WORKSPACE_MANAGE],"OR")?(c(),y(m,{key:0,class:"border-t",onClick:r[0]||(r[0]=C=>e(p).push({path:"/system/user"}))},{default:o(()=>[n("div",at,s(u.$t("views.system.title")),1)]),_:1})):k("",!0),e(B)(new(e(Q))([e(b).ADMIN,e(b).WORKSPACE_MANAGE,e(b).USER],[e(H).CHANGE_PASSWORD],[],"OR"),"OR")?(c(),y(m,{key:1,onClick:L},{default:o(()=>[R(s(u.$t("views.login.resetPassword")),1)]),_:1})):k("",!0),n("div",null,[e(B)(new(e(Q))([e(b).ADMIN],[e(H).SYSTEM_API_KEY_EDIT],[e(X).IS_EE,e(X).IS_PE],"OR"),"OR")?(c(),y(m,{key:0,class:"p-8",onClick:S},{default:o(()=>[R(s(u.$t("layout.apiKey")),1)]),_:1})):k("",!0)]),e(B)(new(e(Q))([e(b).ADMIN,e(b).WORKSPACE_MANAGE,e(b).USER],[e(H).SWITCH_LANGUAGE],[],"OR"),"OR")?(c(),y(m,{key:2,style:{padding:"0"},onClick:r[1]||(r[1]=q(()=>{},["stop"]))},{default:o(()=>[t(N,{class:"w-full",trigger:"hover",placement:"left-start"},{dropdown:o(()=>[t(x,{style:{width:"180px"}},{default:o(()=>[(c(!0),W(J,null,Ae(e(we),(C,v)=>(c(),y(m,{key:v,value:C.value,onClick:T=>_(C.value),class:"flex-between"},{default:o(()=>{var T,te,oe;return[n("span",{class:Y(C.value===((T=e(l).userInfo)==null?void 0:T.language)?"primary":"")},s(C.label),3),C.value===((te=e(l).userInfo)==null?void 0:te.language)?(c(),y(G,{key:0,class:Y(C.value===((oe=e(l).userInfo)==null?void 0:oe.language)?"primary":"")},{default:o(()=>[t(K)]),_:2},1032,["class"])):k("",!0)]}),_:2},1032,["value","onClick"]))),128))]),_:1})]),default:o(()=>[n("div",lt,[n("span",null,s(u.$t("layout.language")),1),t(G,null,{default:o(()=>[t(U)]),_:1})])]),_:1})]),_:1})):k("",!0),e(B)([e(b).ADMIN,e(H).ABOUT_READ],"OR")?(c(),y(m,{key:3,onClick:A},{default:o(()=>[R(s(u.$t("layout.about.title")),1)]),_:1})):k("",!0),t(m,{class:"border-t",onClick:w},{default:o(()=>[R(s(u.$t("layout.logout")),1)]),_:1})]}),_:1})]),default:o(()=>{var O;return[n("div",Ze,[t(I,{size:30},{default:o(()=>r[2]||(r[2]=[n("img",{src:re,style:{width:"54%"},alt:""},null,-1)])),_:1,__:[2]}),n("span",et,s((O=e(l).userInfo)==null?void 0:O.username),1),t(G,{class:"el-icon--right"},{default:o(()=>[t(D)]),_:1})])]}),_:1}),t(qe,{"user-id":($=e(l).userInfo)==null?void 0:$.id,ref_key:"APIKeyDialogRef",ref:f},null,8,["user-id"]),t(Ee,{ref_key:"resetPasswordRef",ref:g},null,512),t(je,{ref_key:"AboutDialogRef",ref:h},null,512)],64)}}}),ct=ee(it,[["__scopeId","data-v-3bf01337"]]),rt={class:"flex align-center"},ut=F({__name:"index",setup(M){const{theme:l}=Z();function d(p){window.open(p,"_blank")}return(p,h)=>{var _,A,S;const f=a("AppIcon"),g=a("el-tooltip");return c(),W("div",rt,[(_=e(l).themeInfo)!=null&&_.showProject?(c(),y(g,{key:0,effect:"dark",content:p.$t("layout.github"),placement:"top"},{default:o(()=>[t(f,{iconName:"app-github",class:"cursor color-secondary mr-8 ml-8",style:{"font-size":"20px"},onClick:h[0]||(h[0]=L=>{var w;return d((w=e(l).themeInfo)==null?void 0:w.projectUrl)})})]),_:1},8,["content"])):k("",!0),(A=e(l).themeInfo)!=null&&A.showUserManual?(c(),y(g,{key:1,effect:"dark",content:p.$t("layout.wiki"),placement:"top"},{default:o(()=>[t(f,{iconName:"app-user-manual",class:"cursor color-secondary mr-8 ml-8",style:{"font-size":"20px"},onClick:h[1]||(h[1]=L=>{var w;return d((w=e(l).themeInfo)==null?void 0:w.userManualUrl)})})]),_:1},8,["content"])):k("",!0),(S=e(l).themeInfo)!=null&&S.showForum?(c(),y(g,{key:2,effect:"dark",content:p.$t("layout.forum"),placement:"top"},{default:o(()=>[t(f,{iconName:"app-help",class:"cursor color-secondary mr-8 ml-8",style:{"font-size":"20px"},onClick:h[2]||(h[2]=L=>{var w;return d((w=e(l).themeInfo)==null?void 0:w.forumUrl)})})]),_:1},8,["content"])):k("",!0)])}}}),dt=ee(ut,[["__scopeId","data-v-24d0eacb"]]),pt={class:"app-top-bar-container border-b flex-center"},_t={class:"logo mt-4"},mt={class:"flex-between w-full align-center"},ft={class:"flex align-center mr-8"},vt=F({__name:"SystemHeader",setup(M){const l=_e();return(d,p)=>{const h=a("LogoFull"),f=a("el-divider"),g=a("AppIcon"),_=a("el-button");return c(),W("div",pt,[n("div",_t,[t(h)]),n("div",mt,[n("h4",null,[t(f,{class:"ml-16 mr-16",direction:"vertical"}),R(s(d.$t("views.system.title")),1)]),n("div",ft,[t(dt),t(f,{class:"ml-8 mr-8",direction:"vertical"}),e(B)([e(b).USER.getWorkspaceRole,e(b).EXTENDS_USER.getWorkspaceRole,e(b).EXTENDS_WORKSPACE_MANAGE.getWorkspaceRole,e(b).WORKSPACE_MANAGE.getWorkspaceRole],"OR")?(c(),y(_,{key:0,link:"",onClick:p[0]||(p[0]=A=>e(l).push({path:"/"})),style:{color:"var(--el-text-color-primary)"}},{default:o(()=>[t(g,{class:"mr-8",iconName:"app-workspace",style:{"font-size":"16px"}}),R(" "+s(d.$t("views.workspace.toWorkspace")),1)]),_:1})):k("",!0)])]),t(ct)])}}}),bt=ee(vt,[["__scopeId","data-v-c20e3067"]]),At=F({__name:"index",setup(M){const l=pe(),d=E([]);return ke(()=>{const{name:p,meta:h}=l;p&&!d.value.includes(p)&&d.value.push(p)}),(p,h)=>{const f=a("router-view");return c(),y(f,null,{default:o(({Component:g})=>[t(Ie,{appear:"",name:"fade-transform",mode:"out-in"},{default:o(()=>[(c(),y($e,{include:d.value},[(c(),y(Ce(g),{key:e(l).path}))],1032,["include"]))]),_:2},1024)]),_:1})}}});export{ct as A,bt as S,dt as T,At as _};

import{aJ as Z,aR as X,aP as ie,cE as d,cS as $e,aT as T,cI as e,aS as t,aX as l,dz as ve,aN as u,aU as W,cN as V,aO as c,cO as j,c_ as J,aM as k,d4 as ae,db as Ve,cF as Y,cM as Se,c$ as Ce,cU as te,d0 as ce,aW as oe,d8 as fe,aQ as _e,el as Te,aL as pe,cH as ge,cG as me,em as he,en as ye,eo as we,d3 as Me,aV as Re,cK as Ue}from"./admin-BYKfadXe.js";const Pe={class:"dialog-footer"},pl=Z({__name:"AIModeParamSettingDialog",emits:["refresh"],setup(Q,{expose:x,emit:A}){const z=ie(),U=X(()=>z.path.includes("resource-management")?"systemManage":"workspace"),S=d([]),L=A,M=d(),o=d({}),r=d(!1),s=d(!1),f=(a,n)=>J({type:"model",systemType:U.value}).getModelParamsForm(a,s),$=d(""),R=X(()=>$e.model[U.value]),P=(a,n,p)=>{$.value=a,o.value={},f(a).then(m=>{var w;S.value=m.data,(w=M.value)==null||w.render(S.value,p)}),r.value=!0},N=(a,n)=>{f(a).then(y=>{S.value=y.data;const m=y.data.map(w=>w.show_default_value===!1?{[w.field]:void 0}:{[w.field]:w.default_value}).reduce((w,v)=>({...w,...v}),{});L("refresh",m)})},q=async()=>{var a;(a=M.value)==null||a.validate().then(()=>{L("refresh",o.value),r.value=!1})};return x({open:P,reset_default:N}),(a,n)=>{const p=t("el-button"),y=t("el-dialog");return k(),T(y,{"align-center":"",title:a.$t("common.paramSetting"),modelValue:r.value,"onUpdate:modelValue":n[2]||(n[2]=m=>r.value=m),style:{width:"550px"},"append-to-body":"","destroy-on-close":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:e(()=>[u("span",Pe,[l(p,{onClick:n[1]||(n[1]=j(m=>r.value=!1,["prevent"]))},{default:e(()=>[V(c(a.$t("common.cancel")),1)]),_:1}),R.value.paramSetting($.value)?(k(),T(p,{key:0,type:"primary",onClick:q,loading:s.value},{default:e(()=>[V(c(a.$t("common.confirm")),1)]),_:1},8,["loading"])):W("",!0)])]),default:e(()=>[l(ve,{modelValue:o.value,"onUpdate:modelValue":n[0]||(n[0]=m=>o.value=m),model:o.value,"label-position":"top","require-asterisk-position":"right",render_data:S.value,ref_key:"dynamicsFormRef",ref:M},null,8,["modelValue","model","render_data"])]),_:1},8,["title","modelValue"])}}}),Fe={class:"p-8"},Le={class:"mb-4"},Oe={class:"mb-4"},ze={class:"mb-4"},Ne={class:"flex align-center"},qe={class:"mr-4"},De={class:"flex align-center"},Ie={class:"mr-4"},xe={class:"dialog-footer"},ml=Z({__name:"ParamSettingDialog",emits:["refresh"],setup(Q,{expose:x,emit:A}){const z=A,U=d(),S=d(),L={ai_questioning:"{question}",designated_answer:ae("views.application.dialog.designated_answer")},M=ae("views.application.dialog.defaultPrompt1",{question:"{question}"})+"<data></data>"+ae("views.application.dialog.defaultPrompt2"),o=d({knowledgeSetting:{searchMode:"embedding",topN:3,similarity:.6,maxParagraphCharNumber:5e3,noReferencesSetting:{status:"ai_questioning",value:"{question}"}},problemOptimization:!1,problemOptimizationPrompt:M}),r=d({ai_questioning:L.ai_questioning,designated_answer:L.designated_answer}),s=Ve({ai_questioning:[{required:!0,message:ae("views.application.form.aiModel.placeholder"),trigger:"blur"}],designated_answer:[{required:!0,message:ae("views.application.form.prompt.requiredMessage"),trigger:"blur"}]}),f=d(!1),$=d(!1),R=d(!1);Y(f,a=>{var n;a||(r.value={ai_questioning:L.ai_questioning,designated_answer:L.designated_answer},(n=S.value)==null||n.clearValidate())});const P=(a,n)=>{R.value=Se(n),o.value={knowledgeSetting:Ce.cloneDeep(a.knowledgeSetting),problemOptimization:a.problemOptimization,problemOptimizationPrompt:a.problemOptimizationPrompt},R.value||(r.value[o.value.knowledgeSetting.noReferencesSetting.status]=o.value.knowledgeSetting.noReferencesSetting.value),f.value=!0},N=async a=>{if(R.value)delete o.value.noReferencesSetting,z("refresh",o.value),f.value=!1;else{if(!a)return;await a.validate((n,p)=>{n&&(o.value.knowledgeSetting.noReferencesSetting.value=r.value[o.value.knowledgeSetting.noReferencesSetting.status],z("refresh",o.value),f.value=!1)})}};function q(a){a==="keywords"?o.value.knowledgeSetting.similarity=0:o.value.knowledgeSetting.similarity=.6}return x({open:P}),(a,n)=>{const p=t("el-text"),y=t("el-radio"),m=t("el-card"),w=t("el-radio-group"),v=t("el-form-item"),H=t("el-tooltip"),O=t("el-input-number"),g=t("el-col"),h=t("el-row"),i=t("el-slider"),_=t("el-input"),b=t("el-form"),G=t("el-switch"),K=t("el-scrollbar"),B=t("el-button"),ee=t("el-dialog"),le=ce("loading");return k(),T(ee,{class:"scrollbar-dialog","align-center":"",title:a.$t("common.paramSetting"),modelValue:f.value,"onUpdate:modelValue":n[11]||(n[11]=C=>f.value=C),width:"550px","append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:e(()=>[u("span",xe,[l(B,{onClick:n[9]||(n[9]=j(C=>f.value=!1,["prevent"]))},{default:e(()=>[V(c(a.$t("common.cancel")),1)]),_:1}),l(B,{type:"primary",onClick:n[10]||(n[10]=C=>N(S.value)),loading:$.value},{default:e(()=>[V(c(a.$t("common.save")),1)]),_:1},8,["loading"])])]),default:e(()=>[l(K,{"max-height":"550"},{default:e(()=>[u("div",Fe,[te((k(),T(b,{"label-position":"top",ref_key:"paramFormRef",ref:U,model:o.value},{default:e(()=>[l(v,{label:a.$t("views.application.dialog.selectSearchMode")},{default:e(()=>[l(w,{modelValue:o.value.knowledgeSetting.searchMode,"onUpdate:modelValue":n[0]||(n[0]=C=>o.value.knowledgeSetting.searchMode=C),class:"card__radio",onChange:q},{default:e(()=>[l(m,{shadow:"never",class:oe(["mb-16",o.value.searchMode==="embedding"?"active":""])},{default:e(()=>[l(y,{value:"embedding",size:"large"},{default:e(()=>[u("p",Le,c(a.$t("views.application.dialog.vectorSearch")),1),l(p,{type:"info"},{default:e(()=>[V(c(a.$t("views.application.dialog.vectorSearchTooltip")),1)]),_:1})]),_:1})]),_:1},8,["class"]),l(m,{shadow:"never",class:oe(["mb-16",o.value.knowledgeSetting.searchMode==="keywords"?"active":""])},{default:e(()=>[l(y,{value:"keywords",size:"large"},{default:e(()=>[u("p",Oe,c(a.$t("views.application.dialog.fullTextSearch")),1),l(p,{type:"info"},{default:e(()=>[V(c(a.$t("views.application.dialog.fullTextSearchTooltip")),1)]),_:1})]),_:1})]),_:1},8,["class"]),l(m,{shadow:"never",class:oe(o.value.knowledgeSetting.searchMode==="hybrid"?"active":"")},{default:e(()=>[l(y,{value:"hybrid",size:"large"},{default:e(()=>[u("p",ze,c(a.$t("views.application.dialog.hybridSearch")),1),l(p,{type:"info"},{default:e(()=>[V(c(a.$t("views.application.dialog.hybridSearchTooltip")),1)]),_:1})]),_:1})]),_:1},8,["class"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(h,{gutter:10},{default:e(()=>[l(g,{span:12},{default:e(()=>[l(v,null,{label:e(()=>[u("div",Ne,[u("span",qe,c(a.$t("views.application.dialog.similarityThreshold")),1),l(H,{effect:"dark",content:a.$t("views.application.dialog.similarityTooltip"),placement:"right"},{default:e(()=>[l(fe,{iconName:"app-warning",class:"app-warning-icon"})]),_:1},8,["content"])])]),default:e(()=>[l(O,{modelValue:o.value.knowledgeSetting.similarity,"onUpdate:modelValue":n[1]||(n[1]=C=>o.value.knowledgeSetting.similarity=C),min:0,max:o.value.knowledgeSetting.searchMode==="hybrid"?2:1,precision:3,step:.1,"value-on-clear":0,"controls-position":"right",class:"w-full"},null,8,["modelValue","max"])]),_:1})]),_:1}),l(g,{span:12},{default:e(()=>[l(v,{label:a.$t("views.application.dialog.topReferences")},{default:e(()=>[l(O,{modelValue:o.value.knowledgeSetting.topN,"onUpdate:modelValue":n[2]||(n[2]=C=>o.value.knowledgeSetting.topN=C),min:1,max:1e4,"value-on-clear":1,"controls-position":"right",class:"w-full"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),l(v,{label:a.$t("views.application.dialog.maxCharacters")},{default:e(()=>[l(i,{modelValue:o.value.knowledgeSetting.maxParagraphCharNumber,"onUpdate:modelValue":n[3]||(n[3]=C=>o.value.knowledgeSetting.maxParagraphCharNumber=C),"show-input":"","show-input-controls":!1,min:500,max:1e5,class:"custom-slider"},null,8,["modelValue"])]),_:1},8,["label"]),R.value?W("",!0):(k(),T(v,{key:0,label:a.$t("views.application.dialog.noReferencesAction")},{default:e(()=>[l(b,{"label-position":"top",ref_key:"noReferencesFormRef",ref:S,model:r.value,rules:s,"hide-required-asterisk":!0,class:"w-full"},{default:e(()=>[l(w,{modelValue:o.value.knowledgeSetting.noReferencesSetting.status,"onUpdate:modelValue":n[5]||(n[5]=C=>o.value.knowledgeSetting.noReferencesSetting.status=C),class:"radio-block-avatar"},{default:e(()=>[l(y,{value:"ai_questioning"},{default:e(()=>[u("p",null,c(a.$t("views.application.dialog.continueQuestioning")),1)]),_:1}),l(y,{value:"designated_answer"},{default:e(()=>[u("p",null,c(a.$t("views.application.dialog.provideAnswer")),1),o.value.knowledgeSetting.noReferencesSetting.status==="designated_answer"?(k(),T(v,{key:0,prop:"designated_answer"},{default:e(()=>[l(_,{modelValue:r.value.designated_answer,"onUpdate:modelValue":n[4]||(n[4]=C=>r.value.designated_answer=C),rows:2,type:"textarea",maxlength:"2048",placeholder:L.designated_answer},null,8,["modelValue","placeholder"])]),_:1})):W("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["model","rules"])]),_:1},8,["label"])),R.value?W("",!0):(k(),T(v,{key:1,onClick:n[7]||(n[7]=j(()=>{},["prevent"]))},{label:e(()=>[u("div",De,[u("span",Ie,c(a.$t("views.application.form.problemOptimization.label")),1)])]),default:e(()=>[l(G,{size:"small",modelValue:o.value.problemOptimization,"onUpdate:modelValue":n[6]||(n[6]=C=>o.value.problemOptimization=C)},null,8,["modelValue"])]),_:1})),o.value.problemOptimization?(k(),T(v,{key:2,label:a.$t("views.application.form.prompt.label")},{default:e(()=>[l(_,{modelValue:o.value.problemOptimizationPrompt,"onUpdate:modelValue":n[8]||(n[8]=C=>o.value.problemOptimizationPrompt=C),rows:6,type:"textarea",maxlength:"2048",placeholder:M},null,8,["modelValue"])]),_:1},8,["label"])):W("",!0)]),_:1},8,["model"])),[[le,$.value]])])]),_:1})]),_:1},8,["title","modelValue"])}}}),Ae={class:"flex-between mb-8"},He={class:"flex"},Ke=["id"],Ee={class:"p-8"},Be={class:"layout-bg"},We={class:"flex-between p-16 ml-8"},Ge={class:"p-16-24 pt-0",style:{height:"calc(100vh - 200px)"}},je=["title"],Qe={class:"flex-between"},Je={class:"flex"},vl=Z({__name:"AddKnowledgeDialog",props:{data:{type:Array,default:()=>[]},loading:Boolean},emits:["addData"],setup(Q,{expose:x,emit:A}){const z=ie(),U=Q,S=A,{folder:L,user:M}=_e(),o=X(()=>z.path.includes("shared")?"systemShare":z.path.includes("resource-management")?"systemManage":"workspace"),r=d(!1),s=d([]),f=d(""),$=d(""),R=d([]),P=d([]),N=d(!1),q=X(()=>f.value?R.value.filter(i=>i.embeddingModelId===f.value):R.value);Y(r,i=>{i||(s.value=[],f.value="",$.value="",R.value=[],P.value=[])}),Y($,i=>{i?R.value=P.value.filter(_=>{var b;return _.name.includes(i)&&_.folderId===((b=v.value)==null?void 0:b.id)}):R.value=P.value.filter(_=>{var b;return _.folderId===((b=v.value)==null?void 0:b.id)})});function a(){var i,_;s.value.length>0?f.value=(_=(i=P.value)==null?void 0:i.find(b=>b.id===s.value[0]))==null?void 0:_.embeddingModelId:s.value.length===0&&(f.value="")}function n(){s.value=[],f.value=""}const p=i=>{s.value=i,g(),s.value.length>0&&(f.value=U.data.filter(_=>_.id===s.value[0])[0].embeddingModelId),r.value=!0},y=()=>{S("addData",P.value.filter(i=>s.value.includes(i.id))),r.value=!1},m=()=>{$.value="",P.value=[],h()},w=d([]),v=d({}),H=d(!1);function O(i){var _;i.id!==((_=v.value)==null?void 0:_.id)&&(v.value=i,h())}function g(){const i={};L.asyncGetFolder("KNOWLEDGE",i,H).then(_=>{var b;w.value=_.data,v.value=((b=_.data)==null?void 0:b[0])||{},h()})}function h(){var _;const i=((_=v.value)==null?void 0:_.id)||M.getWorkspaceId();J({type:"knowledge",isShared:i==="share",systemType:o.value}).getKnowledgeList({folderId:i},N).then(b=>{P.value=Te([...P.value,...b.data],"id"),R.value=b.data})}return x({open:p}),(i,_)=>{const b=t("el-text"),G=t("Refresh"),K=t("el-icon"),B=t("el-button"),ee=t("el-input"),le=t("el-col"),C=t("el-row"),de=t("el-empty"),re=t("el-scrollbar"),ue=t("el-dialog"),ne=ce("loading");return k(),T(ue,{title:i.$t("views.application.dialog.addKnowledge"),modelValue:r.value,"onUpdate:modelValue":_[3]||(_[3]=D=>r.value=D),width:"1000","append-to-body":"",class:"addKnowledge-dialog","align-center":"","close-on-click-modal":!1,"close-on-press-escape":!1},{header:e(({titleId:D,titleClass:E})=>[u("div",Ae,[u("div",He,[u("h4",{id:D,class:oe([E,"mr-8"])},c(i.$t("views.application.dialog.addKnowledge")),11,Ke),l(b,{type:"info"},{default:e(()=>[V(c(i.$t("views.application.dialog.addKnowledgePlaceholder")),1)]),_:1})]),l(B,{link:"",class:"mr-24",onClick:m},{default:e(()=>[l(K,{size:18},{default:e(()=>[l(G)]),_:1})]),_:1})])]),footer:e(()=>[u("div",Qe,[u("div",Je,[s.value.length>0?(k(),T(b,{key:0,type:"info",class:"color-secondary mr-8"},{default:e(()=>[V(c(i.$t("common.selected"))+" "+c(s.value.length),1)]),_:1})):W("",!0),s.value.length>0?(k(),T(B,{key:1,link:"",type:"primary",onClick:n},{default:e(()=>[V(c(i.$t("common.clear")),1)]),_:1})):W("",!0)]),u("span",null,[l(B,{onClick:_[2]||(_[2]=j(D=>r.value=!1,["prevent"]))},{default:e(()=>[V(c(i.$t("common.cancel")),1)]),_:1}),l(B,{type:"primary",onClick:y},{default:e(()=>[V(c(i.$t("common.add")),1)]),_:1})])])]),default:e(()=>[l(ye,{showCollapse:"",class:"application-manage"},{left:e(()=>{var D;return[u("div",Ee,[te(l(he,{data:w.value,currentNodeKey:(D=v.value)==null?void 0:D.id,onHandleNodeClick:O,canOperation:!1,showShared:"",shareTitle:i.$t("views.shared.shared_knowledge"),treeStyle:{height:"calc(100vh - 240px)"}},null,8,["data","currentNodeKey","shareTitle"]),[[ne,H.value]])])]}),default:e(()=>{var D;return[u("div",Be,[u("div",We,[u("h4",null,c((D=v.value)==null?void 0:D.name),1),l(ee,{modelValue:$.value,"onUpdate:modelValue":_[0]||(_[0]=E=>$.value=E),placeholder:i.$t("common.search"),"prefix-icon":"Search",class:"w-240 mr-8",clearable:""},null,8,["modelValue","placeholder"])]),l(re,null,{default:e(()=>[u("div",Ge,[q.value.length?te((k(),T(C,{key:0,gutter:12},{default:e(()=>[(k(!0),pe(me,null,ge(q.value.filter(E=>E.resourceType!=="folder"),(E,se)=>(k(),T(le,{span:8,key:se,class:"mb-16"},{default:e(()=>[l(we,{"value-field":"id",data:E,modelValue:s.value,"onUpdate:modelValue":_[1]||(_[1]=I=>s.value=I),onChange:a},{default:e(()=>[u("span",{class:"ellipsis cursor ml-12",title:E.name},c(E.name),9,je)]),_:2},1032,["data","modelValue"])]),_:2},1024))),128))]),_:1})),[[ne,N.value]]):(k(),T(de,{key:1,description:i.$t("common.noData")},null,8,["description"]))])]),_:1})])]}),_:1})]),_:1},8,["title","modelValue"])}}}),Xe={class:"flex-between"},Ye={class:"dialog-footer"},fl=Z({__name:"TTSModeParamSettingDialog",emits:["refresh"],setup(Q,{expose:x,emit:A}){const z=ie(),{params:{id:U}}=z,S=X(()=>z.path.includes("resource-management")?"systemManage":"workspace"),L=d(""),M=d([]),o=A,r=d(),s=d({}),f=d(!1),$=d(!1),R=d(!1),P=(p,y,m)=>{s.value={},L.value=p,J({type:"model",systemType:S.value}).getModelParamsForm(p,$).then(w=>{var H;M.value=w.data;const v=w.data.map(O=>({[O.field]:O.show_default_value!==!1?O.default_value:void 0})).reduce((O,g)=>({...O,...g}),{});m&&Object.keys(m).forEach(O=>{O in v||delete m[O]}),m={...v,...m},(H=r.value)==null||H.render(M.value,m)}),f.value=!0},N=(p,y)=>{J({type:"model",systemType:S.value}).getModelParamsForm(p,$).then(m=>{M.value=m.data;const w=m.data.map(v=>({[v.field]:v.show_default_value!==!1?v.default_value:void 0})).reduce((v,H)=>({...v,...H}),{});console.log("model_setting_data: ",w),o("refresh",w)})},q=async()=>{var p;(p=r.value)==null||p.validate().then(()=>{o("refresh",s.value),f.value=!1})},a=d(null),n=()=>{const p={...s.value,ttsModelId:L.value};J({type:"application",systemType:S.value}).playDemoText(U,p,R).then(async y=>{if(y.type==="application/json"){const v=await y.text();Me(v);return}const m=new Blob([y],{type:"audio/mp3"}),w=URL.createObjectURL(m);a.value instanceof HTMLAudioElement?(a.value.src=w,a.value.play()):console.error("audioPlayer.value is not an instance of HTMLAudioElement")}).catch(y=>{console.log("err: ",y)})};return x({open:P,reset_default:N}),(p,y)=>{const m=t("el-button"),w=t("el-dialog");return k(),pe(me,null,[l(w,{"align-center":"",title:p.$t("common.paramSetting"),modelValue:f.value,"onUpdate:modelValue":y[2]||(y[2]=v=>f.value=v),style:{width:"550px"},"append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:e(()=>[u("div",Xe,[l(m,{onClick:n,loading:R.value},{default:e(()=>[l(fe,{iconName:"app-video-play",class:"mr-4"}),V(" "+c(p.$t("views.application.form.voicePlay.listeningTest")),1)]),_:1},8,["loading"]),u("span",Ye,[l(m,{onClick:y[1]||(y[1]=j(v=>f.value=!1,["prevent"]))},{default:e(()=>[V(c(p.$t("common.cancel")),1)]),_:1}),l(m,{type:"primary",onClick:q,loading:$.value},{default:e(()=>[V(c(p.$t("common.confirm")),1)]),_:1},8,["loading"])])])]),default:e(()=>[l(ve,{modelValue:s.value,"onUpdate:modelValue":y[0]||(y[0]=v=>s.value=v),model:s.value,"label-position":"top","require-asterisk-position":"right",render_data:M.value,ref_key:"dynamicsFormRef",ref:r},null,8,["modelValue","model","render_data"])]),_:1},8,["title","modelValue"]),u("audio",{ref_key:"audioPlayer",ref:a,controls:"",hidden:"hidden"},null,512)],64)}}}),Ze={class:"dialog-footer p-16"},_l=Z({__name:"ReasoningParamSettingDialog",emits:["refresh"],setup(Q,{expose:x,emit:A}){const z=A,U=d({reasoningContent_start:"<think>",reasoningContent_end:"</think>"}),S=d(!1),L=d(!1);Y(S,r=>{r||(U.value={reasoningContent_start:"<think>",reasoningContent_end:"</think>"})});const M=r=>{U.value={...U.value,...r},S.value=!0},o=()=>{z("refresh",U.value),S.value=!1};return x({open:M}),(r,s)=>{const f=t("el-text"),$=t("el-input"),R=t("el-form-item"),P=t("el-col"),N=t("el-row"),q=t("el-form"),a=t("el-button"),n=t("el-dialog");return k(),T(n,{"align-center":"",title:r.$t("common.setting"),class:"param-dialog",modelValue:S.value,"onUpdate:modelValue":s[4]||(s[4]=p=>S.value=p),style:{width:"550px"},"append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:e(()=>[u("span",Ze,[l(a,{onClick:s[2]||(s[2]=j(p=>S.value=!1,["prevent"]))},{default:e(()=>[V(c(r.$t("common.cancel")),1)]),_:1}),l(a,{type:"primary",onClick:s[3]||(s[3]=p=>o()),loading:L.value},{default:e(()=>[V(c(r.$t("common.save")),1)]),_:1},8,["loading"])])]),default:e(()=>[l(q,{"label-position":"top",ref:"paramFormRef",model:U.value},{default:e(()=>[l(f,{type:"info",class:"color-secondary"},{default:e(()=>[V(c(r.$t("views.application.form.reasoningContent.tooltip")),1)]),_:1}),l(N,{class:"mt-16",gutter:20},{default:e(()=>[l(P,{span:12},{default:e(()=>[l(R,{label:r.$t("views.application.form.reasoningContent.start")},{default:e(()=>[l($,{type:"textarea",modelValue:U.value.reasoningContent_start,"onUpdate:modelValue":s[0]||(s[0]=p=>U.value.reasoningContent_start=p),rows:6,maxlength:"50",placeholder:"<think>"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),l(P,{span:12},{default:e(()=>[l(R,{label:r.$t("views.application.form.reasoningContent.end")},{default:e(()=>[l($,{type:"textarea",modelValue:U.value.reasoningContent_end,"onUpdate:modelValue":s[1]||(s[1]=p=>U.value.reasoningContent_end=p),rows:6,maxlength:"50",placeholder:"</think>"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])}}}),el={class:"flex-between mb-8"},ll={class:"flex"},al=["id"],ol={class:"p-8"},tl={class:"layout-bg"},nl={class:"flex-between p-16 ml-8"},sl={class:"p-16-24 pt-0",style:{height:"calc(100vh - 200px)"}},il=["src"],dl=["title"],rl={class:"flex-between"},ul={class:"flex"},gl=Z({__name:"ToolDialog",emits:["refresh"],setup(Q,{expose:x,emit:A}){const z=ie(),U=A,{folder:S,user:L}=_e();X(()=>z.path.includes("shared")?"systemShare":z.path.includes("resource-management")?"systemManage":"workspace");const M=d(!1),o=d([]),r=d(""),s=d([]),f=d([]),$=d("CUSTOM"),R=d(!1);Y(M,g=>{g||(o.value=[],r.value="",s.value=[],f.value=[])}),Y(r,g=>{g?s.value=f.value.filter(h=>h.name.includes(g)&&h.toolType===$.value):s.value=f.value.filter(h=>h.toolType===$.value)});function P(){}function N(){o.value=[]}const q=g=>{o.value=g||[],H(),M.value=!0},a=()=>{U("refresh",{toolIds:o.value}),M.value=!1},n=()=>{r.value="",f.value=[],O()};function p(){s.value=f.value.filter(g=>g.name.includes(r.value)&&g.toolType===$.value)}const y=d([]),m=d({}),w=d(!1);function v(g){var h;g.id!==((h=m.value)==null?void 0:h.id)&&(m.value=g,O())}function H(){const g={};S.asyncGetFolder("TOOL",g,w).then(h=>{var i;y.value=h.data,m.value=((i=h.data)==null?void 0:i[0])||{},O()})}function O(){var h;const g=((h=m.value)==null?void 0:h.id)||L.getWorkspaceId();J({type:"tool",isShared:g==="share",systemType:"workspace"}).getToolList({folderId:g}).then(i=>{var _,b,G;f.value=((_=i.data)==null?void 0:_.tools)||i.data||[],f.value=(b=f.value)==null?void 0:b.filter(K=>K.isActive),s.value=i.data.tools||i.data,s.value=(G=s.value)==null?void 0:G.filter(K=>K.isActive&&K.toolType===$.value)})}return x({open:q}),(g,h)=>{const i=t("Refresh"),_=t("el-icon"),b=t("el-button"),G=t("el-divider"),K=t("el-radio-button"),B=t("el-radio-group"),ee=t("el-input"),le=t("el-avatar"),C=t("ToolIcon"),de=t("el-col"),re=t("el-row"),ue=t("el-empty"),ne=t("el-scrollbar"),D=t("el-text"),E=t("el-dialog"),se=ce("loading");return k(),T(E,{modelValue:M.value,"onUpdate:modelValue":h[4]||(h[4]=I=>M.value=I),width:"1000","append-to-body":"",class:"addTool-dialog","align-center":"","close-on-click-modal":!1,"close-on-press-escape":!1},{header:e(({titleId:I,titleClass:F})=>[u("div",el,[u("div",ll,[u("h4",{id:I,class:oe([F,"mr-8"])},c(g.$t("views.tool.settingTool")),11,al)]),l(b,{link:"",class:"mr-24",onClick:n},{default:e(()=>[l(_,{size:18},{default:e(()=>[l(i)]),_:1})]),_:1})])]),footer:e(()=>[u("div",rl,[u("div",ul,[o.value.length>0?(k(),T(D,{key:0,type:"info",class:"color-secondary mr-8"},{default:e(()=>[V(c(g.$t("common.selected"))+" "+c(o.value.length),1)]),_:1})):W("",!0),o.value.length>0?(k(),T(b,{key:1,link:"",type:"primary",onClick:N},{default:e(()=>[V(c(g.$t("common.clear")),1)]),_:1})):W("",!0)]),u("span",null,[l(b,{onClick:h[3]||(h[3]=j(I=>M.value=!1,["prevent"]))},{default:e(()=>[V(c(g.$t("common.cancel")),1)]),_:1}),l(b,{type:"primary",onClick:a},{default:e(()=>[V(c(g.$t("common.add")),1)]),_:1})])])]),default:e(()=>[l(ye,{showCollapse:"",class:"application-manage"},{left:e(()=>{var I;return[u("div",ol,[te(l(he,{data:y.value,currentNodeKey:(I=m.value)==null?void 0:I.id,onHandleNodeClick:v,canOperation:!1,showShared:"",shareTitle:g.$t("views.shared.shared_tool"),treeStyle:{height:"calc(100vh - 240px)"}},null,8,["data","currentNodeKey","shareTitle"]),[[se,w.value]])])]}),default:e(()=>{var I;return[u("div",tl,[u("div",nl,[u("h4",null,c((I=m.value)==null?void 0:I.name),1),l(G,{direction:"vertical"}),l(B,{modelValue:$.value,"onUpdate:modelValue":h[0]||(h[0]=F=>$.value=F),onChange:p,class:"app-radio-button-group"},{default:e(()=>[l(K,{value:"CUSTOM"},{default:e(()=>[V(c(g.$t("views.tool.title")),1)]),_:1}),l(K,{value:"MCP"},{default:e(()=>h[5]||(h[5]=[V("MCP",-1)])),_:1,__:[5]})]),_:1},8,["modelValue"]),l(ee,{modelValue:r.value,"onUpdate:modelValue":h[1]||(h[1]=F=>r.value=F),placeholder:g.$t("common.search"),"prefix-icon":"Search",class:"w-240 mr-8",clearable:""},null,8,["modelValue","placeholder"])]),l(ne,null,{default:e(()=>[u("div",sl,[s.value.length?te((k(),T(re,{key:0,gutter:12},{default:e(()=>[(k(!0),pe(me,null,ge(s.value,(F,be)=>(k(),T(de,{span:8,key:be,class:"mb-16"},{default:e(()=>[l(we,{"value-field":"id",data:F,modelValue:o.value,"onUpdate:modelValue":h[2]||(h[2]=ke=>o.value=ke),onChange:P},{icon:e(()=>[F!=null&&F.icon?(k(),T(le,{key:0,shape:"square",size:32,style:{background:"none"},class:"mr-8"},{default:e(()=>[u("img",{src:Re(Ue)(F==null?void 0:F.icon),alt:""},null,8,il)]),_:2},1024)):(k(),T(C,{key:1,size:32,type:F==null?void 0:F.toolType},null,8,["type"]))]),default:e(()=>[u("span",{class:"ellipsis cursor ml-12",title:F.name},c(F.name),9,dl)]),_:2},1032,["data","modelValue"])]),_:2},1024))),128))]),_:1})),[[se,R.value]]):(k(),T(ue,{key:1,description:g.$t("common.noData")},null,8,["description"]))])]),_:1})])]}),_:1})]),_:1},8,["modelValue"])}}});export{pl as _,_l as a,gl as b,fl as c,ml as d,vl as e};

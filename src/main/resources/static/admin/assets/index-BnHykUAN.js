var jt=Object.defineProperty;var Wt=(W,I,H)=>I in W?jt(W,I,{enumerable:!0,configurable:!0,writable:!0,value:H}):W[I]=H;var tt=(W,I,H)=>Wt(W,typeof I!="symbol"?I+"":I,H);import{ay as ye,aP as Te,aQ as ne,aB as g,aX as Qt,aC as k,aR as nt,aD as i,aE as d,aF as o,aG as e,aH as t,aU as S,aT as X,aY as ce,aZ as Ee,b8 as n,aK as m,aJ as s,aI as D,a_ as ee,aW as O,b5 as re,aA as st,a$ as Le,bg as Be,co as ut,d9 as lt,b3 as Fe,b4 as Ge,b_ as it,c9 as he,az as Zt,es as Yt,dc as Jt,b9 as Xt,dt as xt,cp as te,d4 as el,et as tl,bC as ge,df as ll,c7 as at,ca as al}from"./admin-BpafW2aq.js";import{S as ol}from"./SyncWebDialog-D3XFbGWF.js";import{_ as nl}from"./index.vue_vue_type_script_setup_true_lang-CCgcxcNW.js";import{_ as sl}from"./ExecutionRecordDrawer.vue_vue_type_script_setup_true_lang-CbMeN7OG.js";import"./array-method-is-strict-CNoJYdjc.js";import"./Result.vue_vue_type_script_setup_true_lang-CzJ4KiQA.js";var Ne=(W=>(W.optimization="views.document.hitHandlingMethod.optimization",W.directlyReturn="views.document.hitHandlingMethod.directlyReturn",W))(Ne||{});const ul={class:"flex align-center"},il={class:"mr-4"},cl={class:"lighter w-full",style:{"margin-top":"-20px"}},rl={class:"dialog-footer"},dl=ye({__name:"ImportDocumentDialog",props:{title:String},emits:["refresh"],setup(W,{expose:I,emit:H}){const u=Te(),{params:{id:$}}=u,Q=ne(()=>u.path.includes("shared")?"systemShare":u.path.includes("resource-management")?"systemManage":"workspace"),C=H,h=g(),p=g(!1),a=g(!1),f=g({sourceUrl:"",selector:"",hitHandlingMethod:"optimization",directlyReturnSimilarity:.9}),V=g(""),L=g(""),_=g([]),B=Qt({sourceUrl:[{required:!0,message:k("views.document.form.sourceUrl.requiredMessage"),trigger:"blur"}],directlyReturnSimilarity:[{required:!0,message:k("views.document.form.similarity.requiredMessage"),trigger:"blur"}]}),M=g(!1);nt(M,r=>{r||(f.value={sourceUrl:"",selector:"",hitHandlingMethod:"optimization",directlyReturnSimilarity:.9},a.value=!1,L.value="",V.value="",_.value=[])});const K=(r,b)=>{r?(L.value=r.type,V.value=r.id,f.value={hitHandlingMethod:r.hitHandlingMethod,directlyReturnSimilarity:r.directlyReturnSimilarity,...r.meta,meta:r.meta},a.value=!1):b?_.value=b:(L.value=1,a.value=!0),M.value=!0},q=async r=>{r&&await r.validate(b=>{if(b){if(a.value){const z={sourceUrlList:f.value.sourceUrl.split(`
`),selector:f.value.selector};O({type:"document",systemType:Q.value}).postWebDocument($,z,p).then(()=>{re(k("views.document.tip.importMessage")),C("refresh"),M.value=!1})}else if(V.value){const z={hitHandlingMethod:f.value.hitHandlingMethod,directlyReturnSimilarity:f.value.directlyReturnSimilarity,meta:{...f.value.meta,sourceUrl:f.value.sourceUrl,selector:f.value.selector}};O({type:"document",systemType:Q.value}).putDocument($,V.value,z,p).then(()=>{re(k("common.settingSuccess")),C("refresh"),M.value=!1})}else if(_.value.length>0){const z={hitHandlingMethod:f.value.hitHandlingMethod,directlyReturnSimilarity:f.value.directlyReturnSimilarity,idList:_.value};O({type:"document",systemType:Q.value}).putBatchEditHitHandling($,z,p).then(()=>{re(k("common.settingSuccess")),C("refresh"),M.value=!1})}}})};return I({open:K}),(r,b)=>{const z=i("el-input"),A=i("el-form-item"),ae=i("AppIcon"),E=i("el-tooltip"),c=i("el-radio"),G=i("el-radio-group"),Z=i("el-input-number"),j=i("el-form"),R=i("el-button"),le=i("el-dialog");return o(),d(le,{title:W.title,modelValue:M.value,"onUpdate:modelValue":b[7]||(b[7]=y=>M.value=y),"close-on-click-modal":!1,"close-on-press-escape":!1,"destroy-on-close":!0,width:"550"},{footer:e(()=>[D("span",rl,[t(R,{onClick:b[5]||(b[5]=ee(y=>M.value=!1,["prevent"]))},{default:e(()=>[m(s(r.$t("common.cancel")),1)]),_:1}),t(R,{type:"primary",onClick:b[6]||(b[6]=y=>q(h.value)),loading:p.value},{default:e(()=>[m(s(r.$t("common.confirm")),1)]),_:1},8,["loading"])])]),default:e(()=>[t(j,{"label-position":"top",ref_key:"webFormRef",ref:h,rules:B,model:f.value,"require-asterisk-position":"right"},{default:e(()=>[a.value?(o(),d(A,{key:0,label:r.$t("views.document.form.sourceUrl.label"),prop:"sourceUrl"},{default:e(()=>[t(z,{modelValue:f.value.sourceUrl,"onUpdate:modelValue":b[0]||(b[0]=y=>f.value.sourceUrl=y),placeholder:r.$t("views.document.form.sourceUrl.placeholder"),rows:10,type:"textarea"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):!a.value&&L.value===1?(o(),d(A,{key:1,label:r.$t("views.document.form.sourceUrl.label"),prop:"sourceUrl"},{default:e(()=>[t(z,{modelValue:f.value.sourceUrl,"onUpdate:modelValue":b[1]||(b[1]=y=>f.value.sourceUrl=y),placeholder:r.$t("views.document.form.sourceUrl.requiredMessage")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):S("",!0),L.value===1?(o(),d(A,{key:2,label:r.$t("views.document.form.selector.label")},{default:e(()=>[t(z,{modelValue:f.value.selector,"onUpdate:modelValue":b[2]||(b[2]=y=>f.value.selector=y),placeholder:r.$t("views.document.form.selector.placeholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):S("",!0),a.value?S("",!0):(o(),d(A,{key:3},{label:e(()=>[D("div",ul,[D("span",il,s(r.$t("views.document.form.hitHandlingMethod.label")),1),t(E,{effect:"dark",content:r.$t("views.document.form.hitHandlingMethod.tooltip"),placement:"right"},{default:e(()=>[t(ae,{iconName:"app-warning",class:"app-warning-icon"})]),_:1},8,["content"])])]),default:e(()=>[t(G,{modelValue:f.value.hitHandlingMethod,"onUpdate:modelValue":b[3]||(b[3]=y=>f.value.hitHandlingMethod=y),class:"radio-block mt-4"},{default:e(()=>[(o(!0),X(ce,null,Ee(n(Ne),(y,F)=>(o(),d(c,{key:F,value:F},{default:e(()=>[m(s(r.$t(y)),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})),!a.value&&f.value.hitHandlingMethod==="directlyReturn"?(o(),d(A,{key:4,prop:"directlyReturnSimilarity"},{default:e(()=>[D("div",cl,[D("span",null,s(r.$t("views.document.form.similarity.label")),1),t(Z,{modelValue:f.value.directlyReturnSimilarity,"onUpdate:modelValue":b[4]||(b[4]=y=>f.value.directlyReturnSimilarity=y),min:0,max:1,precision:3,step:.1,"value-on-clear":0,"controls-position":"right",size:"small",class:"ml-4 mr-4"},null,8,["modelValue"]),D("span",null,s(r.$t("views.document.form.similarity.placeholder")),1)])]),_:1})):S("",!0)]),_:1},8,["rules","model"])]),_:1},8,["title","modelValue"])}}}),ml="data:image/svg+xml,%3csvg%20width='20'%20height='20'%20viewBox='0%200%2020%2020'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M0.833496%203.33333C0.833496%202.8731%201.20659%202.5%201.66683%202.5H8.6518C8.96744%202.5%209.256%202.67834%209.39716%202.96066L10.0002%204.16667H18.3335C18.7937%204.16667%2019.1668%204.53976%2019.1668%205V16.6667C19.1668%2017.1269%2018.7937%2017.5%2018.3335%2017.5H1.66683C1.20659%2017.5%200.833496%2017.1269%200.833496%2016.6667V3.33333Z'%20fill='%23FFA53D'/%3e%3cpath%20d='M0.833496%204.99999C0.833496%204.53975%201.20659%204.16666%201.66683%204.16666H18.3335C18.7937%204.16666%2019.1668%204.53975%2019.1668%204.99999V16.6667C19.1668%2017.1269%2018.7937%2017.5%2018.3335%2017.5H1.66683C1.20659%2017.5%200.833496%2017.1269%200.833496%2016.6667V4.99999Z'%20fill='%23FFC60A'/%3e%3c/svg%3e",pl={class:"flex align-center"},vl={class:"dialog-footer"},fl=ye({__name:"SelectKnowledgeDialog",props:{workspaceId:{type:String}},emits:["refresh"],setup(W,{expose:I,emit:H}){const u=Te(),{params:{id:$}}=u,{user:Q}=st(),C=W,h=ne(()=>u.path.includes("shared")?"systemShare":u.path.includes("resource-management")?"systemManage":"workspace"),p=H,a=g(!1),f=g(!1),V=g([]),L=g([]),_=g({selectKnowledge:""}),B={children:"children",label:"name",isLeaf:r=>r.resourceType?r.resourceType!=="folder":r.workspaceId==="None",disabled:(r,b)=>r.id===$||r.resourceType==="folder"&&(b==null?void 0:b.isLeaf)},M=async(r,b)=>{if(r.isLeaf)return b([]);const z=r.level===0?Q.getWorkspaceId():r.data.id,A=h.value==="systemManage"?{workspaceId:C.workspaceId,folderId:r.level===0?C.workspaceId:r.data.id}:{folderId:z};await O({type:"knowledge",systemType:h.value}).getKnowledgeList(A,a).then(ae=>{b(ae.data)})};nt(f,r=>{r||(_.value.selectKnowledge="",V.value=[],L.value=[])});const K=r=>{L.value=r,f.value=!0},q=()=>{O({type:"document",systemType:h.value}).putMigrateMulDocument($,_.value.selectKnowledge,L.value,a).then(()=>{p("refresh"),f.value=!1})};return I({open:K}),(r,b)=>{const z=i("KnowledgeIcon"),A=i("el-avatar"),ae=i("el-tree-select"),E=i("el-form-item"),c=i("el-form"),G=i("el-button"),Z=i("el-dialog");return o(),d(Z,{title:`${r.$t("views.document.migrateDocument")}`,modelValue:f.value,"onUpdate:modelValue":b[2]||(b[2]=j=>f.value=j),width:"600",class:"select-knowledge-dialog","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:e(()=>[D("span",vl,[t(G,{onClick:b[1]||(b[1]=ee(j=>f.value=!1,["prevent"]))},{default:e(()=>[m(s(r.$t("common.cancel")),1)]),_:1}),t(G,{type:"primary",onClick:q,disabled:!_.value.selectKnowledge||a.value},{default:e(()=>[m(s(r.$t("common.confirm")),1)]),_:1},8,["disabled"])])]),default:e(()=>[t(c,{ref:"FormRef",model:_.value,"label-position":"top","require-asterisk-position":"right"},{default:e(()=>[t(E,{label:r.$t("views.chatLog.selectKnowledge"),required:""},{default:e(()=>[t(ae,{modelValue:_.value.selectKnowledge,"onUpdate:modelValue":b[0]||(b[0]=j=>_.value.selectKnowledge=j),props:B,"node-key":"id",lazy:"",load:M,placeholder:r.$t("views.chatLog.selectKnowledgePlaceholder")},{default:e(({data:j})=>[D("div",pl,[j.resourceType!=="folder"?(o(),d(z,{key:0,class:"mr-12",size:20,type:j.type},null,8,["type"])):(o(),d(A,{key:1,class:"mr-12",shape:"square",size:20,style:{background:"none"}},{default:e(()=>b[3]||(b[3]=[D("img",{src:ml,style:{width:"100%"},alt:""},null,-1)])),_:1,__:[3]})),m(" "+s(j.name),1)])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["title","modelValue"])}}}),Y={EMBEDDING:1,GENERATE_PROBLEM:2,SYNC:3},N={PENDING:"0",STARTED:"1",SUCCESS:"2",FAILURE:"3",REVOKE:"4",REVOKED:"5",IGNORED:"n"};class ot{constructor(I){tt(this,"task_status");I||(I=""),I=I.split("").reverse().join(""),this.task_status={};for(const H in Y){const u=Y[H],$=u-1;this.task_status[u]=I[$]?I[$]:"n"}}toString(){const I=[];for(const H in Y){const u=Y[H];I.push(this.task_status[u])}return I.reverse().join("")}}const gl=ye({__name:"StatusTable",props:{status:{},statusMeta:{},stateMap:{},taskTypeMap:{}},setup(W){const I=W,H=C=>{const h=new ot(C.status);return Object.keys(Y).map(p=>{const a=Y[p];return{[a]:{[h.task_status[a]]:C.count}}}).reduce((p,a)=>({...p,...a}),{})},u=(C,h)=>C==null&&h?h:h==null&&C?C:typeof C=="object"&&typeof h=="object"?Le.mergeWith(C,h,u):C+h,$=ne(()=>(I.statusMeta.aggs?I.statusMeta.aggs:[]).map(C=>H(C)).reduce((C,h)=>Le.mergeWith(C,h,u),{})),Q=ne(()=>Object.keys(Y).map(C=>{const h=Y[C],p=new ot(I.status);return{type:h,state:p.task_status[h],aggs:$.value[h],time:I.statusMeta.state_time[h]}}).filter(C=>C.state!==N.IGNORED));return(C,h)=>{const p=i("SuccessFilled"),a=i("el-icon"),f=i("el-text"),V=i("CircleCloseFilled"),L=i("Loading");return o(!0),X(ce,null,Ee(Q.value,_=>(o(),X("div",{key:_.type},[D("span",null,s(C.taskTypeMap[_.type])+"ï¼š",1),D("span",null,[_.state===n(N).SUCCESS||_.state===n(N).REVOKED?(o(),d(f,{key:0},{default:e(()=>[t(a,{class:"color-success"},{default:e(()=>[t(p)]),_:1}),m(" "+s(C.stateMap[_.state](_.type)),1)]),_:2},1024)):_.state===n(N).FAILURE?(o(),d(f,{key:1},{default:e(()=>[t(a,{class:"color-danger"},{default:e(()=>[t(V)]),_:1}),m(" "+s(C.stateMap[_.state](_.type)),1)]),_:2},1024)):_.state===n(N).STARTED?(o(),d(f,{key:2},{default:e(()=>[t(a,{class:"is-loading color-primary"},{default:e(()=>[t(L)]),_:1}),m(" "+s(C.stateMap[_.state](_.type)),1)]),_:2},1024)):_.state===n(N).PENDING?(o(),d(f,{key:3},{default:e(()=>[t(a,{class:"is-loading color-primary"},{default:e(()=>[t(L)]),_:1}),m(" "+s(C.stateMap[_.state](_.type)),1)]),_:2},1024)):_.state===n(N).REVOKE?(o(),d(f,{key:4},{default:e(()=>[t(a,{class:"is-loading color-primary"},{default:e(()=>[t(L)]),_:1}),m(" "+s(C.stateMap[_.state](_.type)),1)]),_:2},1024)):S("",!0)]),D("span",{class:"ml-8 lighter",style:Be({color:[n(N).FAILURE,n(N).REVOKED].includes(_.state)?"#F54A45":""})},s(C.$t("views.document.fileStatus.finish"))+" "+s(Object.keys(_.aggs?_.aggs:{}).filter(B=>B==n(N).SUCCESS).map(B=>_.aggs[B]).reduce((B,M)=>B+M,0))+"/"+s(Object.values(_.aggs?_.aggs:{}).reduce((B,M)=>B+M,0)),5),t(f,{type:"info",class:"ml-12"},{default:e(()=>{var B;return[m(s(_.time?(B=_.time[_.state==n(N).REVOKED?n(N).REVOKED:n(N).PENDING])==null?void 0:B.substring(0,19):void 0),1)]}),_:2},1024)]))),128)}}}),yl=ye({__name:"Status",props:{status:{},statusMeta:{}},setup(W){const I=W,H=g(!1),u=[N.REVOKE,N.STARTED,N.PENDING,N.FAILURE,N.REVOKED,N.SUCCESS],$=ne(()=>{let p={key:0,value:""};for(const a in u){const f=u[a],V=I.status.indexOf(f);if(V>-1){p={key:I.status.length-V,value:f};break}}return p}),Q={[Y.EMBEDDING]:k("views.document.fileStatus.EMBEDDING"),[Y.GENERATE_PROBLEM]:k("views.document.fileStatus.GENERATE"),[Y.SYNC]:k("views.document.fileStatus.SYNC")},C={[Y.EMBEDDING]:k("views.knowledge.setting.vectorization"),[Y.GENERATE_PROBLEM]:k("views.document.generateQuestion.title"),[Y.SYNC]:k("views.knowledge.setting.sync")},h={[N.PENDING]:p=>k("views.document.fileStatus.PENDING"),[N.STARTED]:p=>Q[p],[N.REVOKE]:p=>k("views.document.fileStatus.REVOKE"),[N.REVOKED]:p=>k("views.document.fileStatus.SUCCESS"),[N.FAILURE]:p=>k("views.document.fileStatus.FAILURE"),[N.SUCCESS]:p=>k("views.document.fileStatus.SUCCESS")};return(p,a)=>{const f=i("SuccessFilled"),V=i("el-icon"),L=i("el-text"),_=i("CircleCloseFilled"),B=i("Loading"),M=i("el-popover");return o(),d(M,{visible:H.value,"onUpdate:visible":a[0]||(a[0]=K=>H.value=K),placement:"top",trigger:"hover","popper-style":{width:"auto"}},{default:e(()=>[H.value?(o(),d(gl,{key:0,status:p.status,statusMeta:p.statusMeta,taskTypeMap:C,stateMap:h},null,8,["status","statusMeta"])):S("",!0)]),reference:e(()=>{var K,q,r,b,z,A;return[((K=$.value)==null?void 0:K.value)===n(N).SUCCESS||((q=$.value)==null?void 0:q.value)===n(N).REVOKED?(o(),d(L,{key:0},{default:e(()=>[t(V,{class:"color-success"},{default:e(()=>[t(f)]),_:1}),m(" "+s(h[$.value.value]($.value.key)),1)]),_:1})):((r=$.value)==null?void 0:r.value)===n(N).FAILURE?(o(),d(L,{key:1},{default:e(()=>[t(V,{class:"color-danger"},{default:e(()=>[t(_)]),_:1}),m(" "+s(h[$.value.value]($.value.key)),1)]),_:1})):((b=$.value)==null?void 0:b.value)===n(N).STARTED?(o(),d(L,{key:2},{default:e(()=>[t(V,{class:"is-loading color-primary"},{default:e(()=>[t(B)]),_:1}),m(" "+s(h[$.value.value]($.value.key)),1)]),_:1})):((z=$.value)==null?void 0:z.value)===n(N).PENDING?(o(),d(L,{key:3},{default:e(()=>[t(V,{class:"is-loading color-primary"},{default:e(()=>[t(B)]),_:1}),m(" "+s(h[$.value.value]($.value.key)),1)]),_:1})):((A=$.value)==null?void 0:A.value)===n(N).REVOKE?(o(),d(L,{key:4},{default:e(()=>[t(V,{class:"is-loading color-primary"},{default:e(()=>[t(B)]),_:1}),m(" "+s(h[$.value.value]($.value.key)),1)]),_:1})):S("",!0)]}),_:1},8,["visible"])}}}),_l={class:"dialog-footer"},kl=ye({__name:"EmbeddingContentDialog",setup(W,{expose:I}){const H=g(!1),u=g("error"),$={all:["0","1","2","3","4","5","n"],error:["0","1","3","4","5","n"]},Q=g(),C=()=>{Q.value&&Q.value($[u.value]),p()},h=a=>{Q.value=a,H.value=!0},p=()=>{Q.value=void 0,H.value=!1};return I({open:h,close:p}),(a,f)=>{const V=i("el-radio"),L=i("el-radio-group"),_=i("el-button"),B=i("el-dialog");return o(),d(B,{modelValue:H.value,"onUpdate:modelValue":f[1]||(f[1]=M=>H.value=M),title:a.$t("components.selectParagraph.title"),"before-close":p,width:"450"},{footer:e(()=>[D("div",_l,[t(_,{onClick:p},{default:e(()=>[m(s(a.$t("common.cancel")),1)]),_:1}),t(_,{type:"primary",onClick:C},{default:e(()=>[m(s(a.$t("common.submit")),1)]),_:1})])]),default:e(()=>[t(L,{modelValue:u.value,"onUpdate:modelValue":f[0]||(f[0]=M=>u.value=M),class:"radio-block"},{default:e(()=>[t(V,{value:"error",size:"large"},{default:e(()=>[m(s(a.$t("components.selectParagraph.error")),1)]),_:1}),t(V,{value:"all",size:"large"},{default:e(()=>[m(s(a.$t("components.selectParagraph.all")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue","title"])}}}),hl={class:"dialog-footer"},bl=ye({__name:"CreateTagDialog",emits:["refresh"],setup(W,{expose:I,emit:H}){const u=Te(),{params:{id:$}}=u,Q=H,C=ne(()=>u.path.includes("shared")?"systemShare":u.path.includes("resource-management")?"systemManage":"workspace"),h=g(),p=g(!1),a=g(!1),f=g(null),V=g([]),L=()=>{f.value?V.value.push({key:f.value}):V.value.push({})},_=q=>{V.value.splice(q,1)},B=()=>{h.value.validate(q=>{q&&O({type:"knowledge",systemType:C.value}).postTags($,V.value,p).then(r=>{K(),Q("refresh",f.value)})})},M=q=>{const r=Le.cloneDeep(q);a.value=!0,f.value=r?r.key:null,V.value=r?[{key:r.key}]:[{}]},K=()=>{a.value=!1};return I({open:M,close:K}),(q,r)=>{const b=i("el-input"),z=i("el-form-item"),A=i("el-col"),ae=i("AppIcon"),E=i("el-button"),c=i("el-row"),G=i("el-scrollbar"),Z=i("el-form"),j=i("el-dialog");return o(),d(j,{modelValue:a.value,"onUpdate:modelValue":r[1]||(r[1]=R=>a.value=R),title:f.value?q.$t("views.document.tag.addValue"):q.$t("views.document.tag.create"),"before-close":K,"append-to-body":""},{footer:e(()=>[D("div",hl,[t(E,{onClick:K},{default:e(()=>[m(s(q.$t("common.cancel")),1)]),_:1}),t(E,{type:"primary",onClick:B},{default:e(()=>[m(s(q.$t("common.confirm")),1)]),_:1})])]),default:e(()=>[t(Z,{ref_key:"FormRef",ref:h,model:{tags:V.value},"label-position":"top","require-asterisk-position":"right",onSubmit:r[0]||(r[0]=ee(()=>{},["prevent"]))},{default:e(()=>[t(G,null,{default:e(()=>[t(c,{gutter:8,style:{"margin-right":"10px"},class:"tag-list-max-list"},{default:e(()=>[(o(!0),X(ce,null,Ee(V.value,(R,le)=>(o(),X(ce,{key:R},[t(A,{span:12},{default:e(()=>[t(z,{label:le===0?q.$t("views.document.tag.key"):"",prop:`tags.${le}.key`,rules:{required:!0,message:q.$t("views.document.tag.requiredMessage1"),trigger:"blur"}},{default:e(()=>[t(b,{modelValue:R.key,"onUpdate:modelValue":y=>R.key=y,disabled:!!f.value,class:"w-full",placeholder:q.$t("views.document.tag.requiredMessage1")},null,8,["modelValue","onUpdate:modelValue","disabled","placeholder"])]),_:2},1032,["label","prop","rules"])]),_:2},1024),t(A,{span:11},{default:e(()=>[t(z,{label:le===0?q.$t("views.document.tag.value"):"",prop:`tags.${le}.value`,rules:{required:!0,message:q.$t("views.document.tag.requiredMessage2"),trigger:"blur"},class:"w-full"},{default:e(()=>[t(b,{modelValue:R.value,"onUpdate:modelValue":y=>R.value=y,placeholder:q.$t("views.document.tag.requiredMessage2")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label","prop","rules"])]),_:2},1024),t(A,{span:1},{default:e(()=>[t(E,{disabled:V.value.length===1,link:"",type:"info",onClick:y=>_(le),style:Be({marginTop:le===0?"35px":"5px"})},{default:e(()=>[t(ae,{iconName:"app-delete"})]),_:2},1032,["disabled","onClick","style"])]),_:2},1024)],64))),128))]),_:1})]),_:1})]),_:1},8,["model"]),t(E,{link:"",type:"primary",onClick:L},{default:e(()=>[t(ae,{iconName:"app-add-outlined",class:"mr-4"}),m(" "+s(q.$t("common.add")),1)]),_:1})]),_:1},8,["modelValue","title"])}}}),ct=ut(bl,[["__scopeId","data-v-76dc2830"]]),wl={class:"w-full text-left cursor"},$l={class:"w-full text-left cursor"},Cl={class:"dialog-footer"},rt=ye({__name:"MulAddTagDialog",props:{apiType:{}},emits:["addTags"],setup(W,{expose:I,emit:H}){const u=H,$=W,Q=Te(),{params:{id:C,folderId:h}}=Q,p=ne(()=>h==="share"),a=g(!1),f=g(),V=g(!1),L=g([]),_=g(),B=()=>{L.value.push({})},M=c=>{L.value.splice(c,1)};function K(c){c.value=null}function q(c){let G=null;return c&&c.key&&(G=_.value.find(Z=>Z.key===c.key)),G?G.values:[]}const r=()=>{f.value.validate(c=>{c&&u("addTags",L.value.map(G=>G.value))})};function b(c){O({type:"knowledge",systemType:$.apiType,isShared:p.value}).getTags(C,{},a).then(G=>{_.value=G.data})}const z=g();function A(c){var G;(G=z.value)==null||G.open(c)}const ae=()=>{b(),V.value=!0,L.value=[{}]},E=()=>{V.value=!1};return I({open:ae,close:E}),(c,G)=>{const Z=i("el-option"),j=i("AppIcon"),R=i("el-button"),le=i("el-select"),y=i("el-form-item"),F=i("el-col"),P=i("el-row"),J=i("el-scrollbar"),de=i("el-form"),me=i("el-dialog");return o(),d(me,{modelValue:V.value,"onUpdate:modelValue":G[2]||(G[2]=ue=>V.value=ue),title:c.$t("views.document.tag.addTag"),"before-close":E,"close-on-click-modal":!1,"close-on-press-escape":!1},{footer:e(()=>[D("div",Cl,[t(R,{onClick:E},{default:e(()=>[m(s(c.$t("common.cancel")),1)]),_:1}),t(R,{type:"primary",onClick:r},{default:e(()=>[m(s(c.$t("common.confirm")),1)]),_:1})])]),default:e(()=>[t(de,{ref_key:"FormRef",ref:f,model:{tagList:L.value},"label-position":"top","require-asterisk-position":"right",onSubmit:G[1]||(G[1]=ee(()=>{},["prevent"]))},{default:e(()=>[t(J,null,{default:e(()=>[t(P,{gutter:8,style:{"margin-right":"10px"},class:"tag-list-max-list"},{default:e(()=>[(o(!0),X(ce,null,Ee(L.value,(ue,pe)=>(o(),X(ce,{key:ue},[t(F,{span:12},{default:e(()=>[t(y,{label:pe===0?c.$t("views.document.tag.key"):"",prop:`tagList.${pe}.key`,rules:{required:!0,message:c.$t("views.document.tag.requiredMessage1"),trigger:"blur"}},{default:e(()=>[t(le,{modelValue:ue.key,"onUpdate:modelValue":oe=>ue.key=oe,onChange:oe=>K(ue),filterable:"",placeholder:c.$t("views.document.tag.requiredMessage1"),loading:a.value},{footer:e(()=>[lt(c.$slots,"footer",{},()=>[D("div",wl,[t(R,{type:"primary",link:"",onClick:G[0]||(G[0]=oe=>A())},{default:e(()=>[t(j,{iconName:"app-add-outlined",class:"mr-4"}),m(" "+s(c.$t("views.document.tag.create")),1)]),_:1})])])]),default:e(()=>[(o(!0),X(ce,null,Ee(_.value,oe=>(o(),d(Z,{key:oe,value:oe.key,label:oe.key},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange","placeholder","loading"])]),_:2},1032,["label","prop","rules"])]),_:2},1024),t(F,{span:11},{default:e(()=>[t(y,{label:pe===0?c.$t("views.document.tag.value"):"",prop:`tagList.${pe}.value`,rules:{required:!0,message:c.$t("views.document.tag.requiredMessage2"),trigger:"blur"}},{default:e(()=>[t(le,{modelValue:ue.value,"onUpdate:modelValue":oe=>ue.value=oe,filterable:"",placeholder:c.$t("views.document.tag.requiredMessage2")},{footer:e(()=>[lt(c.$slots,"footer",{},()=>[D("div",$l,[t(R,{type:"primary",link:"",onClick:oe=>A(ue)},{default:e(()=>[t(j,{iconName:"app-add-outlined",class:"mr-4"}),m(" "+s(c.$t("views.document.tag.createValue")),1)]),_:2},1032,["onClick"])])])]),default:e(()=>[(o(!0),X(ce,null,Ee(q(ue),oe=>(o(),d(Z,{key:oe,value:oe.id,label:oe.value},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label","prop","rules"])]),_:2},1024),t(F,{span:1},{default:e(()=>[t(R,{disabled:L.value.length===1,text:"",onClick:oe=>M(pe),style:Be({marginTop:pe===0?"35px":"5px"})},{default:e(()=>[t(j,{iconName:"app-delete"})]),_:2},1032,["disabled","onClick","style"])]),_:2},1024)],64))),128))]),_:3})]),_:3})]),_:3},8,["model"]),t(R,{link:"",type:"primary",onClick:B},{default:e(()=>[t(j,{iconName:"app-add-outlined",class:"mr-4"}),m(" "+s(c.$t("common.add")),1)]),_:1}),t(ct,{ref_key:"createTagDialogRef",ref:z,onRefresh:b},null,512)]),_:3},8,["modelValue","title"])}}}),Tl={class:"flex-between mb-16"},Sl={class:"flex-between"},El=ye({__name:"TagSettingDrawer",emits:["refresh"],setup(W,{expose:I,emit:H}){const u=Te(),{params:{id:$,folderId:Q}}=u,C=ne(()=>u.path.includes("shared")?"systemShare":u.path.includes("resource-management")?"systemManage":"workspace");ne(()=>Q==="share");const h=g(""),p=g(!1),a=g(!1),f=g(""),V=g([]),L=ne(()=>{const E=[];return V.value.forEach(c=>{c.values&&c.values.length>0&&c.values.forEach((G,Z)=>{E.push({id:G.id,key:c.key,value:G.value,keyIndex:Z})})}),E}),_=({row:E,column:c,rowIndex:G,columnIndex:Z})=>{if(Z===0||Z===1)return E.keyIndex===0?{rowspan:L.value.filter(R=>R.key===E.key).length,colspan:1}:{rowspan:0,colspan:0}},B=g([]),M=E=>{B.value=E};function K(){const E=B.value.reduce((c,G)=>{const j=L.value.filter(R=>R.key===G.key).map(R=>R.id);return[...c,...j]},[]);O({type:"document",systemType:C.value}).delMulDocumentTag($,h.value,E,p).then(()=>{r()})}function q(E){O({type:"document",systemType:C.value}).delMulDocumentTag($,h.value,[E.id],p).then(()=>{r()})}function r(){const E={...f.value&&{name:f.value}};O({type:"document",systemType:C.value}).getDocumentTags($,h.value,E,p).then(c=>{V.value=c.data})}const b=g();function z(){var E;(E=b.value)==null||E.open()}function A(E){O({type:"document",systemType:C.value}).postDocumentTags($,h.value,E,p).then(()=>{var c;(c=b.value)==null||c.close(),r()})}return I({open:E=>{f.value="",a.value=!0,h.value=E.id,r()}}),(E,c)=>{const G=i("el-button"),Z=i("el-input"),j=i("el-table-column"),R=i("AppIcon"),le=i("el-tooltip"),y=i("el-table"),F=i("el-drawer"),P=Fe("loading");return o(),X(ce,null,[t(F,{modelValue:a.value,"onUpdate:modelValue":c[2]||(c[2]=J=>a.value=J),size:"60%","append-to-body":!0},{header:e(()=>[D("h4",null,s(E.$t("views.document.tag.setting")),1)]),default:e(()=>[D("div",Tl,[D("div",null,[t(G,{type:"primary",onClick:c[0]||(c[0]=J=>z())},{default:e(()=>[m(s(E.$t("views.document.tag.addTag")),1)]),_:1}),t(G,{disabled:B.value.length===0,onClick:K},{default:e(()=>[m(s(E.$t("common.delete")),1)]),_:1},8,["disabled"])]),t(Z,{modelValue:f.value,"onUpdate:modelValue":c[1]||(c[1]=J=>f.value=J),"prefix-icon":"Search",class:"w-240",onChange:r,clearable:"",placeholder:E.$t("common.search")},null,8,["modelValue","placeholder"])]),Ge((o(),d(y,{data:L.value,"span-method":_,onSelectionChange:M},{default:e(()=>[t(j,{type:"selection",width:"55"}),t(j,{label:E.$t("views.document.tag.key")},{default:e(({row:J})=>[D("div",Sl,s(J.key),1)]),_:1},8,["label"]),t(j,{label:E.$t("views.document.tag.value"),"class-name":"border-l"},{default:e(({row:J})=>[m(s(J.value),1)]),_:1},8,["label"]),t(j,{label:E.$t("common.operation"),align:"left",width:"100",fixed:"right"},{default:e(({row:J})=>[t(le,{effect:"dark",content:E.$t("common.delete")},{default:e(()=>[t(G,{type:"primary",text:"",onClick:ee(de=>q(J),["stop"])},{default:e(()=>[t(R,{iconName:"app-delete"})]),_:2},1032,["onClick"])]),_:2},1032,["content"])]),_:1},8,["label"])]),_:1},8,["data"])),[[P,p.value]])]),_:1},8,["modelValue"]),t(rt,{ref_key:"addTagDialogRef",ref:b,onAddTags:A,apiType:C.value},null,8,["apiType"])],64)}}}),Dl={class:"dialog-footer"},Ml=ye({__name:"EditTagDialog",emits:["refresh"],setup(W,{expose:I,emit:H}){const u=Te(),{params:{id:$}}=u,Q=H,C=ne(()=>u.path.includes("shared")?"systemShare":u.path.includes("resource-management")?"systemManage":"workspace"),h=g(),p=g(!1),a=g({id:"",key:"",value:""}),f=g(!1),V=g(!1),L=()=>{h.value.validate(M=>{M&&O({type:"knowledge",systemType:C.value}).putTag($,a.value.id,a.value,f).then(K=>{B(),Q("refresh")})})},_=(M,K)=>{V.value=!0,a.value.id=M.id,a.value.key=M.key,a.value.value=M.value,p.value=K},B=()=>{V.value=!1};return I({open:_,close:B}),(M,K)=>{const q=i("el-input"),r=i("el-form-item"),b=i("el-col"),z=i("el-row"),A=i("el-form"),ae=i("el-button"),E=i("el-dialog");return o(),d(E,{modelValue:V.value,"onUpdate:modelValue":K[4]||(K[4]=c=>V.value=c),title:p.value?M.$t("views.document.tag.edit"):M.$t("views.document.tag.editValue"),"before-close":B,width:p.value?"500px":"50%"},{footer:e(()=>[D("div",Dl,[t(ae,{onClick:B},{default:e(()=>[m(s(M.$t("common.cancel")),1)]),_:1}),t(ae,{type:"primary",onClick:L},{default:e(()=>[m(s(M.$t("common.confirm")),1)]),_:1})])]),default:e(()=>[t(A,{ref_key:"FormRef",ref:h,model:a.value,"label-position":"top","require-asterisk-position":"right",onSubmit:K[3]||(K[3]=ee(()=>{},["prevent"]))},{default:e(()=>[p.value?(o(),d(r,{key:0,label:M.$t("views.document.tag.key"),rules:{required:!0,message:M.$t("views.document.tag.requiredMessage1"),trigger:"blur"},prop:"key"},{default:e(()=>[t(q,{modelValue:a.value.key,"onUpdate:modelValue":K[0]||(K[0]=c=>a.value.key=c)},null,8,["modelValue"])]),_:1},8,["label","rules"])):(o(),d(z,{key:1,gutter:8,align:"bottom"},{default:e(()=>[t(b,{span:12},{default:e(()=>[t(r,{label:M.$t("views.document.tag.key"),prop:"key",rules:{required:!0,message:M.$t("views.document.tag.requiredMessage1"),trigger:"blur"}},{default:e(()=>[t(q,{modelValue:a.value.key,"onUpdate:modelValue":K[1]||(K[1]=c=>a.value.key=c),disabled:!0},null,8,["modelValue"])]),_:1},8,["label","rules"])]),_:1}),t(b,{span:12},{default:e(()=>[t(r,{label:M.$t("views.document.tag.value"),prop:"value",rules:{required:!0,message:M.$t("views.document.tag.requiredMessage2"),trigger:"blur"}},{default:e(()=>[t(q,{modelValue:a.value.value,"onUpdate:modelValue":K[2]||(K[2]=c=>a.value.value=c)},null,8,["modelValue"])]),_:1},8,["label","rules"])]),_:1})]),_:1}))]),_:1},8,["model"])]),_:1},8,["modelValue","title","width"])}}}),Rl={class:"flex-between mb-16"},Vl={class:"flex-between"},Nl={key:0},Il={class:"mr-4"},Ul={class:"mr-4"},Al={class:"flex-between"},Ll={class:"mr-4"},Bl=ye({__name:"TagDrawer",emits:["refresh"],setup(W,{expose:I,emit:H}){const u=Te(),{params:{id:$,folderId:Q}}=u,C=ne(()=>Q==="share"),h=ne(()=>u.path.includes("shared")?"systemShare":u.path.includes("resource-management")?"systemManage":"workspace"),p=ne(()=>it.knowledge[h.value]),a=g(!1),f=g(!1),V=g(""),L=g([]),_=g(null);function B(y){_.value=y.id}function M(){_.value=null}const K=ne(()=>{const y=[];return L.value.forEach(F=>{F.values&&F.values.length>0&&F.values.forEach((P,J)=>{y.push({id:P.id,key:F.key,value:P.value,keyIndex:J})})}),y}),q=({row:y,column:F,rowIndex:P,columnIndex:J})=>{if(J===0||J===1)return y.keyIndex===0?{rowspan:K.value.filter(me=>me.key===y.key).length,colspan:1}:{rowspan:0,colspan:0}},r=g([]),b=y=>{r.value=y},z=g();function A(y){var F;(F=z.value)==null||F.open(y)}function ae(){he(k("views.document.tag.deleteConfirm"),k("views.document.tag.deleteTip"),{confirmButtonText:k("common.delete"),confirmButtonClass:"danger"}).then(()=>{const y=r.value.map(F=>F.id);O({type:"knowledge",systemType:h.value}).delMulTag($,y).then(()=>{R()})}).catch(()=>{})}const E=g();function c(y){var F;(F=E.value)==null||F.open(y,!0)}function G(y){he(k("views.document.tag.deleteConfirm")+y.key,k("views.document.tag.deleteTip"),{confirmButtonText:k("common.delete"),confirmButtonClass:"danger"}).then(()=>{O({type:"knowledge",systemType:h.value}).delTag($,y.id,"key").then(()=>{R()})}).catch(()=>{})}function Z(y){var F;(F=E.value)==null||F.open(y,!1)}function j(y){he(k("views.document.tag.deleteConfirm")+y.value,k("views.document.tag.deleteTip"),{confirmButtonText:k("common.delete"),confirmButtonClass:"danger"}).then(()=>{O({type:"knowledge",systemType:h.value}).delTag($,y.id,"one").then(()=>{R()})}).catch(()=>{})}function R(){const y={...V.value&&{name:V.value}};O({type:"knowledge",systemType:h.value,isShared:C.value}).getTags($,y,a).then(F=>{L.value=F.data})}return I({open:()=>{V.value="",f.value=!0,R()}}),(y,F)=>{const P=i("el-button"),J=i("el-input"),de=i("el-table-column"),me=i("AppIcon"),ue=i("el-tooltip"),pe=i("el-table"),oe=i("el-drawer"),De=Fe("loading");return o(),X(ce,null,[t(oe,{modelValue:f.value,"onUpdate:modelValue":F[2]||(F[2]=ie=>f.value=ie),size:"60%","append-to-body":!0},{header:e(()=>[D("h4",null,s(y.$t("views.document.tag.label")),1)]),default:e(()=>[D("div",Rl,[D("div",null,[p.value.tag_create(n($))?(o(),d(P,{key:0,type:"primary",onClick:F[0]||(F[0]=ie=>A())},{default:e(()=>[m(s(y.$t("views.document.tag.create")),1)]),_:1})):S("",!0),p.value.tag_delete(n($))?(o(),d(P,{key:1,disabled:r.value.length===0,onClick:ae},{default:e(()=>[m(s(y.$t("common.delete")),1)]),_:1},8,["disabled"])):S("",!0)]),t(J,{modelValue:V.value,"onUpdate:modelValue":F[1]||(F[1]=ie=>V.value=ie),"prefix-icon":"Search",class:"w-240",onChange:R,clearable:"",placeholder:y.$t("common.search")},null,8,["modelValue","placeholder"])]),Ge((o(),d(pe,{data:K.value,"span-method":q,onSelectionChange:b,onCellMouseEnter:B,onCellMouseLeave:M},{default:e(()=>[t(de,{type:"selection",width:"55"}),t(de,{label:y.$t("views.document.tag.key")},{default:e(({row:ie})=>[D("div",Vl,[m(s(ie.key)+" ",1),_.value===ie.id?(o(),X("div",Nl,[D("span",Il,[t(ue,{effect:"dark",content:y.$t("views.document.tag.addValue")},{default:e(()=>[p.value.tag_create(n($))?(o(),d(P,{key:0,type:"primary",text:"",onClick:ee(be=>A(ie),["stop"])},{default:e(()=>[t(me,{iconName:"app-add-outlined"})]),_:2},1032,["onClick"])):S("",!0)]),_:2},1032,["content"])]),D("span",Ul,[t(ue,{effect:"dark",content:y.$t("views.document.tag.edit")},{default:e(()=>[p.value.tag_edit(n($))?(o(),d(P,{key:0,type:"primary",text:"",onClick:ee(be=>c(ie),["stop"])},{default:e(()=>[t(me,{iconName:"app-edit"})]),_:2},1032,["onClick"])):S("",!0)]),_:2},1032,["content"])]),t(ue,{effect:"dark",content:y.$t("common.delete")},{default:e(()=>[p.value.tag_delete(n($))?(o(),d(P,{key:0,type:"primary",text:"",onClick:ee(be=>G(ie),["stop"])},{default:e(()=>[t(me,{iconName:"app-delete"})]),_:2},1032,["onClick"])):S("",!0)]),_:2},1032,["content"])])):S("",!0)])]),_:1},8,["label"]),t(de,{label:y.$t("views.document.tag.value"),"class-name":"border-l"},{default:e(({row:ie})=>[D("div",Al,s(ie.value),1)]),_:1},8,["label"]),t(de,{label:y.$t("common.operation"),align:"left",width:"100",fixed:"right"},{default:e(({row:ie})=>[D("span",Ll,[t(ue,{effect:"dark",content:y.$t("views.document.tag.editValue")},{default:e(()=>[p.value.tag_edit(n($))?(o(),d(P,{key:0,type:"primary",text:"",onClick:ee(be=>Z(ie),["stop"])},{default:e(()=>[t(me,{iconName:"app-edit"})]),_:2},1032,["onClick"])):S("",!0)]),_:2},1032,["content"])]),t(ue,{effect:"dark",content:y.$t("common.delete")},{default:e(()=>[p.value.tag_delete(n($))?(o(),d(P,{key:0,type:"primary",text:"",onClick:ee(be=>j(ie),["stop"])},{default:e(()=>[t(me,{iconName:"app-delete"})]),_:2},1032,["onClick"])):S("",!0)]),_:2},1032,["content"])]),_:1},8,["label"])]),_:1},8,["data"])),[[De,a.value]])]),_:1},8,["modelValue"]),t(ct,{ref_key:"createTagDialogRef",ref:z,onRefresh:R},null,512),t(Ml,{ref_key:"editTagDialogRef",ref:E,onRefresh:R},null,512)],64)}}}),Fl={class:"document p-16-24"},Gl={class:"mb-16"},Kl={class:"main-calc-height"},ql={class:"p-24"},Pl={class:"flex-between"},Hl={class:"flex"},Ol={class:"flex-between complex-search"},zl={key:1},jl={key:0,class:"flex align-center"},Wl={class:"color-secondary"},Ql={key:1,class:"flex align-center"},Zl={class:"color-secondary"},Yl={class:"mr-4"},Jl={key:0,class:"mr-4"},Xl={class:"mr-4"},xl={class:"mr-4"},ea={class:"mr-4"},ta={class:"mr-4"},la={key:0,class:"mul-operation w-full flex"},Ce="documents",aa=ye({__name:"index",setup(W){const I=Te(),H=Zt(),{params:{id:u,folderId:$,type:Q}}=I,{common:C}=st();Yt(()=>{C.savePage(Ce,null),C.saveCondition(Ce,null)}),Jt(l=>{l.name!=="Paragraph"?(C.savePage(Ce,null),C.saveCondition(Ce,null)):C.saveCondition(Ce,{filterText:E.value,filterMethod:c.value})});const h=ne(()=>$==="share"),p=ne(()=>I.path.includes("shared")?"systemShare":I.path.includes("resource-management")?"systemManage":I.path.includes("share/")?"workspaceShare":"workspace"),a=ne(()=>it.knowledge[p.value]),f=l=>a.value.doc_edit(l)||(R==null?void 0:R.value.type)===1&&a.value.doc_sync(l)||(R==null?void 0:R.value.type)===2&&a.value.doc_sync(l)||a.value.doc_delete(l)||a.value.doc_tag(l),V=l=>a.value.doc_generate(l)||a.value.doc_migrate(l)||a.value.doc_export(l)||a.value.doc_download(l)||a.value.doc_delete(l)||a.value.doc_tag(l)||a.value.doc_replace(l),L=l=>a.value.doc_edit(l)||a.value.doc_generate(l)||a.value.doc_migrate(l)||a.value.doc_export(l)||a.value.doc_delete(l),_=(l,v)=>{const T=l.split("").reverse();return v-1>T.length+1?"n":T[v-1]},B=g("name"),M=g({name:"",tag:""}),K=g(),q=ne(()=>C.paginationConfig[Ce]),r=ne(()=>C.search[Ce]),b=g(),z=g(),A=g(!1);let ae;const E=g(""),c=g({}),G=g(""),Z=g([]),j=g(null),R=g({}),le=g({current_page:1,page_size:10,total:0}),y=g(),F=g(),P=g([]),J=g(""),de=g(),me=()=>{var l;(l=K.value)==null||l.open(u)},ue=()=>{R.value.workFlow?H.push({path:`/knowledge/import/workflow/${$}`,query:{id:u}}):he(k("common.tip"),k("views.document.tip.toImportDocConfirm"),{cancelButtonText:k("common.close"),showConfirmButton:!1,type:"warning"}).then(()=>{}).catch(()=>{})},pe=l=>{O({type:"document",systemType:p.value}).exportDocument(l.name,l.knowledgeId,l.id,A).then(()=>{re(k("common.exportSuccess"))})},oe=l=>{O({type:"document",systemType:p.value}).exportDocumentZip(l.name,l.knowledgeId,l.id,A).then(()=>{re(k("common.exportSuccess"))})};function De(l){const v=[];P.value.map(U=>{U&&v.push(U.id)});const T={idList:v,type:l};O({type:"document",systemType:p.value}).putBatchCancelTask(u,T,A).then(()=>{var U;re(k("views.document.tip.cancelSuccess")),(U=F.value)==null||U.clearSelection()})}function ie(){var l;(l=F.value)==null||l.clearSelection()}function be(l){const v=[];l?v.push(l.id):P.value.map(T=>{T&&v.push(T.id)}),de.value.open(v)}function Ie(l){c.value[l.attr]=l.command,l.attr=="status"&&(c.value.task_type=l.task_type),se()}function ve(l,v,T){return{attr:l,command:v,task_type:T}}const Me=(l,v)=>{O({type:"document",systemType:p.value}).putCancelTask(u,l.id,{type:v}).then(()=>{re(k("views.document.tip.sendMessage"))})};function dt(){J.value=k("views.document.importDocument"),y.value.open()}function Ke(l){J.value=k("common.setting"),y.value.open(l)}const mt=l=>{P.value=l};function pt(){J.value=k("common.setting");const l=P.value.map(v=>v.id);y.value.open(null,l)}const vt=()=>{ae=setInterval(()=>{se(!0)},6e3)},ft=()=>{ae&&clearInterval(ae)};function gt(l){+l.type==1?_t(l):yt(l)}function yt(l){he(k("views.document.sync.confirmTitle"),k("views.document.sync.confirmMessage1"),{confirmButtonText:k("views.document.sync.label"),confirmButtonClass:"danger"}).then(()=>{O({type:"document",systemType:p.value}).putLarkDocumentSync(u,l.id).then(()=>{se()})}).catch(()=>{})}function _t(l){var v;(v=l.meta)!=null&&v.sourceUrl?he(k("views.document.sync.confirmTitle"),k("views.document.sync.confirmMessage1"),{confirmButtonText:k("views.document.sync.label"),confirmButtonClass:"danger"}).then(()=>{O({type:"document",systemType:p.value}).putDocumentSync(l.knowledgeId,l.id).then(()=>{se()})}).catch(()=>{}):he(k("common.tip"),k("views.document.sync.confirmMessage2"),{confirmButtonText:k("common.confirm"),type:"warning"}).then(()=>{}).catch(()=>{})}function qe(l){var T;const v=U=>O({type:"document",systemType:p.value}).putDocumentRefresh(l.knowledgeId,l.id,U).then(()=>{se()});(T=b.value)==null||T.open(v)}function kt(l,v){v&&v.type==="selection"||H.push({path:`/paragraph/${u}/${l.id}`,query:{from:p.value,isShared:h.value?"true":"false"}})}function ht(l){alert(1),A.value=!0;const v=[{name:l}];O({type:"document",systemType:p.value}).putMulDocument(u,v).then(()=>{se(),re(k("common.createSuccess"))}).catch(()=>{A.value=!1})}function bt(){const l=[];P.value.map(v=>{v&&l.push(v.id)}),O({type:"document",systemType:p.value}).putMulSyncDocument(u,l,A).then(()=>{re(k("views.document.sync.successMessage")),se()})}function wt(){he(`${k("views.document.delete.confirmTitle1")} ${P.value.length} ${k("views.document.delete.confirmTitle2")}`,k("views.document.delete.confirmMessage"),{confirmButtonText:k("common.confirm"),confirmButtonClass:"danger"}).then(()=>{const l=[];P.value.map(v=>{v&&l.push(v.id)}),O({type:"document",systemType:p.value}).delMulDocument(u,l,A).then(()=>{var v;re(k("views.document.delete.successMessage")),(v=F.value)==null||v.clearSelection(),se()})}).catch(()=>{})}function $t(){var T;const l=P.value.map(U=>U.id),v=U=>{O({type:"document",systemType:p.value}).putBatchRefresh(u,l,U,A).then(()=>{var fe;re(k("views.document.tip.vectorizationSuccess")),(fe=F.value)==null||fe.clearSelection()})};(T=b.value)==null||T.open(v)}function Ct(l){O({type:"document",systemType:p.value}).getDownloadSourceFile(u,l.id,l.name).then(()=>{se()})}const Pe=g();function Tt(l,v){const T=new FormData;T.append("file",l.raw,l.name),Pe.value.clearFiles(),O({type:"document",systemType:p.value}).postReplaceSourceFile(u,v.id,T,A).then(()=>{re(k("views.document.tip.replaceSuccess")),se()}).catch(U=>{})}function He(l){he(`${k("views.document.delete.confirmTitle3")} ${l.name} ?`,`${k("views.document.delete.confirmMessage1")} ${l.paragraphCount} ${k("views.document.delete.confirmMessage2")}`,{confirmButtonText:k("common.confirm"),confirmButtonClass:"danger"}).then(()=>{O({type:"document",systemType:p.value}).delDocument(u,l.id,A).then(()=>{re(k("common.deleteSuccess")),se()})}).catch(()=>{})}function Oe(l,v,T){O({type:"document",systemType:p.value}).putDocument(u,l,v,A).then(U=>{const fe=Z.value.findIndex(we=>we.id===l);return Z.value.splice(fe,1,U.data),re(T),!0}).catch(()=>!1)}async function St(l){const v={isActive:!l.isActive},T=l.isActive?k("common.status.disableSuccess"):k("common.status.enableSuccess");await Oe(l.id,v,T)}function Et(l,v){l?Oe(v,{name:l},k("common.modifySuccess")):al(k("views.document.tip.nameMessage"))}function Dt(l){j.value=l.id}function Mt(){j.value=null}function Rt(){le.value.current_page=1,se()}function Vt({prop:l,order:v}){G.value=v==="ascending"?l:`-${l}`,se()}function se(l){const v={...E.value&&{name:E.value},...c.value,orderBy:G.value,folderId:$};M.value[B.value]&&(v[B.value]=M.value[B.value]),console.log("getList",v),O({type:"document",isShared:h.value,systemType:p.value}).getDocumentPage(u,le.value,v,l?void 0:A).then(T=>{Z.value=T.data.records,console.log(Z.value),le.value.total=T.data.total})}function Nt(){O({type:"knowledge",isShared:h.value,systemType:p.value}).getKnowledgeDetail(u,A).then(l=>{R.value=l.data})}function It(){var l;(l=F.value)==null||l.clearSelection(),se()}function Re(){le.value.current_page=1,se()}const ze=g();function Ue(l){const v=[];l?v.push(l.id):P.value.map(T=>{T&&v.push(T.id)}),ze.value.open(v,"document")}const Ut=g(),At=g(),je=g();function Lt(l){const v=P.value.map(T=>T.id);O({type:"document",systemType:p.value}).postMulDocumentTags(u,{tag_ids:l,document_ids:v},A).then(()=>{var T;(T=je.value)==null||T.close(),se(),ie()})}return Xt(()=>{Nt(),q.value&&(le.value=q.value),r.value&&(E.value=r.value.filterText,c.value=r.value.filterMethod),se(),vt()}),xt(()=>{ft()}),(l,v)=>{var Ze;const T=i("el-button"),U=i("el-dropdown-item"),fe=i("el-dropdown-menu"),we=i("el-dropdown"),We=i("el-input"),Se=i("el-tooltip"),_e=i("el-table-column"),Ae=i("Filter"),$e=i("el-icon"),Bt=i("SuccessFilled"),Ft=i("el-switch"),Gt=i("el-divider"),Qe=i("Close"),Kt=i("Download"),qt=i("Upload"),Pt=i("el-upload"),Ht=i("el-card"),Ot=i("el-text"),zt=Fe("loading");return o(),X("div",Fl,[D("h2",Gl,s(l.$t("common.fileUpload.document")),1),t(Ht,{style:{"--el-card-padding":"0"}},{default:e(()=>{var Ve,Ye,Je,Xe;return[D("div",Kl,[D("div",ql,[D("div",Pl,[D("div",null,[h.value?S("",!0):(o(),X(ce,{key:0},[((Ve=R.value)==null?void 0:Ve.type)===0&&a.value.doc_create(n(u))?(o(),d(T,{key:0,type:"primary",onClick:v[0]||(v[0]=w=>n(H).push({path:`/knowledge/document/upload/${n($)}/${n(Q)}`,query:{id:n(u)}}))},{default:e(()=>[m(s(l.$t("views.document.uploadDocument")),1)]),_:1})):S("",!0),((Ye=R.value)==null?void 0:Ye.type)===1&&a.value.doc_create(n(u))?(o(),d(T,{key:1,type:"primary",onClick:dt},{default:e(()=>[m(s(l.$t("views.document.importDocument")),1)]),_:1})):S("",!0),((Je=R.value)==null?void 0:Je.type)===2&&a.value.doc_create(n(u))?(o(),d(T,{key:2,type:"primary",onClick:ue},{default:e(()=>[m(s(l.$t("views.document.importDocument")),1)]),_:1})):S("",!0),a.value.doc_vector(n(u))?(o(),d(T,{key:3,onClick:$t,disabled:P.value.length===0},{default:e(()=>[m(s(l.$t("views.knowledge.setting.vectorization")),1)]),_:1},8,["disabled"])):S("",!0),a.value.doc_generate(n(u))?(o(),d(T,{key:4,onClick:v[1]||(v[1]=w=>Ue()),disabled:P.value.length===0},{default:e(()=>[m(s(l.$t("views.document.generateQuestion.title")),1)]),_:1},8,["disabled"])):S("",!0),a.value.doc_edit(n(u))?(o(),d(T,{key:5,onClick:pt,disabled:P.value.length===0},{default:e(()=>[m(s(l.$t("common.setting")),1)]),_:1},8,["disabled"])):S("",!0),f(n(u))?(o(),d(we,{key:6},{dropdown:e(()=>[t(fe,null,{default:e(()=>{var w;return[a.value.doc_migrate(n(u))?(o(),d(U,{key:0,onClick:v[2]||(v[2]=ke=>be()),disabled:P.value.length===0},{default:e(()=>[m(s(l.$t("views.document.setting.migration")),1)]),_:1},8,["disabled"])):S("",!0),((w=R.value)==null?void 0:w.type)===1&&a.value.doc_sync(n(u))?(o(),d(U,{key:1,divided:"",onClick:bt,disabled:P.value.length===0},{default:e(()=>[m(s(l.$t("views.document.syncDocument")),1)]),_:1},8,["disabled"])):S("",!0),a.value.doc_delete(n(u))?(o(),d(U,{key:2,divided:"",onClick:wt,disabled:P.value.length===0},{default:e(()=>[m(s(l.$t("common.delete")),1)]),_:1},8,["disabled"])):S("",!0)]}),_:1})]),default:e(()=>[t(T,{class:"ml-12 mr-12"},{default:e(()=>[t(te,{iconName:"app-more"})]),_:1})]),_:1})):S("",!0)],64))]),D("div",Hl,[D("div",Ol,[B.value==="name"?(o(),d(We,{key:0,modelValue:M.value.name,"onUpdate:modelValue":v[3]||(v[3]=w=>M.value.name=w),"prefix-icon":"Search",onChange:Re,placeholder:l.$t("common.searchBar.placeholder"),style:{width:"220px"},clearable:""},null,8,["modelValue","placeholder"])):S("",!0),B.value==="tag"?(o(),d(We,{key:1,modelValue:M.value.tag,"onUpdate:modelValue":v[4]||(v[4]=w=>M.value.tag=w),onChange:Re,placeholder:l.$t("views.document.tag.requiredMessage3"),style:{width:"220px"},clearable:""},null,8,["modelValue","placeholder"])):S("",!0)]),t(Se,{effect:"dark",content:l.$t("workflow.ExecutionRecord"),placement:"top"},{default:e(()=>[t(T,{onClick:me,class:"ml-12"},{default:e(()=>[t(te,{iconName:"app-execution-record",class:"color-secondary"})]),_:1})]),_:1},8,["content"])])]),Ge((o(),d(el,{ref_key:"multipleTableRef",ref:F,class:"mt-16",data:Z.value,"pagination-config":le.value,"quick-create":((Xe=R.value)==null?void 0:Xe.type)===0&&a.value.doc_create(n(u))&&!h.value,onSizeChange:Rt,onChangePage:se,onCellMouseEnter:Dt,onCellMouseLeave:Mt,onCreatQuick:ht,onRowClick:kt,onSelectionChange:mt,onSortChange:Vt,"row-key":w=>w.id,storeKey:Ce},{default:e(()=>[h.value?S("",!0):(o(),d(_e,{key:0,type:"selection",width:"55","reserve-selection":!0})),t(_e,{prop:"name",label:l.$t("views.document.table.name"),"min-width":"280"},{default:e(({row:w})=>[h.value?(o(),X("span",zl,s(w.name),1)):(o(),d(tl,{key:0,onChange:ke=>Et(ke,w.id),data:w.name,showEditIcon:w.id===j.value},null,8,["onChange","data","showEditIcon"]))]),_:1},8,["label"]),t(_e,{prop:"status",label:l.$t("views.document.fileStatus.label"),width:"130"},{header:e(()=>[D("div",null,[D("span",null,s(l.$t("views.document.fileStatus.label")),1),t(we,{trigger:"click",onCommand:Ie},{dropdown:e(()=>[t(fe,{style:{width:"100px"}},{default:e(()=>[t(U,{class:ge([c.value.status?"":"is-active","justify-center"]),command:ve("status","")},{default:e(()=>[m(s(l.$t("views.document.table.all")),1)]),_:1},8,["class","command"]),t(U,{class:ge([c.value.status===n(N).SUCCESS?"is-active":"","justify-center"]),command:ve("status",n(N).SUCCESS)},{default:e(()=>[m(s(l.$t("views.document.fileStatus.SUCCESS")),1)]),_:1},8,["class","command"]),t(U,{class:ge([c.value.status===n(N).FAILURE?"is-active":"","justify-center"]),command:ve("status",n(N).FAILURE)},{default:e(()=>[m(s(l.$t("views.document.fileStatus.FAILURE")),1)]),_:1},8,["class","command"]),t(U,{class:ge([c.value.status===n(N).STARTED&&c.value.task_type==n(Y).EMBEDDING?"is-active":"","justify-center"]),command:ve("status",n(N).STARTED,n(Y).EMBEDDING)},{default:e(()=>[m(s(l.$t("views.document.fileStatus.EMBEDDING")),1)]),_:1},8,["class","command"]),t(U,{class:ge([c.value.status===n(N).PENDING?"is-active":"","justify-center"]),command:ve("status",n(N).PENDING)},{default:e(()=>[m(s(l.$t("views.document.fileStatus.PENDING")),1)]),_:1},8,["class","command"]),t(U,{class:ge([c.value.status===n(N).STARTED&&c.value.task_type===n(Y).GENERATE_PROBLEM?"is-active":"","justify-center"]),command:ve("status",n(N).STARTED,n(Y).GENERATE_PROBLEM)},{default:e(()=>[m(s(l.$t("views.document.fileStatus.GENERATE")),1)]),_:1},8,["class","command"])]),_:1})]),default:e(()=>[t(T,{style:{"margin-top":"1px"},link:"",type:c.value.status?"primary":""},{default:e(()=>[t($e,null,{default:e(()=>[t(Ae)]),_:1})]),_:1},8,["type"])]),_:1})])]),default:e(({row:w})=>[t(yl,{status:w.status,"status-meta":w.statusMeta},null,8,["status","status-meta"])]),_:1},8,["label"]),t(_e,{prop:"charLength",label:l.$t("views.document.table.char_length"),align:"right","min-width":"90",sortable:""},{default:e(({row:w})=>[m(s(n(ll)(w.charLength)),1)]),_:1},8,["label"]),t(_e,{prop:"paragraphCount",label:l.$t("views.document.table.paragraph"),align:"right","min-width":"90",sortable:""},null,8,["label"]),t(_e,{width:"130"},{header:e(()=>[D("div",null,[D("span",null,s(l.$t("views.document.enableStatus.label")),1),t(we,{trigger:"click",onCommand:Ie},{dropdown:e(()=>[t(fe,{style:{width:"100px"}},{default:e(()=>[t(U,{class:ge([c.value.isActive===""?"is-active":"","justify-center"]),command:ve("isActive","")},{default:e(()=>[m(s(l.$t("views.document.table.all")),1)]),_:1},8,["class","command"]),t(U,{class:ge([c.value.isActive===!0?"is-active":"","justify-center"]),command:ve("isActive",!0)},{default:e(()=>[m(s(l.$t("views.document.enableStatus.enable")),1)]),_:1},8,["class","command"]),t(U,{class:ge([c.value.isActive===!1?"is-active":"","justify-center"]),command:ve("isActive",!1)},{default:e(()=>[m(s(l.$t("views.document.enableStatus.close")),1)]),_:1},8,["class","command"])]),_:1})]),default:e(()=>[t(T,{style:{"margin-top":"1px"},link:"",type:c.value.isActive?"primary":""},{default:e(()=>[t($e,null,{default:e(()=>[t(Ae)]),_:1})]),_:1},8,["type"])]),_:1})])]),default:e(({row:w})=>[w.isActive?(o(),X("div",jl,[t($e,{class:"color-success mr-8",style:{"font-size":"16px"}},{default:e(()=>[t(Bt)]),_:1}),D("span",Wl,s(l.$t("common.status.enabled")),1)])):(o(),X("div",Ql,[t(te,{iconName:"app-disabled",class:"color-secondary mr-8"}),D("span",Zl,s(l.$t("common.status.disabled")),1)]))]),_:1}),t(_e,{width:"170"},{header:e(()=>[D("div",null,[D("span",null,s(l.$t("views.document.form.hitHandlingMethod.label")),1),t(we,{trigger:"click",onCommand:Ie},{dropdown:e(()=>[t(fe,{style:{width:"150px"}},{default:e(()=>[t(U,{class:ge([c.value.hitHandlingMethod?"":"is-active","justify-center"]),command:ve("hitHandlingMethod","")},{default:e(()=>[m(s(l.$t("views.document.table.all")),1)]),_:1},8,["class","command"]),(o(!0),X(ce,null,Ee(n(Ne),(w,ke)=>(o(),d(U,{key:ke,class:ge([c.value.hitHandlingMethod===ke?"is-active":"","justify-center"]),command:ve("hitHandlingMethod",ke)},{default:e(()=>[m(s(l.$t(w)),1)]),_:2},1032,["class","command"]))),128))]),_:1})]),default:e(()=>[t(T,{style:{"margin-top":"1px"},link:"",type:c.value.hitHandlingMethod?"primary":""},{default:e(()=>[t($e,null,{default:e(()=>[t(Ae)]),_:1})]),_:1},8,["type"])]),_:1})])]),default:e(({row:w})=>[m(s(l.$t(n(Ne)[w.hitHandlingMethod])),1)]),_:1}),t(_e,{prop:"createTime",label:l.$t("common.createTime"),width:"175",sortable:""},{default:e(({row:w})=>[m(s(n(at)(w.createTime)),1)]),_:1},8,["label"]),t(_e,{prop:"updateTime",label:l.$t("views.document.table.updateTime"),width:"175",sortable:""},{default:e(({row:w})=>[m(s(n(at)(w.updateTime)),1)]),_:1},8,["label"]),h.value?S("",!0):(o(),d(_e,{key:1,label:l.$t("common.operation"),align:"left",width:"160",fixed:"right"},{default:e(({row:w})=>{var ke,xe,et;return[D("span",{onClick:v[5]||(v[5]=ee(()=>{},["stop"]))},[a.value.doc_edit(n(u))?(o(),d(Ft,{key:0,loading:A.value,size:"small",modelValue:w.isActive,"onUpdate:modelValue":x=>w.isActive=x,"before-change":()=>St(w)},null,8,["loading","modelValue","onUpdate:modelValue","before-change"])):S("",!0)]),t(Gt,{direction:"vertical"}),((ke=R.value)==null?void 0:ke.type)===0||((xe=R.value)==null?void 0:xe.type)===2?(o(),X(ce,{key:0},[[n(N).STARTED,n(N).PENDING].includes(_(w.status,n(Y).EMBEDDING))?(o(),d(Se,{key:0,effect:"dark",content:l.$t("views.document.setting.cancelVectorization"),placement:"top"},{default:e(()=>[D("span",Yl,[a.value.doc_vector(n(u))?(o(),d(T,{key:0,type:"primary",text:"",onClick:ee(x=>Me(w,n(Y).EMBEDDING),["stop"])},{default:e(()=>[t($e,null,{default:e(()=>[t(Qe)]),_:1})]),_:2},1032,["onClick"])):S("",!0)])]),_:2},1032,["content"])):(o(),d(Se,{key:1,effect:"dark",content:l.$t("views.knowledge.setting.vectorization"),placement:"top"},{default:e(()=>[a.value.doc_vector(n(u))?(o(),X("span",Jl,[t(T,{type:"primary",text:"",onClick:ee(x=>qe(w),["stop"])},{default:e(()=>[t(te,{iconName:"app-document-refresh",style:{"font-size":"16px"}})]),_:2},1032,["onClick"])])):S("",!0)]),_:2},1032,["content"])),a.value.doc_edit(n(u))?(o(),d(Se,{key:2,effect:"dark",content:l.$t("common.setting"),placement:"top"},{default:e(()=>[D("span",Xl,[t(T,{type:"primary",text:"",onClick:ee(x=>Ke(w),["stop"])},{default:e(()=>[t(te,{iconName:"app-setting"})]),_:2},1032,["onClick"])])]),_:2},1032,["content"])):S("",!0),D("span",{onClick:v[6]||(v[6]=ee(()=>{},["stop"]))},[V(n(u))?(o(),d(we,{key:0,trigger:"click"},{dropdown:e(()=>[t(fe,null,{default:e(()=>[[n(N).STARTED,n(N).PENDING].includes(_(w.status,n(Y).GENERATE_PROBLEM))&&a.value.doc_generate(n(u))?(o(),d(U,{key:0,onClick:x=>Me(w,n(Y).GENERATE_PROBLEM)},{default:e(()=>[t(te,{iconName:"app-generate-question",class:"color-secondary"}),m(" "+s(l.$t("views.document.setting.cancelGenerateQuestion")),1)]),_:2},1032,["onClick"])):(o(),X(ce,{key:1},[a.value.doc_generate(n(u))?(o(),d(U,{key:0,onClick:x=>Ue(w)},{default:e(()=>[t(te,{iconName:"app-generate-question",class:"color-secondary"}),m(" "+s(l.$t("views.document.generateQuestion.title")),1)]),_:2},1032,["onClick"])):S("",!0)],64)),a.value.doc_migrate(n(u))?(o(),d(U,{key:2,onClick:x=>be(w)},{default:e(()=>[t(te,{iconName:"app-migrate",class:"color-secondary"}),m(" "+s(l.$t("views.document.setting.migration")),1)]),_:2},1032,["onClick"])):S("",!0),a.value.doc_export(n(u))?(o(),d(U,{key:3,onClick:x=>pe(w)},{default:e(()=>[t(te,{iconName:"app-export",class:"color-secondary"}),m(" "+s(l.$t("views.document.setting.export"))+" Excel ",1)]),_:2},1032,["onClick"])):S("",!0),a.value.doc_export(n(u))?(o(),d(U,{key:4,onClick:x=>oe(w)},{default:e(()=>[t(te,{iconName:"app-export",class:"color-secondary"}),m(" "+s(l.$t("views.document.setting.export"))+" Zip ",1)]),_:2},1032,["onClick"])):S("",!0),a.value.doc_download(n(u))?(o(),d(U,{key:5,onClick:ee(x=>Ct(w),["stop"])},{default:e(()=>[t($e,{class:"color-secondary"},{default:e(()=>[t(Kt)]),_:1}),m(" "+s(l.$t("views.document.setting.download")),1)]),_:2},1032,["onClick"])):S("",!0),a.value.doc_replace(n(u))?(o(),d(Pt,{key:6,ref_key:"elUploadRef",ref:Pe,"file-list":[],action:"#","auto-upload":!1,"show-file-list":!1,"on-change":(x,oa)=>Tt(x,w)},{default:e(()=>[t(U,null,{default:e(()=>[t($e,{class:"color-secondary"},{default:e(()=>[t(qt)]),_:1}),m(" "+s(l.$t("views.document.setting.replace")),1)]),_:1})]),_:2},1032,["on-change"])):S("",!0),a.value.doc_delete(n(u))?(o(),d(U,{key:7,onClick:ee(x=>He(w),["stop"])},{default:e(()=>[t(te,{iconName:"app-delete",class:"color-secondary"}),m(" "+s(l.$t("common.delete")),1)]),_:2},1032,["onClick"])):S("",!0)]),_:2},1024)]),default:e(()=>[t(T,{text:"",type:"primary"},{default:e(()=>[t(te,{iconName:"app-more"})]),_:1})]),_:2},1024)):S("",!0)])],64)):S("",!0),((et=R.value)==null?void 0:et.type)===1?(o(),X(ce,{key:1},[a.value.sync(n(u))?(o(),d(Se,{key:0,effect:"dark",content:l.$t("views.knowledge.setting.sync"),placement:"top"},{default:e(()=>[D("span",xl,[t(T,{type:"primary",text:"",onClick:ee(x=>gt(w),["stop"])},{default:e(()=>[t(te,{iconName:"app-sync"})]),_:2},1032,["onClick"])])]),_:2},1032,["content"])):S("",!0),[n(N).STARTED,n(N).PENDING].includes(_(w.status,n(Y).EMBEDDING))&&a.value.doc_vector(n(u))?(o(),d(Se,{key:1,effect:"dark",content:l.$t("views.document.setting.cancelVectorization"),placement:"top"},{default:e(()=>[D("span",ea,[t(T,{type:"primary",text:"",onClick:ee(x=>Me(w,n(Y).EMBEDDING),["stop"])},{default:e(()=>[t($e,null,{default:e(()=>[t(Qe)]),_:1})]),_:2},1032,["onClick"])])]),_:2},1032,["content"])):S("",!0),a.value.vector(n(u))?(o(),d(Se,{key:2,effect:"dark",content:l.$t("views.knowledge.setting.vectorization"),placement:"top"},{default:e(()=>[D("span",ta,[t(T,{type:"primary",text:"",onClick:ee(x=>qe(w),["stop"])},{default:e(()=>[t(te,{iconName:"app-document-refresh",style:{"font-size":"16px"}})]),_:2},1032,["onClick"])])]),_:2},1032,["content"])):S("",!0),D("span",{onClick:v[7]||(v[7]=ee(()=>{},["stop"]))},[L(n(u))?(o(),d(we,{key:0,trigger:"click"},{dropdown:e(()=>[t(fe,null,{default:e(()=>[a.value.doc_edit(n(u))?(o(),d(U,{key:0,onClick:x=>Ke(w)},{default:e(()=>[t(te,{iconName:"app-setting"}),m(" "+s(l.$t("common.setting")),1)]),_:2},1032,["onClick"])):S("",!0),a.value.doc_generate(n(u))&&[n(N).STARTED,n(N).PENDING].includes(_(w.status,n(Y).GENERATE_PROBLEM))?(o(),d(U,{key:1,onClick:x=>Me(w,n(Y).GENERATE_PROBLEM)},{default:e(()=>[t(te,{iconName:"app-generate-question"}),m(" "+s(l.$t("views.document.setting.cancelGenerateQuestion")),1)]),_:2},1032,["onClick"])):(o(),X(ce,{key:2},[a.value.doc_generate(n(u))?(o(),d(U,{key:0,onClick:x=>Ue(w)},{default:e(()=>[t(te,{iconName:"app-generate-question"}),m(" "+s(l.$t("views.document.generateQuestion.title")),1)]),_:2},1032,["onClick"])):S("",!0)],64)),a.value.doc_migrate(n(u))?(o(),d(U,{key:3,onClick:x=>be(w)},{default:e(()=>[t(te,{iconName:"app-migrate"}),m(" "+s(l.$t("views.document.setting.migration"))+"-3 ",1)]),_:2},1032,["onClick"])):S("",!0),a.value.doc_export(n(u))?(o(),d(U,{key:4,onClick:x=>pe(w)},{default:e(()=>[t(te,{iconName:"app-export"}),m(" "+s(l.$t("views.document.setting.export"))+" Excel ",1)]),_:2},1032,["onClick"])):S("",!0),a.value.doc_export(n(u))?(o(),d(U,{key:5,onClick:x=>oe(w)},{default:e(()=>[t(te,{iconName:"app-export"}),m(" "+s(l.$t("views.document.setting.export"))+" Zip ",1)]),_:2},1032,["onClick"])):S("",!0),a.value.doc_delete(n(u))?(o(),d(U,{key:6,onClick:ee(x=>He(w),["stop"])},{default:e(()=>[t(te,{iconName:"app-delete"}),m(" "+s(l.$t("common.delete")),1)]),_:2},1032,["onClick"])):S("",!0)]),_:2},1024)]),default:e(()=>[t(T,{text:"",type:"primary"},{default:e(()=>[t(te,{iconName:"app-more"})]),_:1})]),_:2},1024)):S("",!0)])],64)):S("",!0)]}),_:1},8,["label"]))]),_:1},8,["data","pagination-config","quick-create","row-key"])),[[zt,A.value]])])])]}),_:1}),P.value.length!==0?(o(),X("div",la,[a.value.doc_vector(n(u))?(o(),d(T,{key:0,disabled:P.value.length===0,onClick:v[8]||(v[8]=Ve=>De(1))},{default:e(()=>[m(s(l.$t("views.document.setting.cancelVectorization")),1)]),_:1},8,["disabled"])):S("",!0),a.value.doc_generate(n(u))?(o(),d(T,{key:1,disabled:P.value.length===0,onClick:v[9]||(v[9]=Ve=>De(2))},{default:e(()=>[m(s(l.$t("views.document.setting.cancelGenerate")),1)]),_:1},8,["disabled"])):S("",!0),t(Ot,{type:"info",class:"secondary ml-24"},{default:e(()=>[m(s(l.$t("common.selected"))+" "+s(P.value.length)+" "+s(l.$t("views.document.items")),1)]),_:1}),t(T,{class:"ml-16",type:"primary",link:"",onClick:ie},{default:e(()=>[m(s(l.$t("common.clear")),1)]),_:1})])):S("",!0),t(kl,{ref_key:"embeddingContentDialogRef",ref:b},null,512),t(dl,{ref_key:"ImportDocumentDialogRef",ref:y,title:J.value,onRefresh:Re},null,8,["title"]),t(ol,{ref_key:"SyncWebDialogRef",ref:z,onRefresh:Re},null,512),t(fl,{ref_key:"selectKnowledgeDialogRef",ref:de,onRefresh:It,workspaceId:(Ze=R.value)==null?void 0:Ze.workspaceId},null,8,["workspaceId"]),t(nl,{ref_key:"GenerateRelatedDialogRef",ref:ze,onRefresh:se,apiType:p.value},null,8,["apiType"]),t(Bl,{ref_key:"tagDrawerRef",ref:Ut},null,512),t(El,{ref_key:"tagSettingDrawerRef",ref:At},null,512),t(rt,{ref_key:"addTagDialogRef",ref:je,onAddTags:Lt,apiType:p.value},null,8,["apiType"]),t(sl,{ref_key:"ListActionRef",ref:K},null,512)])}}}),ma=ut(aa,[["__scopeId","data-v-942358b2"]]);export{ma as default};

import{ay as O,aP as Y,aQ as C,b_ as Z,aB as k,aX as ee,aC as u,b9 as le,aD as d,b3 as te,aT as z,aF as c,aI as s,aH as o,aJ as p,aG as a,b4 as ae,aE as h,aU as w,cy as oe,aK as L,cz as se,cA as ie,b8 as D,c8 as ne,aW as _,b5 as $,cn as re}from"./admin-AHG492JS.js";import{_ as ue}from"./BaseForm.vue_vue_type_script_setup_true_lang-LY68_I82.js";const de={class:"p-16-24"},pe={class:"mb-16"},me={class:"knowledge-setting main-calc-height"},ce={class:"p-24"},ve={class:"title-decoration-1 mb-16"},fe={class:"flex align-center"},ge={class:"flex align-center"},we={class:"flex align-center"},_e={key:2},ye={class:"title-decoration-1 mb-16"},ke={class:"flex align-center"},he={class:"mr-4"},be={class:"text-right"},Se=O({__name:"KnowledgeSetting",setup(Le){const T=Y(),{params:{id:v,folderId:F}}=T,m=C(()=>T.path.includes("shared")?"systemShare":T.path.includes("resource-management")?"systemManage":"workspace"),N=C(()=>Z.knowledge[m.value]),P=C(()=>F==="share"),V=k(),b=k(),y=k(!1),i=k({}),U=k(""),t=k({sourceUrl:"",selector:"",app_id:"",app_secret:"",folder_token:"",fileCountLimit:50,fileSizeLimit:100}),E=ee({sourceUrl:[{required:!0,message:u("views.knowledge.form.sourceUrl.requiredMessage"),trigger:"blur"}],app_id:[{required:!0,message:u("views.application.applicationAccess.larkSetting.appIdPlaceholder"),trigger:"blur"}],app_secret:[{required:!0,message:u("views.application.applicationAccess.larkSetting.appSecretPlaceholder"),trigger:"blur"}],folder_token:[{required:!0,message:u("views.application.applicationAccess.larkSetting.folderTokenPlaceholder"),trigger:"blur"}]});async function j(){var e;await((e=b.value)==null?void 0:e.validate())&&await V.value.validate(l=>{if(l){const r=i.value.type===1||i.value.type===2?{meta:t.value,fileCountLimit:t.value.fileCountLimit,fileSizeLimit:t.value.fileSizeLimit,...b.value.form}:{fileCountLimit:t.value.fileCountLimit,fileSizeLimit:t.value.fileSizeLimit,...b.value.form};U.value!==b.value.form.embeddingModelId?ne(u("common.tip"),u("views.knowledge.tip.updateModeMessage"),{confirmButtonText:u("views.knowledge.setting.vectorization")}).then(()=>{i.value.type===4?_({type:"knowledge",systemType:m.value}).putLarkKnowledge(v,r,y).then(()=>{_({type:"knowledge",systemType:m.value}).putReEmbeddingKnowledge(v).then(()=>{$(u("common.saveSuccess"))})}):_({type:"knowledge",systemType:m.value}).putKnowledge(v,r,y).then(()=>{_({type:"knowledge",systemType:m.value}).putReEmbeddingKnowledge(v).then(()=>{$(u("common.saveSuccess"))})})}).catch(()=>{}):i.value.type===4?_({type:"knowledge",systemType:m.value}).putLarkKnowledge(v,r,y).then(()=>{$(u("common.saveSuccess"))}):_({type:"knowledge",systemType:m.value}).putKnowledge(v,r,y).then(()=>{$(u("common.saveSuccess"))})}})}function G(){_({type:"knowledge",isShared:P.value,systemType:m.value}).getKnowledgeDetail(v,y).then(e=>{var l,r,f,g;i.value=e.data,U.value=(l=e.data)==null?void 0:l.embeddingModelId,((r=i.value)==null?void 0:r.type)===0&&(t.value.fileCountLimit=e.data.fileCountLimit,t.value.fileSizeLimit=e.data.fileSizeLimit),(((f=i.value)==null?void 0:f.type)===1||((g=i.value)==null?void 0:g.type)===2)&&(t.value=e.data.meta)})}return le(()=>{G()}),(e,l)=>{const r=d("el-avatar"),f=d("el-text"),g=d("el-card"),S=d("el-form-item"),K=d("el-input"),I=d("el-slider"),H=d("AppIcon"),J=d("el-tooltip"),Q=d("el-form"),W=d("el-button"),X=d("el-scrollbar"),x=te("loading");return c(),z("div",de,[s("h2",pe,p(e.$t("common.setting")),1),o(g,{style:{"--el-card-padding":"0"}},{default:a(()=>[s("div",me,[o(X,null,{default:a(()=>[ae((c(),z("div",ce,[s("h4",ve,p(e.$t("common.info")),1),o(ue,{ref_key:"BaseFormRef",ref:b,data:i.value,apiType:m.value},null,8,["data","apiType"]),o(Q,{ref_key:"webFormRef",ref:V,rules:E,model:t.value,"label-position":"top","require-asterisk-position":"right"},{default:a(()=>{var q,B,M;return[o(S,{label:e.$t("views.knowledge.knowledgeType.label"),required:""},{default:a(()=>{var n,A,R;return[((n=i.value)==null?void 0:n.type)===0?(c(),h(g,{key:0,shadow:"never",class:"mb-8 w-full layout-bg",style:{"line-height":"22px"}},{default:a(()=>[s("div",fe,[o(r,{class:"mr-8 avatar-blue",shape:"square",size:32},{default:a(()=>l[6]||(l[6]=[s("img",{src:oe,style:{width:"58%"},alt:""},null,-1)])),_:1,__:[6]}),s("div",null,[s("div",null,p(e.$t("views.knowledge.knowledgeType.generalKnowledge")),1),o(f,{type:"info"},{default:a(()=>[L(p(e.$t("views.knowledge.knowledgeType.generalInfo")),1)]),_:1})])])]),_:1})):w("",!0),((A=i.value)==null?void 0:A.type)===1?(c(),h(g,{key:1,shadow:"never",class:"mb-8 w-full layout-bg",style:{"line-height":"22px"}},{default:a(()=>[s("div",ge,[o(r,{class:"mr-8 avatar-purple",shape:"square",size:32},{default:a(()=>l[7]||(l[7]=[s("img",{src:se,style:{width:"58%"},alt:""},null,-1)])),_:1,__:[7]}),s("div",null,[s("div",null,p(e.$t("views.knowledge.knowledgeType.webKnowledge")),1),o(f,{type:"info"},{default:a(()=>[L(p(e.$t("views.knowledge.knowledgeType.webInfo")),1)]),_:1})])])]),_:1})):w("",!0),((R=i.value)==null?void 0:R.type)===2?(c(),h(g,{key:2,shadow:"never",class:"mb-8 w-full layout-bg",style:{"line-height":"22px"}},{default:a(()=>[s("div",we,[o(r,{class:"mr-8 avatar-orange",shape:"square",size:32},{default:a(()=>l[8]||(l[8]=[s("img",{src:ie,style:{width:"60%"},alt:""},null,-1)])),_:1,__:[8]}),s("div",null,[s("p",null,[o(f,null,{default:a(()=>[L(p(e.$t("views.knowledge.knowledgeType.workflowKnowledge")),1)]),_:1})]),o(f,{type:"info"},{default:a(()=>[L(p(e.$t("views.knowledge.knowledgeType.workflowInfo")),1)]),_:1})])])]),_:1})):w("",!0)]}),_:1},8,["label"]),((q=i.value)==null?void 0:q.type)===1?(c(),h(S,{key:0,label:e.$t("views.knowledge.form.sourceUrl.label"),prop:"sourceUrl"},{default:a(()=>[o(K,{modelValue:t.value.sourceUrl,"onUpdate:modelValue":l[0]||(l[0]=n=>t.value.sourceUrl=n),placeholder:e.$t("views.knowledge.form.sourceUrl.placeholder"),onBlur:l[1]||(l[1]=n=>t.value.sourceUrl=t.value.sourceUrl.trim())},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):w("",!0),((B=i.value)==null?void 0:B.type)===1?(c(),h(S,{key:1,label:e.$t("views.knowledge.form.selector.label")},{default:a(()=>[o(K,{modelValue:t.value.selector,"onUpdate:modelValue":l[2]||(l[2]=n=>t.value.selector=n),placeholder:e.$t("views.knowledge.form.selector.placeholder"),onBlur:l[3]||(l[3]=n=>t.value.selector=t.value.selector.trim())},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):w("",!0),((M=i.value)==null?void 0:M.type)===0?(c(),z("div",_e,[s("h4",ye,p(e.$t("common.otherSetting")),1),o(S,{label:e.$t("views.knowledge.form.fileCountLimit.label")},{default:a(()=>[o(I,{modelValue:t.value.fileCountLimit,"onUpdate:modelValue":l[4]||(l[4]=n=>t.value.fileCountLimit=n),"show-input":"","show-input-controls":!1,min:1,max:1e3,class:"custom-slider"},null,8,["modelValue"])]),_:1},8,["label"]),o(S,null,{label:a(()=>[s("div",ke,[s("span",he,p(e.$t("views.knowledge.form.fileSizeLimit.label")),1),o(J,{effect:"dark",content:e.$t("views.knowledge.form.fileSizeLimit.placeholder"),placement:"right"},{default:a(()=>[o(H,{iconName:"app-warning",class:"app-warning-icon"})]),_:1},8,["content"])])]),default:a(()=>[o(I,{modelValue:t.value.fileSizeLimit,"onUpdate:modelValue":l[5]||(l[5]=n=>t.value.fileSizeLimit=n),"show-input":"","show-input-controls":!1,min:1,max:1e3,class:"custom-slider"},null,8,["modelValue"])]),_:1})])):w("",!0)]}),_:1},8,["rules","model"]),s("div",be,[!D(T).path.includes("share/")&&N.value.edit(D(v))?(c(),h(W,{key:0,onClick:j,type:"primary"},{default:a(()=>[L(p(e.$t("common.save")),1)]),_:1})):w("",!0)])])),[[x,y.value]])]),_:1})])]),_:1})])}}}),Ce=re(Se,[["__scopeId","data-v-10bb96e6"]]);export{Ce as default};

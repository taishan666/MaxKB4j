import{ay as G,aB as b,aR as ce,aD as n,aE as C,aF as _,aG as o,aT as E,aH as s,aI as e,aJ as l,aU as Q,aY as j,aZ as J,aK as w,a_ as N,a$ as de,bK as he,el as _e,aQ as X,dg as Le,c9 as Te,aC as A,b8 as B,em as re,co as W,aA as pe,aP as oe,aX as $e,b9 as be,b3 as me,bC as ge,b4 as ve,aW as O,en as Ve,az as ye,dh as Se,eo as ke,aS as Ce,ep as ie,ca as le,eq as Re,b5 as ue}from"./admin-S7vQ7JSu.js";import{_ as we}from"./ParagraphForm.vue_vue_type_script_setup_true_lang-DdgwuIiR.js";const Fe={class:"bold title p-24",style:{"padding-bottom":"0"}},De={class:"flex align-center"},ze={class:"p-24",style:{"padding-top":"16px"}},Ie={key:1,class:"p-24"},Ue={class:"dialog-footer"},Pe=G({__name:"EditParagraphDialog",props:{isConnect:Boolean,knowledgeId:String},emits:["updateContent"],setup(D,{expose:P,emit:R}){const L=R,T=b(!1),y=b({}),F=b(),z=b(),u=b(!1),d=b("");ce(T,r=>{r||(y.value={})});const i=r=>{y.value=de.cloneDeep(r),T.value=!0};function V(r,g){y.value.problemList.splice(g,1)}function $(){var r,g,S;d.value.trim()&&((r=y.value)!=null&&r.problemList.some(p=>p.content===d.value.trim())||(S=(g=y.value)==null?void 0:g.problemList)==null||S.push({content:d.value.trim()}),d.value="",u.value=!1)}function I(){u.value=!0,he(()=>{var r;(r=z.value)==null||r.focus()})}const k=async()=>{var r,g;await((r=F.value)==null?void 0:r.validate())&&(L("updateContent",{problemList:y.value.problemList,...(g=F.value)==null?void 0:g.form}),T.value=!1)};return P({open:i}),(r,g)=>{const S=n("el-col"),p=n("el-divider"),v=n("Plus"),f=n("el-icon"),m=n("el-button"),c=n("el-input"),t=n("auto-tooltip"),a=n("TagEllipsis"),x=n("el-scrollbar"),Z=n("el-row"),q=n("el-dialog");return _(),C(q,{title:r.$t("views.paragraph.editParagraph"),modelValue:T.value,"onUpdate:modelValue":g[3]||(g[3]=U=>T.value=U),width:"80%","destroy-on-close":"",class:"paragraph-dialog","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:o(()=>[e("span",Ue,[s(m,{onClick:g[2]||(g[2]=N(U=>T.value=!1,["prevent"]))},{default:o(()=>[w(l(r.$t("common.cancel")),1)]),_:1}),s(m,{type:"primary",onClick:k},{default:o(()=>[w(l(r.$t("common.save")),1)]),_:1})])]),default:o(()=>[D.isConnect?(_(),C(Z,{key:0},{default:o(()=>[s(S,{span:18,class:"p-24"},{default:o(()=>[s(we,{ref_key:"paragraphFormRef",ref:F,data:y.value,isEdit:!0,"knowledge-id":D.knowledgeId},null,8,["data","knowledge-id"])]),_:1}),s(S,{span:6,class:"border-l",style:{width:"300px"}},{default:o(()=>[e("p",Fe,[e("span",De,[e("span",null,l(r.$t("views.paragraph.relatedProblem.title")),1),s(p,{direction:"vertical",class:"mr-4"}),s(m,{text:"",onClick:I},{default:o(()=>[s(f,null,{default:o(()=>[s(v)]),_:1})]),_:1})])]),s(x,{height:"500px"},{default:o(()=>[e("div",ze,[u.value?(_(),C(c,{key:0,modelValue:d.value,"onUpdate:modelValue":g[0]||(g[0]=U=>d.value=U),placeholder:r.$t("views.paragraph.relatedProblem.placeholder"),onChange:$,onBlur:g[1]||(g[1]=U=>u.value=!1),ref_key:"inputRef",ref:z,class:"mb-8"},null,8,["modelValue","placeholder"])):Q("",!0),(_(!0),E(j,null,J(y.value.problemList,(U,H)=>(_(),C(a,{key:H,onClose:K=>V(U,H),class:"question-tag",type:"info",effect:"plain",closable:""},{default:o(()=>[s(t,{content:U.content},{default:o(()=>[w(l(U.content),1)]),_:2},1032,["content"])]),_:2},1032,["onClose"]))),128))])]),_:1})]),_:1})]),_:1})):(_(),E("div",Ie,[s(we,{ref_key:"paragraphFormRef",ref:F,data:y.value,isEdit:!0,"knowledge-id":D.knowledgeId},null,8,["data","knowledge-id"])]))]),_:1},8,["title","modelValue"])}}}),Me={class:"flex-between"},Ee={class:"lighter mt-12"},Ae={class:"lighter mt-12"},xe=G({__name:"ParagraphList",props:{modelValue:{type:Array,default:()=>[]},isConnect:Boolean,knowledgeId:String},emits:["update:modelValue"],setup(D,{emit:P}){const R=b(30),L=b(1),T=b(0),y=b(),F=P,z=b(!1),u=b([]),d=D;_e(()=>{if(d.modelValue&&d.modelValue.length>0){const r=R.value*L.value;u.value=d.modelValue.slice(0,Math.min(r,d.modelValue.length))}}),_e(()=>{const g=R.value*L.value;u.value=d.modelValue.slice(0,Math.min(g,d.modelValue.length))});const i=X(()=>u.value),V=()=>{z.value=!0,setTimeout(()=>{L.value+=1,z.value=!1},100)},$=(r,g)=>{T.value=g+R.value*(L.value-1),y.value.open(r)},I=r=>{const g=[...d.modelValue];d.isConnect&&r.title&&!(r!=null&&r.problemList.some(p=>p.content===r.title.trim()))&&r.problemList.push({content:r.title.trim()}),g[T.value]=de.cloneDeep(r),F("update:modelValue",g);const S=T.value-R.value*(L.value-1);S>=0&&S<u.value.length&&(u.value[S]=de.cloneDeep(r))},k=(r,g)=>{Te(`${A("views.paragraph.delete.confirmTitle")}${r.title||"-"} ?`,A("views.paragraph.delete.confirmMessage"),{confirmButtonText:A("common.confirm"),confirmButtonClass:"color-danger"}).then(()=>{const S=[...d.modelValue];if(S.splice(g,1),F("update:modelValue",S),u.value.splice(g,1),d.modelValue.length>u.value.length*L.value){const p=d.modelValue[u.value.length*L.value];p&&u.value.push(p)}}).catch(()=>{})};return(r,g)=>{const S=n("AppIcon"),p=n("el-button"),v=n("el-text"),f=n("el-card");return _(),E("div",null,[s(Le,{size:i.value.length,total:D.modelValue.length,page_size:R.value,current_page:L.value,"onUpdate:current_page":g[0]||(g[0]=m=>L.value=m),onLoad:g[1]||(g[1]=m=>V()),loading:z.value},{default:o(()=>[(_(!0),E(j,null,J(i.value,(m,c)=>(_(),C(f,{key:c,shadow:"never",class:"card-never mb-16"},{default:o(()=>[e("div",Me,[e("span",null,l(m.title||"-"),1),e("div",null,[s(p,{link:"",onClick:t=>$(m,c)},{default:o(()=>[s(S,{iconName:"app-edit"})]),_:2},1032,["onClick"]),s(p,{link:"",onClick:t=>k(m,c)},{default:o(()=>[s(S,{iconName:"app-delete"})]),_:2},1032,["onClick"])])]),e("div",Ee,l(m.content),1),e("div",Ae,[s(v,{type:"info"},{default:o(()=>[w(l(m.content.length)+" "+l(r.$t("views.paragraph.character_count")),1)]),_:2},1024)])]),_:2},1024))),128))]),_:1},8,["size","total","page_size","current_page","loading"]),s(Pe,{ref_key:"EditParagraphDialogRef",ref:y,onUpdateContent:I,isConnect:D.isConnect,"knowledge-id":D.knowledgeId},null,8,["isConnect","knowledge-id"])])}}}),Be={class:"flex-center"},Ne=["src"],Xe={class:"ml-4"},qe={class:"mb-16"},He={key:0,class:"paragraph-list"},Qe=G({__name:"ParagraphPreview",props:{data:{type:Array,default:()=>[]},isConnect:Boolean,knowledgeId:String},setup(D){const P=b(0);return(R,L)=>{const T=n("el-text"),y=n("el-scrollbar"),F=n("el-tab-pane"),z=n("el-tabs");return _(),C(z,{modelValue:P.value,"onUpdate:modelValue":L[0]||(L[0]=u=>P.value=u),class:"paragraph-tabs"},{default:o(()=>[(_(!0),E(j,null,J(D.data,(u,d)=>(_(),C(F,{key:d,label:u.name,name:d},{label:o(()=>[e("div",Be,[e("img",{src:B(re)(u&&(u==null?void 0:u.name)),alt:"",height:"16"},null,8,Ne),e("span",Xe,l(u==null?void 0:u.name),1)])]),default:o(()=>[e("div",qe,[s(T,{type:"info"},{default:o(()=>[w(l(u.content.length)+" "+l(R.$t("views.paragraph.title")),1)]),_:2},1024)]),P.value==d?(_(),E("div",He,[s(y,null,{default:o(()=>[s(xe,{modelValue:u.content,"onUpdate:modelValue":i=>u.content=i,isConnect:D.isConnect,"knowledge-id":D.knowledgeId},null,8,["modelValue","onUpdate:modelValue","isConnect","knowledge-id"])]),_:2},1024)])):Q("",!0)]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])}}}),Ke=W(Qe,[["__scopeId","data-v-c20b8d02"]]),Oe={class:"set-rules"},Ze={class:"title-decoration-1 mb-16"},je={class:"set-rules__right"},Ge={class:"mb-4"},Je={class:"mb-4"},We={class:"set-rules__form"},Ye={class:"form-item mb-16"},et={class:"title flex align-center mb-8"},tt={style:{"margin-right":"4px"}},lt={class:"form-item mb-16"},ot={class:"title mb-8"},st={class:"form-item mb-16"},nt={class:"title mb-8"},at={style:{"margin-top":"4px"}},it={class:"text-right mt-8"},ut={class:"title-decoration-1 mb-8"},dt=G({__name:"SetRules",setup(D,{expose:P}){const{knowledge:R}=pe(),L=X(()=>R.documentsFiles),T=b([]),y=oe(),{query:{id:F}}=y,z=X(()=>y.path.includes("shared")?"systemShare":y.path.includes("resource-management")?"systemManage":"workspace"),u=b("1"),d=b(!1),i=b([]),V=b(!1),$=b(!1),I=b(!0),k=$e({patterns:[],limit:500,withFilter:!0});function r(p){p&&I.value&&(i.value=i.value.map(v=>({...v,content:v.content.map(f=>({...f,problemList:f.title.trim()?[f.title.trim()]:[]}))})),I.value=!1)}function g(){d.value=!0;const p=new FormData;L.value.forEach(v=>{v!=null&&v.raw&&p.append("file",v==null?void 0:v.raw)}),u.value==="2"&&Object.keys(k).forEach(v=>{v=="patterns"?k.patterns.forEach(f=>p.append("patterns",f)):p.append(v,k[v])}),O({type:"document",systemType:z.value}).postSplitDocument(F,p).then(v=>{const f=v.data;f.map(m=>{m.name.length>128&&(m.name=Ve(m.name,128)),$.value&&m.content.map(c=>{c.problemList=c.title.trim()?[c.title.trim()]:[]})}),i.value=f,d.value=!1}).catch(()=>{d.value=!1})}const S=()=>{O({type:"document",systemType:z.value}).listSplitPattern(F,V).then(p=>{T.value=p.data})};return ce(u,()=>{u.value==="2"&&S()}),be(()=>{g()}),P({paragraphList:i,checkedConnect:$,loading:d}),(p,v)=>{const f=n("el-text"),m=n("el-radio"),c=n("el-card"),t=n("AppIcon"),a=n("el-tooltip"),x=n("el-option"),Z=n("el-select"),q=n("el-slider"),U=n("el-switch"),H=n("el-radio-group"),K=n("el-scrollbar"),Y=n("el-checkbox"),se=n("el-button"),ee=n("el-col"),ne=n("el-row"),ae=me("loading");return _(),E("div",Oe,[s(ne,null,{default:o(()=>[s(ee,{span:10,class:"p-24"},{default:o(()=>[e("h4",Ze,l(p.$t("views.document.setRules.title.setting")),1),e("div",je,[s(K,null,{default:o(()=>[e("div",{class:"left-height",onClick:v[5]||(v[5]=N(()=>{},["stop"]))},[s(H,{modelValue:u.value,"onUpdate:modelValue":v[4]||(v[4]=M=>u.value=M),class:"card__radio"},{default:o(()=>[s(c,{shadow:"never",class:ge(["mb-16",u.value==="1"?"active":""])},{default:o(()=>[s(m,{value:"1",size:"large"},{default:o(()=>[e("p",Ge,l(p.$t("views.document.setRules.intelligent.label")),1),s(f,{type:"info"},{default:o(()=>[w(l(p.$t("views.document.setRules.intelligent.text")),1)]),_:1})]),_:1})]),_:1},8,["class"]),s(c,{shadow:"never",class:ge(["mb-16",u.value==="2"?"active":""])},{default:o(()=>[s(m,{value:"2",size:"large"},{default:o(()=>[e("p",Je,l(p.$t("views.document.setRules.advanced.label")),1),s(f,{type:"info"},{default:o(()=>[w(l(p.$t("views.document.setRules.advanced.text")),1)]),_:1})]),_:1}),u.value==="2"?(_(),C(c,{key:0,shadow:"never",class:"card-never mt-16",style:{"margin-left":"30px"}},{default:o(()=>[e("div",We,[e("div",Ye,[e("div",et,[e("span",tt,l(p.$t("views.document.setRules.patterns.label")),1),s(a,{effect:"dark",content:p.$t("views.document.setRules.patterns.tooltip"),placement:"right"},{default:o(()=>[s(t,{iconName:"app-warning",class:"app-warning-icon"})]),_:1},8,["content"])]),e("div",{onClick:v[1]||(v[1]=N(()=>{},["stop"]))},[s(Z,{modelValue:k.patterns,"onUpdate:modelValue":v[0]||(v[0]=M=>k.patterns=M),multiple:"","reserve-keyword":!1,"allow-create":"","default-first-option":"",filterable:"",placeholder:p.$t("views.document.setRules.patterns.placeholder")},{default:o(()=>[(_(!0),E(j,null,J(T.value,(M,te)=>(_(),C(x,{key:te,label:M.key,value:M.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])])]),e("div",lt,[e("div",ot,l(p.$t("views.document.setRules.limit.label")),1),s(q,{modelValue:k.limit,"onUpdate:modelValue":v[2]||(v[2]=M=>k.limit=M),"show-input":"","show-input-controls":!1,min:50,max:1e5},null,8,["modelValue"])]),e("div",st,[e("div",nt,l(p.$t("views.document.setRules.withFilter.label")),1),s(U,{size:"small",modelValue:k.withFilter,"onUpdate:modelValue":v[3]||(v[3]=M=>k.withFilter=M)},null,8,["modelValue"]),e("div",at,[s(f,{type:"info"},{default:o(()=>[w(l(p.$t("views.document.setRules.withFilter.text")),1)]),_:1})])])])]),_:1})):Q("",!0)]),_:1},8,["class"])]),_:1},8,["modelValue"])])]),_:1}),e("div",null,[s(Y,{modelValue:$.value,"onUpdate:modelValue":v[6]||(v[6]=M=>$.value=M),onChange:r,style:{"white-space":"normal"}},{default:o(()=>[w(l(p.$t("views.document.setRules.checkedConnect.label")),1)]),_:1},8,["modelValue"])]),e("div",it,[s(se,{onClick:g},{default:o(()=>[w(l(p.$t("views.document.buttons.preview")),1)]),_:1})])])]),_:1}),s(ee,{span:14,class:"p-24 border-l"},{default:o(()=>[ve((_(),E("div",null,[e("h4",ut,l(p.$t("views.document.setRules.title.preview")),1),s(Ke,{data:i.value,"onUpdate:data":v[7]||(v[7]=M=>i.value=M),isConnect:$.value,"knowledge-id":B(F)},null,8,["data","isConnect","knowledge-id"])])),[[ae,d.value]])]),_:1})]),_:1})])}}}),ct=W(dt,[["__scopeId","data-v-b0302eb3"]]),rt={class:"mt-8"},pt={class:"bold"},mt={class:"bold"},vt={class:"bold"},ft={class:"result-success"},_t={class:"bolder"},gt={class:"flex-between"},wt={class:"flex"},ht=["src"],$t={class:"ml-8"},bt=G({__name:"ResultSuccess",props:{data:{type:Object,default:()=>{}}},setup(D){const P=D,R=ye(),L=oe(),{params:{id:T,folderId:y}}=L,F=X(()=>L.path.includes("shared")?"systemShare":L.path.includes("resource-management")?"systemManage":"workspace"),z=X(()=>{var d;return(d=P.data)==null?void 0:d.documentList.reduce((i,V)=>i+=V.paragraph_count,0)}),u=X(()=>{var d;return((d=P.data)==null?void 0:d.documentList.reduce((i,V)=>i+=V.charLength,0))||0});return(d,i)=>{const V=n("el-text"),$=n("el-divider"),I=n("el-button"),k=n("el-result"),r=n("SuccessFilled"),g=n("el-icon"),S=n("CircleCloseFilled"),p=n("Loading"),v=n("el-card"),f=n("el-scrollbar");return _(),C(f,null,{default:o(()=>{var m;return[s(k,{icon:"color-success",title:`沁 ${d.$t("views.knowledge.ResultSuccess.title")} 沁荏},{"sub-title":o(()=>{var c;return[e("div",rt,[e("span",pt,l(((c=D.data)==null?void 0:c.documentList.length)||0),1),s(V,{type:"info",class:"ml-4"},{default:o(()=>[w(l(d.$t("common.fileUpload.document")),1)]),_:1}),s($,{direction:"vertical"}),e("span",mt,l(z.value||0),1),s(V,{type:"info",class:"ml-4"},{default:o(()=>[w(l(d.$t("views.knowledge.ResultSuccess.paragraph")),1)]),_:1}),s($,{direction:"vertical"}),e("span",vt,l(B(Se)(u.value)||0),1),s(V,{type:"info",class:"ml-4"},{default:o(()=>[w(l(d.$t("common.character")),1)]),_:1})])]}),extra:o(()=>[F.value==="workspace"?(_(),C(I,{key:0,onClick:i[0]||(i[0]=c=>B(R).push({path:"/knowledge"}))},{default:o(()=>[w(l(d.$t("views.knowledge.ResultSuccess.buttons.toknowledge")),1)]),_:1})):(_(),C(I,{key:1,onClick:i[1]||(i[1]=c=>B(R).push({path:`/system/${B(y)}/knowledge`}))},{default:o(()=>[w(l(d.$t("views.knowledge.ResultSuccess.buttons.toknowledge")),1)]),_:1})),s(I,{type:"primary",onClick:i[2]||(i[2]=c=>{var t;return B(R).push({path:`/knowledge/${(t=D.data)==null?void 0:t.id}/${B(y)}/document`})})},{default:o(()=>[w(l(d.$t("views.knowledge.ResultSuccess.buttons.toDocument")),1)]),_:1})]),_:1},8,["title"]),e("div",ft,[e("p",_t,l(d.$t("views.knowledge.ResultSuccess.documentList")),1),(_(!0),E(j,null,J((m=D.data)==null?void 0:m.documentList,(c,t)=>(_(),C(v,{shadow:"never",class:"file-List-card mt-8",key:t},{default:o(()=>[e("div",gt,[e("div",wt,[e("img",{src:B(re)(c&&(c==null?void 0:c.name)),alt:"",width:"40"},null,8,ht),e("div",$t,[e("p",null,l(c&&(c==null?void 0:c.name)),1),s(V,{type:"info",size:"small"},{default:o(()=>[w(l(B(ke)(c&&(c==null?void 0:c.charLength))),1)]),_:2},1024)])]),e("div",null,[s(V,{type:"info",class:"mr-16"},{default:o(()=>[w(l(c&&(c==null?void 0:c.paragraph_count))+" "+l(d.$t("views.knowledge.ResultSuccess.paragraph_count")),1)]),_:2},1024),c.status==="1"?(_(),C(V,{key:0},{default:o(()=>[s(g,{class:"color-success"},{default:o(()=>[s(r)]),_:1})]),_:1})):c.status==="2"?(_(),C(V,{key:1},{default:o(()=>[s(g,{class:"color-danger"},{default:o(()=>[s(S)]),_:1})]),_:1})):c.status==="0"?(_(),C(V,{key:2},{default:o(()=>[s(g,{class:"is-loading primary"},{default:o(()=>[s(p)]),_:1}),w(" "+l(d.$t("views.knowledge.ResultSuccess.loading"))+"... ",1)]),_:1})):Q("",!0)])])]),_:2},1024))),128))])]}),_:1})}}}),yt=W(bt,[["__scopeId","data-v-a7787e3d"]]),kt={class:"title-decoration-1 mb-8"},Ct={class:"mt-16 mb-16"},Lt={class:"update-info flex p-8-12 border-r-6 mb-16 w-full"},Tt={class:"mt-4"},Vt={class:"ml-16 lighter"},St={class:"el-upload__text"},Rt={class:"upload__decoration"},Ft={class:"update-info flex p-8-12 border-r-6 mb-16 w-full"},Dt={class:"mt-4"},zt={class:"ml-16 lighter"},It={class:"el-upload__text"},Ut={class:"upload__decoration"},Pt={class:"update-info flex p-8-12 border-r-6 mb-16 w-full"},Mt={class:"mt-4"},Et={class:"ml-16 lighter"},At={class:"el-upload__text"},xt={class:"upload__decoration"},Bt={class:"flex-between"},Nt={class:"flex"},Xt=["src"],qt={class:"ml-8"},Ht=G({__name:"UploadComponent",setup(D,{expose:P}){const R=oe(),{query:{id:L}}=R,T=X(()=>R.path.includes("shared")?"systemShare":R.path.includes("resource-management")?"systemManage":"workspace"),{knowledge:y}=pe(),F=X(()=>y.documentsFiles),z=X(()=>y.documentsType),u=b(),d=b(!1),i=b({fileType:"txt",fileList:[]}),V=$e({fileList:[{required:!0,message:A("views.document.upload.requiredMessage"),trigger:"change"}]}),$=b(50),I=b(100);ce(i.value,t=>{y.saveDocumentsType(t.fileType),y.saveDocumentsFile(t.fileList)});function k(t){O({type:"document",systemType:T.value}).exportQATemplate(`${t}${A("views.document.upload.template")}.${t=="csv"?t:"xlsx"}`,t)}function r(t){O({type:"document",systemType:T.value}).exportTableTemplate(`${t}${A("views.document.upload.template")}.${t=="csv"?t:"xlsx"}`,t)}function g(){i.value.fileList=[]}function S(t){i.value.fileList.splice(t,1)}const p=(t,a)=>{if(!((t==null?void 0:t.size)/1024/1024<I.value))return le(A("views.document.tip.fileLimitSizeTip1")+I.value+"MB"),a.splice(-1,1),!1;if(!Re(t==null?void 0:t.name,i.value.fileType))return(t==null?void 0:t.name)!==".DS_Store"&&le(A("views.document.upload.errorMessage2")),a.splice(-1,1),!1;if((t==null?void 0:t.size)===0)return le(A("views.document.upload.errorMessage3")),a.splice(-1,1),!1},v=()=>{le(A("views.document.tip.fileLimitCountTip1")+$.value+A("views.document.tip.fileLimitCountTip2"))},f=t=>{let a=null;he(()=>{document.querySelector(".el-upload__input")!=null&&(a=document.querySelector(".el-upload__input"),a.webkitdirectory=t)})};function m(){if(u.value)return u.value.validate(t=>t)}function c(){O({type:"knowledge",systemType:T.value}).getKnowledgeDetail(L,d).then(t=>{$.value=t.data.fileCountLimit,I.value=t.data.fileSizeLimit})}return be(()=>{z.value&&(i.value.fileType=z.value),F.value&&(i.value.fileList=F.value),c()}),Ce(()=>{i.value={fileType:"txt",fileList:[]}}),P({validate:m,form:i}),(t,a)=>{var te;const x=n("el-radio-button"),Z=n("el-radio-group"),q=n("AppIcon"),U=n("el-button"),H=n("el-upload"),K=n("el-form-item"),Y=n("el-form"),se=n("el-text"),ee=n("el-card"),ne=n("el-col"),ae=n("el-row"),M=me("loading");return _(),E(j,null,[e("h4",kt,l(t.$t("views.document.uploadDocument")),1),ve((_(),C(Y,{ref_key:"FormRef",ref:u,model:i.value,rules:V,"label-position":"top","require-asterisk-position":"right"},{default:o(()=>[e("div",Ct,[s(Z,{modelValue:i.value.fileType,"onUpdate:modelValue":a[0]||(a[0]=h=>i.value.fileType=h),onChange:g,class:"app-radio-button-group"},{default:o(()=>[s(x,{value:"txt"},{default:o(()=>[w(l(t.$t("views.document.fileType.txt.label")),1)]),_:1}),s(x,{value:"table"},{default:o(()=>[w(l(t.$t("views.document.fileType.table.label")),1)]),_:1}),s(x,{value:"QA"},{default:o(()=>[w(l(t.$t("views.document.fileType.QA.label")),1)]),_:1})]),_:1},8,["modelValue"])]),i.value.fileType==="QA"?(_(),C(K,{key:0,prop:"fileList"},{default:o(()=>[e("div",Lt,[e("div",Tt,[s(q,{iconName:"app-warning-colorful",style:{"font-size":"16px"}})]),e("div",Vt,[e("p",null,[w(l(t.$t("views.document.fileType.QA.tip1"))+" ",1),s(U,{type:"primary",link:"",onClick:a[1]||(a[1]=h=>k("excel"))},{default:o(()=>[w(l(t.$t("views.document.upload.download"))+" Excel "+l(t.$t("views.document.upload.template")),1)]),_:1}),s(U,{type:"primary",link:"",onClick:a[2]||(a[2]=h=>k("csv"))},{default:o(()=>[w(l(t.$t("views.document.upload.download"))+" CSV "+l(t.$t("views.document.upload.template")),1)]),_:1})]),e("p",null,l(t.$t("views.document.fileType.QA.tip2")),1),e("p",null," 3. "+l(t.$t("views.document.tip.fileLimitCountTip1"))+" "+l($.value)+" "+l(t.$t("views.document.tip.fileLimitCountTip2"))+", "+l(t.$t("views.document.tip.fileLimitSizeTip1"))+" "+l(I.value)+" MB ",1)])]),s(H,{webkitdirectory:!1,class:"w-full mb-4",drag:"",multiple:"","file-list":i.value.fileList,"onUpdate:fileList":a[5]||(a[5]=h=>i.value.fileList=h),action:"#","auto-upload":!1,"show-file-list":!1,accept:".xlsx, .xls, .csv,.zip",limit:$.value,"on-exceed":v,"on-change":p,onClick:a[6]||(a[6]=N(h=>f(!1),["prevent"]))},{default:o(()=>[a[17]||(a[17]=e("img",{src:ie,alt:""},null,-1)),e("div",St,[e("p",null,[w(l(t.$t("views.document.upload.uploadMessage"))+" ",1),e("em",{class:"hover",onClick:a[3]||(a[3]=N(h=>f(!1),["prevent"]))},l(t.$t("views.document.upload.selectFile")),1),e("em",{class:"hove ml-4",onClick:a[4]||(a[4]=N(h=>f(!0),["prevent"]))},l(t.$t("views.document.upload.selectFiles")),1)]),e("div",Rt,[e("p",null,l(t.$t("views.document.upload.formats"))+"XLS縲々LSX縲，SV縲〇IP",1)])])]),_:1,__:[17]},8,["file-list","limit"])]),_:1})):i.value.fileType==="table"?(_(),C(K,{key:1,prop:"fileList"},{default:o(()=>[e("div",Ft,[e("div",Dt,[s(q,{iconName:"app-warning-colorful",style:{"font-size":"16px"}})]),e("div",zt,[e("p",null,[w(l(t.$t("views.document.fileType.table.tip1"))+" ",1),s(U,{type:"primary",link:"",onClick:a[7]||(a[7]=h=>r("excel"))},{default:o(()=>[w(l(t.$t("views.document.upload.download"))+" Excel "+l(t.$t("views.document.upload.template")),1)]),_:1}),s(U,{type:"primary",link:"",onClick:a[8]||(a[8]=h=>r("csv"))},{default:o(()=>[w(l(t.$t("views.document.upload.download"))+" CSV "+l(t.$t("views.document.upload.template")),1)]),_:1})]),e("p",null,l(t.$t("views.document.fileType.table.tip2")),1),e("p",null,l(t.$t("views.document.fileType.table.tip3")),1),e("p",null," 4. "+l(t.$t("views.document.tip.fileLimitCountTip1"))+" "+l($.value)+" "+l(t.$t("views.document.tip.fileLimitCountTip2"))+", "+l(t.$t("views.document.tip.fileLimitSizeTip1"))+" "+l(I.value)+" MB ",1)])]),s(H,{webkitdirectory:!1,class:"w-full mb-4",drag:"",multiple:"","file-list":i.value.fileList,"onUpdate:fileList":a[11]||(a[11]=h=>i.value.fileList=h),action:"#","auto-upload":!1,"show-file-list":!1,accept:".xlsx, .xls, .csv",limit:$.value,"on-exceed":v,"on-change":p,onClick:a[12]||(a[12]=N(h=>f(!1),["prevent"]))},{default:o(()=>[a[18]||(a[18]=e("img",{src:ie,alt:""},null,-1)),e("div",It,[e("p",null,[w(l(t.$t("views.document.upload.uploadMessage"))+" ",1),e("em",{class:"hover",onClick:a[9]||(a[9]=N(h=>f(!1),["prevent"]))},l(t.$t("views.document.upload.selectFile")),1),e("em",{class:"hover ml-4",onClick:a[10]||(a[10]=N(h=>f(!0),["prevent"]))},l(t.$t("views.document.upload.selectFiles")),1)]),e("div",Ut,[e("p",null,l(t.$t("views.document.upload.formats"))+"XLS縲々LSX縲，SV",1)])])]),_:1,__:[18]},8,["file-list","limit"])]),_:1})):(_(),C(K,{key:2,prop:"fileList"},{default:o(()=>[e("div",Pt,[e("div",Mt,[s(q,{iconName:"app-warning-colorful",style:{"font-size":"16px"}})]),e("div",Et,[e("p",null,l(t.$t("views.document.fileType.txt.tip1")),1),e("p",null," 2. "+l(t.$t("views.document.tip.fileLimitCountTip1"))+" "+l($.value)+" "+l(t.$t("views.document.tip.fileLimitCountTip2"))+", "+l(t.$t("views.document.tip.fileLimitSizeTip1"))+" "+l(I.value)+" MB ",1)])]),s(H,{webkitdirectory:!1,class:"w-full",drag:"",multiple:"","file-list":i.value.fileList,"onUpdate:fileList":a[15]||(a[15]=h=>i.value.fileList=h),action:"#","auto-upload":!1,"show-file-list":!1,accept:".txt, .md, .log, .docx, .pdf, .html,.zip,.xlsx,.xls,.csv",limit:$.value,"on-exceed":v,"on-change":p,onClick:a[16]||(a[16]=N(h=>f(!1),["prevent"]))},{default:o(()=>[a[19]||(a[19]=e("img",{src:ie,alt:""},null,-1)),e("div",At,[e("p",null,[w(l(t.$t("views.document.upload.uploadMessage"))+" ",1),e("em",{class:"hover",onClick:a[13]||(a[13]=N(h=>f(!1),["prevent"]))},l(t.$t("views.document.upload.selectFile")),1),e("em",{class:"hover ml-4",onClick:a[14]||(a[14]=N(h=>f(!0),["prevent"]))},l(t.$t("views.document.upload.selectFiles")),1)]),e("div",xt,[e("p",null,l(t.$t("views.document.upload.formats"))+"TXT縲｀arkdown縲￣DF縲．OCX縲？TML縲々LS縲々LSX縲，SV縲〇IP ",1)])])]),_:1,__:[19]},8,["file-list","limit"])]),_:1}))]),_:1},8,["model","rules"])),[[M,d.value]]),(te=i.value.fileList)!=null&&te.length?(_(),C(ae,{key:0,gutter:8},{default:o(()=>[(_(!0),E(j,null,J(i.value.fileList,(h,fe)=>(_(),C(ne,{key:fe,span:12,class:"mb-8"},{default:o(()=>[s(ee,{shadow:"never",class:"file-List-card"},{default:o(()=>[e("div",Bt,[e("div",Nt,[e("img",{src:B(re)(h&&(h==null?void 0:h.name)),alt:"",width:"40"},null,8,Xt),e("div",qt,[e("p",null,l(h&&(h==null?void 0:h.name)),1),s(se,{type:"info",size:"small"},{default:o(()=>[w(l(B(ke)(h&&(h==null?void 0:h.size))||"0K"),1)]),_:2},1024)])]),s(U,{text:"",onClick:el=>S(fe)},{default:o(()=>[s(q,{iconName:"app-delete"})]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})):Q("",!0)],64)}}}),Qt=W(Ht,[["__scopeId","data-v-de488c7f"]]),Kt={class:"upload-document p-12-24"},Ot={class:"flex align-center mb-16"},Zt={style:{display:"inline-block"}},jt={class:"upload-document__main flex"},Gt={class:"upload-document__component main-calc-height"},Jt={key:0,class:"upload-component p-24"},Wt={key:0,class:"upload-document__footer text-right border-t"},Yt=G({__name:"UploadDocument",setup(D){const{knowledge:P}=pe(),R=X(()=>P.documentsFiles),L=X(()=>P.documentsType),T=ye(),y=oe(),{params:{folderId:F,type:z},query:{id:u}}=y,d=X(()=>y.path.includes("shared")?"systemShare":y.path.includes("resource-management")?"systemManage":"workspace"),i=b(),V=b(),$=b(!1),I=b(!1),k=b(0),r=b(null);async function g(){if(I.value=!0,await V.value.validate())if(L.value==="QA"){const f=new FormData;R.value.forEach(m=>{m!=null&&m.raw&&f.append("file",m==null?void 0:m.raw)}),u&&O({type:"document",systemType:d.value}).postQADocument(u,f,$).then(()=>{ue(A("common.submitSuccess")),p(),T.push({path:`/knowledge/${u}/${F}/${z}/document`})})}else if(L.value==="table"){const f=new FormData;R.value.forEach(m=>{m!=null&&m.raw&&f.append("file",m==null?void 0:m.raw)}),u&&O({type:"document",systemType:d.value}).postTableDocument(u,f,$).then(()=>{ue(A("common.submitSuccess")),p(),T.push({path:`/knowledge/${u}/${F}/${z}/document`})})}else k.value++>2&&(k.value=0);else I.value=!1}const S=()=>{k.value=0};function p(){P.saveDocumentsFile([]),P.saveDocumentsType("")}function v(){var m;$.value=!0;const f=[];(m=i.value)==null||m.paragraphList.map(c=>{var t;(t=i.value)!=null&&t.checkedConnect||c.content.map(a=>{delete a.problemList}),f.push({name:c.name,paragraphs:c.content,sourceFileId:c.sourceFileId})}),u&&O({type:"document",systemType:d.value}).putMulDocument(u,f).then(()=>{ue(A("common.submitSuccess")),p(),T.push({path:`/knowledge/${u}/${F}/${z}/document`})}).catch(()=>{$.value=!1})}return Ce(()=>{p()}),(f,m)=>{var q,U,H,K;const c=n("back-button"),t=n("el-scrollbar"),a=n("el-card"),x=n("el-button"),Z=me("loading");return _(),E("div",Kt,[e("div",Ot,[s(c,{to:"-1",style:{"margin-left":"-4px"}}),e("h3",Zt,l(f.$t("views.document.uploadDocument")),1)]),s(a,{style:{"--el-card-padding":"0"}},{default:o(()=>[ve((_(),E("div",jt,[e("div",Gt,[s(t,null,{default:o(()=>[k.value===0?(_(),E("div",Jt,[s(Qt,{ref_key:"UploadComponentRef",ref:V},null,512)])):k.value===1?(_(),C(ct,{key:1,ref_key:"SetRulesRef",ref:i},null,512)):k.value===2?(_(),C(yt,{key:2,data:r.value},null,8,["data"])):Q("",!0)]),_:1})])])),[[Z,$.value]])]),_:1}),k.value!==2?(_(),E("div",Wt,[s(x,{onClick:m[0]||(m[0]=Y=>B(T).go(-1)),disabled:((q=i.value)==null?void 0:q.loading)||$.value},{default:o(()=>[w(l(f.$t("common.cancel")),1)]),_:1},8,["disabled"]),k.value===1?(_(),C(x,{key:0,onClick:S,disabled:((U=i.value)==null?void 0:U.loading)||$.value},{default:o(()=>[w(l(f.$t("views.document.buttons.prev")),1)]),_:1},8,["disabled"])):Q("",!0),k.value===0?(_(),C(x,{key:1,onClick:g,type:"primary",disabled:((H=i.value)==null?void 0:H.loading)||$.value},{default:o(()=>[w(l(L.value==="txt"?f.$t("views.document.buttons.next"):f.$t("views.document.buttons.import")),1)]),_:1},8,["disabled"])):Q("",!0),k.value===1?(_(),C(x,{key:2,onClick:v,type:"primary",disabled:((K=i.value)==null?void 0:K.loading)||$.value},{default:o(()=>[w(l(f.$t("views.document.buttons.import")),1)]),_:1},8,["disabled"])):Q("",!0)])):Q("",!0)])}}}),ol=W(Yt,[["__scopeId","data-v-ce247a1e"]]);export{ol as default};

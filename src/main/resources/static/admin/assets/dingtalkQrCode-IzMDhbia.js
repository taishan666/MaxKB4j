import{_ as g}from"./logo_dingtalk-CyDPr22R.js";import{ay as m,az as u,aA as f,cm as _,aB as h,aR as k,aT as y,aF as w,aI as o,aJ as C,aY as v,ca as R}from"./admin-BR73EsEN.js";const q={class:"flex-center mb-16"},T=m({__name:"dingtalkQrCode",props:{config:{}},setup(r){const a=r,s=u(),{login:c}=f(),{load:d}=_("https://g.alicdn.com/dingding/h5-dingtalk-login/0.21.0/ddlogin.js"),n=h(!1),p=async()=>{try{if(await d(!0),!n.value)return;const e={appKey:a.config.app_key,appSecret:a.config.app_secret,corp_id:a.config.corp_id},t=encodeURIComponent(window.location.origin);window.DTFrameLogin({id:"ding-talk-qr",width:280,height:280},{redirect_uri:t,client_id:e.appKey,scope:"openid corpid",response_type:"code",state:"fit2cloud-ding-qr",prompt:"consent",corpId:e.corp_id},i=>{const l=i.authCode;c.dingCallback(l).then(()=>{s.push({name:"home"})})},i=>{R(i)})}catch(e){console.error(e)}};return k(()=>a.config,e=>{e.app_key&&e.corp_id&&(n.value=!0,p())},{immediate:!0}),(e,t)=>(w(),y(v,null,[o("div",q,[t[0]||(t[0]=o("img",{src:g,alt:"",width:"24px",class:"mr-4"},null,-1)),o("h2",null,C(e.$t("views.system.authentication.scanTheQRCode.dingtalkQrCode")),1)]),t[1]||(t[1]=o("div",{class:"ding-talk-qrName"},[o("div",{id:"ding-talk-qr"})],-1))],64))}});export{T as default};

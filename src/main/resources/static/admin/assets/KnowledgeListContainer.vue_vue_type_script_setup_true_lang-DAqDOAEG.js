import{ay as Y,aA as J,az as ee,aP as te,aQ as E,aB as u,aR as O,aD as _,aE as i,aF as s,aG as t,aU as w,aI as g,aH as o,a_ as T,aK as h,aJ as d,aW as B,b5 as H,aC as x,aX as ie,dc as Pe,b_ as Ue,dd as Be,b9 as Me,b3 as We,aT as Q,b4 as Xe,de as qe,b8 as R,aY as de,aZ as _e,cT as Ee,cp as U,df as He,dg as Ge,cu as Oe,cz as je,cA as Ze,dh as Qe,cB as Ye,d9 as Je,di as et,bD as tt,dj as ot,c1 as ye,a$ as ve,bK as at,c9 as lt}from"./admin-BpafW2aq.js";import{_ as le}from"./BaseForm.vue_vue_type_script_setup_true_lang-DJOCnbCV.js";import"./data-C8Uq-ThI.js";import{S as nt}from"./SyncWebDialog-D3XFbGWF.js";import{M as rt}from"./MoveToDialog-DYF-1p2F.js";import{_ as st}from"./index.vue_vue_type_script_setup_true_lang-CCgcxcNW.js";import{_ as dt}from"./AuthorizedWorkspaceDialog.vue_vue_type_script_setup_true_lang-CILYzMiU.js";import{_ as it}from"./index.vue_vue_type_script_setup_true_lang-7EgtE-p1.js";const ct={class:"dialog-footer"},ut=Y({__name:"CreateKnowledgeDialog",emits:["refresh"],setup(oe,{expose:M,emit:z}){const F=z,{user:I}=J(),V=ee(),v=te(),S=E(()=>v.path.includes("shared")?"systemShare":v.path.includes("resource-management")?"systemManage":"workspace"),p=u(),c=u(!1),f=u(!1),y=u(null);O(f,b=>{b||(y.value=null)});const L=b=>{y.value=b,f.value=!0},k=async()=>{var b,m;if(await((b=p.value)==null?void 0:b.validate())){const N={folderId:(m=y.value)==null?void 0:m.id,...p.value.form};B({type:"knowledge",systemType:S.value}).postKnowledge(N,c).then(async a=>(await I.profile(),a)).then(a=>{H(x("common.createSuccess")),V.push({path:`/knowledge/${a.data.id}/${y.value.id||"shared"}/document`}),F("refresh")})}else return!1};return M({open:L}),(b,m)=>{const N=_("el-button"),a=_("el-dialog");return s(),i(a,{title:b.$t("views.knowledge.knowledgeType.createGeneralKnowledge"),modelValue:f.value,"onUpdate:modelValue":m[1]||(m[1]=n=>f.value=n),width:"720","append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:t(()=>[g("span",ct,[o(N,{onClick:m[0]||(m[0]=T(n=>f.value=!1,["prevent"])),loading:c.value},{default:t(()=>[h(d(b.$t("common.cancel")),1)]),_:1},8,["loading"]),o(N,{type:"primary",onClick:k,loading:c.value},{default:t(()=>[h(d(b.$t("common.create")),1)]),_:1},8,["loading"])])]),default:t(()=>[f.value?(s(),i(le,{key:0,ref_key:"BaseFormRef",ref:p,apiType:S.value},null,8,["apiType"])):w("",!0)]),_:1},8,["title","modelValue"])}}}),pt={class:"dialog-footer"},ft=Y({__name:"CreateWebKnowledgeDialog",emits:["refresh"],setup(oe,{expose:M,emit:z}){const F=z,{user:I}=J(),V=ee(),v=te(),S=E(()=>v.path.includes("shared")?"systemShare":v.path.includes("resource-management")?"systemManage":"workspace"),p=u(),c=u(),f=u(!1),y=u(!1),L=u({sourceUrl:"",selector:""}),k=ie({sourceUrl:[{required:!0,message:x("views.knowledge.form.sourceUrl.requiredMessage"),trigger:"blur"}]}),b=u(null);O(y,a=>{var n;a||(b.value=null,L.value={sourceUrl:"",selector:""},(n=c.value)==null||n.clearValidate())});const m=a=>{b.value=a,y.value=!0},N=async()=>{var a;if(await((a=p.value)==null?void 0:a.validate()))await c.value.validate(n=>{var C;if(n){const K={folderId:(C=b.value)==null?void 0:C.id,...p.value.form,...L.value};B({type:"knowledge",systemType:S.value}).postWebKnowledge(K,f).then(async D=>(await I.profile(),D)).then(D=>{H(x("common.createSuccess")),V.push({path:`/knowledge/${D.data.id}/${b.value.id||"shared"}/${D.data.type}/document`,query:{from:S.value}}),F("refresh")})}else return!1});else return!1};return M({open:m}),(a,n)=>{const C=_("el-input"),K=_("el-form-item"),D=_("el-form"),X=_("el-button"),G=_("el-dialog");return s(),i(G,{title:a.$t("views.knowledge.knowledgeType.createWebKnowledge"),modelValue:y.value,"onUpdate:modelValue":n[5]||(n[5]=$=>y.value=$),width:"720","append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:t(()=>[g("span",pt,[o(X,{onClick:n[4]||(n[4]=T($=>y.value=!1,["prevent"])),loading:f.value},{default:t(()=>[h(d(a.$t("common.cancel")),1)]),_:1},8,["loading"]),o(X,{type:"primary",onClick:N,loading:f.value},{default:t(()=>[h(d(a.$t("common.create")),1)]),_:1},8,["loading"])])]),default:t(()=>[y.value?(s(),i(le,{key:0,ref_key:"BaseFormRef",ref:p,apiType:S.value},null,8,["apiType"])):w("",!0),o(D,{ref_key:"KnowledgeFormRef",ref:c,rules:k,model:L.value,"label-position":"top","require-asterisk-position":"right"},{default:t(()=>[o(K,{label:a.$t("views.knowledge.form.sourceUrl.label"),prop:"sourceUrl"},{default:t(()=>[o(C,{modelValue:L.value.sourceUrl,"onUpdate:modelValue":n[0]||(n[0]=$=>L.value.sourceUrl=$),placeholder:a.$t("views.knowledge.form.sourceUrl.placeholder"),onBlur:n[1]||(n[1]=$=>L.value.sourceUrl=L.value.sourceUrl.trim())},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(K,{label:a.$t("views.knowledge.form.selector.label")},{default:t(()=>[o(C,{modelValue:L.value.selector,"onUpdate:modelValue":n[2]||(n[2]=$=>L.value.selector=$),placeholder:a.$t("views.knowledge.form.selector.placeholder"),onBlur:n[3]||(n[3]=$=>L.value.selector=L.value.selector.trim())},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["rules","model"])]),_:1},8,["title","modelValue"])}}}),mt={class:"dialog-footer"},gt=Y({__name:"CreateLarkKnowledgeDialog",emits:["refresh"],setup(oe,{expose:M,emit:z}){const F=z,{user:I}=J(),V=ee(),v=te(),S=E(()=>v.path.includes("shared")?"systemShare":v.path.includes("resource-management")?"systemManage":"workspace"),p=u(),c=u(),f=u(!1),y=u(!1),L=u(null),k=u({type:"0",sourceUrl:"",selector:"",app_id:"",app_secret:"",folder_token:""}),b=ie({sourceUrl:[{required:!0,message:x("views.knowledge.form.sourceUrl.requiredMessage"),trigger:"blur"}],app_id:[{required:!0,message:x("views.application.applicationAccess.larkSetting.appIdPlaceholder"),trigger:"blur"}],app_secret:[{required:!0,message:x("views.application.applicationAccess.larkSetting.appSecretPlaceholder"),trigger:"blur"}],folder_token:[{required:!0,message:x("views.application.applicationAccess.larkSetting.folderTokenPlaceholder"),trigger:"blur"}],dialogueNumber:[{required:!0,message:x("views.knowledge.form.dialogueNumber.requiredMessage"),trigger:"blur"}],token:[{required:!0,message:x("views.knowledge.form.token.requiredMessage"),trigger:"blur"}]});O(y,a=>{var n;a||(k.value={type:"0",sourceUrl:"",selector:""},(n=c.value)==null||n.clearValidate())});const m=a=>{L.value=a,y.value=!0},N=async()=>{var a;if(await((a=p.value)==null?void 0:a.validate()))await c.value.validate(n=>{var C;if(n){const K={folderId:(C=L.value)==null?void 0:C.id,...p.value.form,...k.value};B({type:"knowledge",systemType:S.value}).postLarkKnowledge(K,f).then(async D=>(await I.profile(),D)).then(D=>{H(x("common.createSuccess")),V.push({path:`/knowledge/${D.data.id}/${L.value.id||"shared"}/document`,query:{from:S.value}}),F("refresh")})}else return!1});else return!1};return M({open:m}),(a,n)=>{const C=_("el-input"),K=_("el-form-item"),D=_("el-form"),X=_("el-button"),G=_("el-dialog");return s(),i(G,{title:a.$t("views.knowledge.knowledgeType.createLarkKnowledge"),modelValue:y.value,"onUpdate:modelValue":n[4]||(n[4]=$=>y.value=$),width:"720","append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:t(()=>[g("span",mt,[o(X,{onClick:n[3]||(n[3]=T($=>y.value=!1,["prevent"])),loading:f.value},{default:t(()=>[h(d(a.$t("common.cancel")),1)]),_:1},8,["loading"]),o(X,{type:"primary",onClick:N,loading:f.value},{default:t(()=>[h(d(a.$t("common.create")),1)]),_:1},8,["loading"])])]),default:t(()=>[y.value?(s(),i(le,{key:0,ref_key:"BaseFormRef",ref:p,apiType:S.value},null,8,["apiType"])):w("",!0),o(D,{ref_key:"knowledgeFormRef",ref:c,rules:b,model:k.value,"label-position":"top","require-asterisk-position":"right"},{default:t(()=>[o(K,{label:"App ID",prop:"app_id"},{default:t(()=>[o(C,{modelValue:k.value.app_id,"onUpdate:modelValue":n[0]||(n[0]=$=>k.value.app_id=$),placeholder:a.$t("views.application.applicationAccess.larkSetting.appIdPlaceholder")},null,8,["modelValue","placeholder"])]),_:1}),o(K,{label:"App Secret",prop:"app_secret"},{default:t(()=>[o(C,{modelValue:k.value.app_secret,"onUpdate:modelValue":n[1]||(n[1]=$=>k.value.app_secret=$),type:"password","show-password":"",placeholder:a.$t("views.application.applicationAccess.larkSetting.appSecretPlaceholder")},null,8,["modelValue","placeholder"])]),_:1}),o(K,{label:"Folder Token",prop:"folder_token"},{default:t(()=>[o(C,{modelValue:k.value.folder_token,"onUpdate:modelValue":n[2]||(n[2]=$=>k.value.folder_token=$),placeholder:a.$t("views.application.applicationAccess.larkSetting.folderTokenPlaceholder")},null,8,["modelValue","placeholder"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["title","modelValue"])}}}),_t={default:{edges:[{id:"846dd161-450e-4d2f-8119-78557d88421c",type:"app-edge",endPoint:{x:550,y:720},pointsList:[{x:280,y:720},{x:390,y:720},{x:440,y:720},{x:550,y:720}],properties:{},startPoint:{x:280,y:720},sourceNodeId:"768aed24-8139-4689-870f-2065ef05473c",targetNodeId:"1bed736e-711f-4afd-8454-2c8502444af7",sourceAnchorId:"768aed24-8139-4689-870f-2065ef05473c_right",targetAnchorId:"1bed736e-711f-4afd-8454-2c8502444af7_left"},{id:"79cf563e-0b4d-4d41-ad6f-4ee0c6042af6",type:"app-edge",endPoint:{x:1010,y:720},pointsList:[{x:870,y:720},{x:980,y:720},{x:900,y:720},{x:1010,y:720}],properties:{},startPoint:{x:870,y:720},sourceNodeId:"1bed736e-711f-4afd-8454-2c8502444af7",targetNodeId:"9018d6b6-be6e-420b-9a0d-7226fd789398",sourceAnchorId:"1bed736e-711f-4afd-8454-2c8502444af7_right",targetAnchorId:"9018d6b6-be6e-420b-9a0d-7226fd789398_left"},{id:"38111bbe-f2ff-428e-acf8-c2f49e45fb08",type:"app-edge",endPoint:{x:550,y:1460},pointsList:[{x:280,y:1460},{x:390,y:1460},{x:440,y:1460},{x:550,y:1460}],properties:{},startPoint:{x:280,y:1460},sourceNodeId:"affa7bad-1898-4bdb-967b-9e12a72492c6",targetNodeId:"d81adcf1-bfd4-4a1c-b62c-e9ae0eb9488d",sourceAnchorId:"affa7bad-1898-4bdb-967b-9e12a72492c6_right",targetAnchorId:"d81adcf1-bfd4-4a1c-b62c-e9ae0eb9488d_left"},{id:"632ed493-fd99-461b-9510-f4e3d02120d0",type:"app-edge",endPoint:{x:1010,y:1460},pointsList:[{x:870,y:1460},{x:980,y:1460},{x:900,y:1460},{x:1010,y:1460}],properties:{},startPoint:{x:870,y:1460},sourceNodeId:"d81adcf1-bfd4-4a1c-b62c-e9ae0eb9488d",targetNodeId:"a1d0fa5d-4779-4364-8b54-7eff69bd1ec4",sourceAnchorId:"d81adcf1-bfd4-4a1c-b62c-e9ae0eb9488d_right",targetAnchorId:"a1d0fa5d-4779-4364-8b54-7eff69bd1ec4_left"},{id:"5888e8cc-75fc-4df7-a627-1dc6feedea17",type:"app-edge",endPoint:{x:1790,y:1440},pointsList:[{x:1490,y:720},{x:1600,y:720},{x:1680,y:1440},{x:1790,y:1440}],properties:{},startPoint:{x:1490,y:720},sourceNodeId:"9018d6b6-be6e-420b-9a0d-7226fd789398",targetNodeId:"ade860cd-db62-4538-9943-c8f42c1b927e",sourceAnchorId:"9018d6b6-be6e-420b-9a0d-7226fd789398_right",targetAnchorId:"ade860cd-db62-4538-9943-c8f42c1b927e_left"},{id:"3f294d6b-6f4f-4a5c-9d49-f118033eec70",type:"app-edge",endPoint:{x:1790,y:1440},pointsList:[{x:1490,y:1460},{x:1600,y:1460},{x:1680,y:1440},{x:1790,y:1440}],properties:{},startPoint:{x:1490,y:1460},sourceNodeId:"a1d0fa5d-4779-4364-8b54-7eff69bd1ec4",targetNodeId:"ade860cd-db62-4538-9943-c8f42c1b927e",sourceAnchorId:"a1d0fa5d-4779-4364-8b54-7eff69bd1ec4_right",targetAnchorId:"ade860cd-db62-4538-9943-c8f42c1b927e_left"},{id:"d04c1570-6572-4505-bf84-f29d81c30e57",type:"app-edge",endPoint:{x:1790,y:1440},pointsList:[{x:1490,y:2190},{x:1600,y:2190},{x:1680,y:1440},{x:1790,y:1440}],properties:{},startPoint:{x:1490,y:2190},sourceNodeId:"dddebd93-ea1a-4880-8a52-ea8112f7e769",targetNodeId:"ade860cd-db62-4538-9943-c8f42c1b927e",sourceAnchorId:"dddebd93-ea1a-4880-8a52-ea8112f7e769_right",targetAnchorId:"ade860cd-db62-4538-9943-c8f42c1b927e_left"},{id:"536d7d47-9ad8-4144-a6df-35e3e2398327",type:"app-edge",endPoint:{x:2430,y:1430},pointsList:[{x:2110,y:1440},{x:2220,y:1440},{x:2320,y:1430},{x:2430,y:1430}],properties:{},startPoint:{x:2110,y:1440},sourceNodeId:"ade860cd-db62-4538-9943-c8f42c1b927e",targetNodeId:"1c5abed5-e181-41f7-96f5-b5175cc37f3c",sourceAnchorId:"ade860cd-db62-4538-9943-c8f42c1b927e_right",targetAnchorId:"1c5abed5-e181-41f7-96f5-b5175cc37f3c_left"},{id:"8b5bb2b5-5baa-4e54-b848-fa87231d9585",type:"app-edge",endPoint:{x:1010,y:2190},pointsList:[{x:870,y:2190},{x:980,y:2190},{x:900,y:2190},{x:1010,y:2190}],properties:{},startPoint:{x:870,y:2190},sourceNodeId:"08503db8-f2e3-4eb3-96f7-957f30a6da6e",targetNodeId:"dddebd93-ea1a-4880-8a52-ea8112f7e769",sourceAnchorId:"08503db8-f2e3-4eb3-96f7-957f30a6da6e_right",targetAnchorId:"dddebd93-ea1a-4880-8a52-ea8112f7e769_left"}],nodes:[{x:120,y:115.05849999999998,id:"knowledge-base-node",type:"knowledge-base-node",properties:{config:{fields:[],globalFields:[]},height:394.383,showNode:!0,nodeName:"基本信息",nodeData:{desc:"",name:"",prologue:`您好，我是 XXX 小助手，您可以向我提出 XXX 使用问题。
- XXX 主要功能有什么？
- XXX 如何收费？
- 需要转人工服务`,tts_type:"BROWSER"},inputFieldList:[],user_input_config:{title:"文档处理设置"},user_input_field_list:[]}},{x:120,y:720,id:"768aed24-8139-4689-870f-2065ef05473c",type:"data-source-local-node",properties:{kind:"data-source",config:{fields:[{label:"文件列表",value:"fileList"}]},height:566,showNode:!0,nodeName:"文本文件",nodeData:{fileTypeList:["TXT","DOCX","PDF","HTML","XLS","XLSX","CSV"],fileSizeLimit:100,fileCountLimit:50},inputFieldList:[],user_input_config:{},user_input_field_list:[]}},{x:710,y:720,id:"1bed736e-711f-4afd-8454-2c8502444af7",type:"document-extract-node",properties:{config:{fields:[{label:"文档内容",value:"content"},{label:"文档列表",value:"documentList"}]},height:394,showNode:!0,nodeName:"文档内容提取",condition:"OR",nodeData:{documentList:["768aed24-8139-4689-870f-2065ef05473c","fileList"]}}},{x:1250,y:2190,id:"dddebd93-ea1a-4880-8a52-ea8112f7e769",type:"document-split-node",properties:{width:500,config:{fields:[{label:"分段列表",value:"paragraphList"}]},height:652,showNode:!0,nodeName:"Web智能分段",condition:"AND",nodeData:{limit:4096,patterns:[],chunkSize:256,limit_type:"custom",withFilter:!1,documentList:["08503db8-f2e3-4eb3-96f7-957f30a6da6e","documentList"],patterns_type:"custom",splitStrategy:"auto",chunk_size_type:"custom",limit_reference:[],with_filter_type:"custom",patterns_reference:[],chunk_size_reference:[],with_filter_reference:[],documentNameRelateProblem:!1,paragraphTitleRelateProblem:!0,document_name_relate_problem_type:"custom",paragraph_title_relate_problem_type:"custom",document_name_relate_problem_reference:[],paragraph_title_relate_problem_reference:[]}}},{x:2590,y:1430,id:"1c5abed5-e181-41f7-96f5-b5175cc37f3c",type:"knowledge-write-node",properties:{config:{fields:[]},height:278,showNode:!0,nodeName:"知识库写入",condition:"AND",nodeData:{documentList:["ade860cd-db62-4538-9943-c8f42c1b927e","Segmented_List"]}}},{x:1250,y:720,id:"9018d6b6-be6e-420b-9a0d-7226fd789398",type:"document-split-node",properties:{width:500,config:{fields:[{label:"分段列表",value:"paragraphList"}]},height:652,showNode:!0,nodeName:"智能分段",condition:"AND",nodeData:{limit:4096,patterns:[],chunkSize:256,limit_type:"custom",withFilter:!1,documentList:["1bed736e-711f-4afd-8454-2c8502444af7","documentList"],patterns_type:"custom",splitStrategy:"auto",chunk_size_type:"custom",limit_reference:[],with_filter_type:"custom",patterns_reference:[],chunk_size_reference:[],with_filter_reference:[],documentNameRelateProblem:!0,paragraphTitleRelateProblem:!0,document_name_relate_problem_type:"custom",paragraph_title_relate_problem_type:"custom",document_name_relate_problem_reference:[],paragraph_title_relate_problem_reference:[]}}},{x:120,y:1460,id:"affa7bad-1898-4bdb-967b-9e12a72492c6",type:"data-source-local-node",properties:{kind:"data-source",config:{fields:[{label:"文件列表",value:"fileList"}]},height:536,showNode:!0,nodeName:"QA问答对",nodeData:{fileTypeList:["XLS","XLSX","CSV","ZIP"],fileSizeLimit:100,fileCountLimit:50},inputFieldList:[],user_input_config:{},user_input_field_list:[]}},{x:710,y:1460,id:"d81adcf1-bfd4-4a1c-b62c-e9ae0eb9488d",type:"document-extract-node",properties:{config:{fields:[{label:"文档内容",value:"content"},{label:"文档列表",value:"documentList"}]},height:394,showNode:!0,nodeName:"文档内容提取1",condition:"AND",nodeData:{documentList:["affa7bad-1898-4bdb-967b-9e12a72492c6","fileList"]}}},{x:1250,y:1460,id:"a1d0fa5d-4779-4364-8b54-7eff69bd1ec4",type:"document-split-node",properties:{width:500,config:{fields:[{label:"分段列表",value:"paragraphList"}]},height:580,showNode:!0,nodeName:"QA问答对分段",condition:"AND",nodeData:{limit:4096,patterns:[],chunkSize:256,limit_type:"custom",withFilter:!1,documentList:["d81adcf1-bfd4-4a1c-b62c-e9ae0eb9488d","documentList"],patterns_type:"custom",splitStrategy:"qa",chunk_size_type:"custom",limit_reference:[],with_filter_type:"custom",patterns_reference:[],chunk_size_reference:[],with_filter_reference:[],documentNameRelateProblem:!0,paragraphTitleRelateProblem:!1,document_name_relate_problem_type:"custom",paragraph_title_relate_problem_type:"custom",document_name_relate_problem_reference:[],paragraph_title_relate_problem_reference:[]}}},{x:1950,y:1440,id:"ade860cd-db62-4538-9943-c8f42c1b927e",type:"variable-aggregation-node",properties:{config:{fields:[{label:"文档分段列表",value:"Segmented_List"}]},height:570.7660000000001,showNode:!0,nodeName:"聚合文档分段列表",condition:"OR",nodeData:{strategy:"first_non_null",is_result:!0,groupList:[{id:"kU2zR8yRzNIt3RXKHmJtL",field:"Segmented_List",label:"文档分段列表",variableList:[{v_id:"N59Lo_VyRKuYASHaKN6g0",variable:["9018d6b6-be6e-420b-9a0d-7226fd789398","paragraphList"]},{v_id:"IRQkWPB7THGXlkSBCWmkY",variable:["a1d0fa5d-4779-4364-8b54-7eff69bd1ec4","paragraphList"]},{v_id:"jGrIINd-6O6UEzNmZvFap",variable:["dddebd93-ea1a-4880-8a52-ea8112f7e769","paragraphList"]}]}]}}},{x:710,y:2190,id:"08503db8-f2e3-4eb3-96f7-957f30a6da6e",type:"data-source-web-node",properties:{kind:"data-source",config:{fields:[{label:"文档列表",value:"documentList"}]},height:292,showNode:!0,nodeName:"Web站点"}}]}},yt={class:"dialog-footer"},vt=Y({__name:"CreateWorkflowKnowledgeDialog",emits:["refresh"],setup(oe,{expose:M,emit:z}){const F=z,{user:I}=J(),V=ee(),v=te(),S=E(()=>v.path.includes("shared")?"systemShare":v.path.includes("resource-management")?"systemManage":"workspace"),p=u(),c=u(!1),f=u(!1),y=u(null),L=u(_t.default);O(f,m=>{m||(y.value=null)});const k=m=>{y.value=m,f.value=!0},b=async()=>{var m,N;if(await((m=p.value)==null?void 0:m.validate())){const a={folderId:(N=y.value)==null?void 0:N.id,workFlow:L.value,...p.value.form};B({type:"knowledge",systemType:S.value}).createWorkflowKnowledge(a,c).then(async n=>(await I.profile(),n)).then(n=>{H(x("common.createSuccess")),V.push({path:`/knowledge/${n.data.id}/${y.value.id||"shared"}/workflow`}),F("refresh")})}else return!1};return M({open:k}),(m,N)=>{const a=_("el-button"),n=_("el-dialog");return s(),i(n,{title:m.$t("views.knowledge.knowledgeType.createWorkflowKnowledge"),modelValue:f.value,"onUpdate:modelValue":N[1]||(N[1]=C=>f.value=C),width:"720","append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:t(()=>[g("span",yt,[o(a,{onClick:N[0]||(N[0]=T(C=>f.value=!1,["prevent"])),loading:c.value},{default:t(()=>[h(d(m.$t("common.cancel")),1)]),_:1},8,["loading"]),o(a,{type:"primary",onClick:b,loading:c.value},{default:t(()=>[h(d(m.$t("common.create")),1)]),_:1},8,["loading"])])]),default:t(()=>[f.value?(s(),i(le,{key:0,ref_key:"BaseFormRef",ref:p,apiType:S.value},null,8,["apiType"])):w("",!0)]),_:1},8,["title","modelValue"])}}}),bt={class:"flex"},wt={class:"complex-search"},ht={class:"flex"},kt={class:"pre-wrap ml-8"},$t={class:"lighter"},Lt={class:"flex"},xt={class:"pre-wrap ml-8"},Nt={class:"lighter"},Ct={class:"flex"},St={class:"pre-wrap ml-8"},Tt={class:"lighter"},It={class:"flex"},Dt={class:"pre-wrap ml-8"},Rt={class:"lighter"},At={style:{"max-height":"calc(100vh - 120px)"}},Vt={class:"footer-content flex-between"},Kt={class:"bold mr-4"},zt={class:"color-secondary"},Ft={class:"bold mr-4"},Pt={class:"color-secondary"},Ut={class:"bold mr-4"},Bt={class:"color-secondary"},jt=Y({__name:"KnowledgeListContainer",emits:["refreshFolder"],setup(oe,{emit:M}){const z=ee(),F=te(),{folder:I,user:V,knowledge:v}=J();Pe((e,r)=>{v.setKnowledgeList([])});const S=M,p=E(()=>F.path.includes("shared")?"systemShare":F.path.includes("resource-management")?"systemManage":"workspace"),c=E(()=>Ue.knowledge[p.value]),f=E(()=>I.currentFolder.id==="share"),y=E(()=>p.value==="systemShare"),L=e=>e.type===1&&c.value.sync(e.id)||c.value.vector(e.id)||c.value.generate(e.id)||(c.value.edit(e.id)&&p.value)==="workspace"||c.value.export(e.id)||c.value.auth(e.id)||c.value.delete(e.id)||y.value,k=u(!1),b=u("name"),m=u({name:"",createUser:""}),N=u([]),a=ie({current_page:1,page_size:30,total:0}),n=u();function C(e){n.value.open(e.id)}const K=u();function D(e){const r=ve.cloneDeep(v.knowledgeList),P=r.findIndex(W=>W.id===e.id);r.splice(P,1),v.setKnowledgeList(r)}const X=u(),G=Be(null);function $(e){G.value=e,at(()=>{X.value.open(I.currentFolder)})}function be(e){B({type:"knowledge",systemType:p.value}).putReEmbeddingKnowledge(e.id).then(()=>{H(x("common.submitSuccess"))})}const ce=u();function we(e){ce.value.open(e.id)}const he=()=>{m.value={name:"",createUser:""}},ne=u();function ke(e){ne.value&&ne.value.open([],"knowledge",e)}const $e=e=>{B({type:"knowledge",systemType:p.value}).exportKnowledge(e.name,e.id,k).then(()=>{H(x("common.exportSuccess"))})},Le=e=>{B({type:"knowledge",systemType:p.value}).exportZipKnowledge(e.name,e.id,k).then(()=>{H(x("common.exportSuccess"))})};function xe(e){lt(`${x("views.knowledge.delete.confirmTitle")}${e.name} ?`,`${x("views.knowledge.delete.confirmMessage1")} ${e.applicationMappingCount} ${x("views.knowledge.delete.confirmMessage2")}`,{confirmButtonText:x("common.confirm"),confirmButtonClass:"danger"}).then(()=>{B({type:"knowledge",systemType:p.value}).delKnowledge(e.id,k).then(()=>{const r=ve.cloneDeep(v.knowledgeList),P=r.findIndex(W=>W.id===e.id);r.splice(P,1),v.setKnowledgeList(r),H(x("common.deleteSuccess"))})}).catch(()=>{})}const re=u();function Ne(e){re.value&&re.value.open(e)}const Ce=u();O(()=>I.currentFolder,e=>{e&&e.id&&(a.current_page=1,v.setKnowledgeList([]),j())},{deep:!0,immediate:!0}),O(()=>v.type,()=>{a.current_page=1,v.setKnowledgeList([]),j()});function j(){var r;const e={folderId:((r=I.currentFolder)==null?void 0:r.id)||V.getWorkspaceId(),scope:p.value==="systemShare"?"SHARED":"WORKSPACE",type:v.type||null};m.value[b.value]&&(e[b.value]=m.value[b.value]),B({type:"knowledge",isShared:f.value,systemType:p.value}).getKnowledgeListPage(a,e,k).then(P=>{var W;a.total=(W=P.data)==null?void 0:W.total,v.setKnowledgeList([...v.knowledgeList,...P.data.records])})}function ue(){a.current_page=1,v.setKnowledgeList([]),j()}function Se(){S("refreshFolder")}return Me(()=>{p.value!=="workspace"&&j(),B({type:"workspace",isShared:f.value,systemType:p.value}).getAllMemberList(V.getWorkspaceId(),k).then(e=>{N.value=e.data})}),(e,r)=>{const P=_("el-option"),W=_("el-select"),Te=_("el-input"),Ie=_("arrow-down"),De=_("el-icon"),pe=_("el-button"),ae=_("el-avatar"),Z=_("el-text"),A=_("el-dropdown-item"),fe=_("el-dropdown-menu"),me=_("el-dropdown"),Re=_("el-tag"),ge=_("el-divider"),Ae=_("el-col"),Ve=_("el-row"),Ke=_("el-empty"),ze=We("loading");return s(),Q(de,null,[o(et,null,{header:t(()=>[Je(e.$slots,"header")]),search:t(()=>[g("div",bt,[g("div",wt,[o(W,{class:"complex-search__left",modelValue:b.value,"onUpdate:modelValue":r[0]||(r[0]=l=>b.value=l),style:{width:"120px"},onChange:he},{default:t(()=>[o(P,{label:e.$t("common.creator"),value:"createUser"},null,8,["label"]),o(P,{label:e.$t("common.name"),value:"name"},null,8,["label"])]),_:1},8,["modelValue"]),b.value==="name"?(s(),i(Te,{key:0,modelValue:m.value.name,"onUpdate:modelValue":r[1]||(r[1]=l=>m.value.name=l),onChange:ue,placeholder:e.$t("common.searchBar.placeholder"),style:{width:"220px"},clearable:""},null,8,["modelValue","placeholder"])):b.value==="createUser"?(s(),i(W,{key:1,modelValue:m.value.createUser,"onUpdate:modelValue":r[2]||(r[2]=l=>m.value.createUser=l),onChange:ue,filterable:"",clearable:"",style:{width:"220px"}},{default:t(()=>[(s(!0),Q(de,null,_e(N.value,l=>(s(),i(P,{key:l.id,value:l.id,label:l.nickname},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])):w("",!0)]),!f.value&&c.value.create()?(s(),i(me,{key:0,trigger:"click"},{dropdown:t(()=>[o(fe,{class:"create-dropdown"},{default:t(()=>[o(A,{onClick:r[3]||(r[3]=l=>$(ut))},{default:t(()=>[g("div",ht,[o(ae,{class:"avatar-blue mt-4",shape:"square",size:32},{default:t(()=>r[10]||(r[10]=[g("img",{src:je,style:{width:"58%"},alt:""},null,-1)])),_:1,__:[10]}),g("div",kt,[g("div",$t,d(e.$t("views.knowledge.knowledgeType.generalKnowledge")),1),o(Z,{type:"info",size:"small"},{default:t(()=>[h(d(e.$t("views.knowledge.knowledgeType.generalInfo")),1)]),_:1})])])]),_:1}),o(A,{onClick:r[4]||(r[4]=l=>$(ft))},{default:t(()=>[g("div",Lt,[o(ae,{class:"avatar-purple mt-4",shape:"square",size:32},{default:t(()=>r[11]||(r[11]=[g("img",{src:Ze,style:{width:"58%"},alt:""},null,-1)])),_:1,__:[11]}),g("div",xt,[g("div",Nt,d(e.$t("views.knowledge.knowledgeType.webKnowledge")),1),o(Z,{type:"info",size:"small"},{default:t(()=>[h(d(e.$t("views.knowledge.knowledgeType.webInfo")),1)]),_:1})])])]),_:1}),R(V).isPE()||R(V).isEE()?(s(),i(A,{key:0,onClick:r[5]||(r[5]=l=>$(gt))},{default:t(()=>[g("div",Ct,[o(ae,{class:"avatar-purple mt-4",shape:"square",size:32,style:{background:"none"}},{default:t(()=>r[12]||(r[12]=[g("img",{src:Qe,alt:""},null,-1)])),_:1,__:[12]}),g("div",St,[g("div",Tt,d(e.$t("views.knowledge.knowledgeType.larkKnowledge")),1),o(Z,{type:"info",size:"small"},{default:t(()=>[h(d(e.$t("views.knowledge.knowledgeType.larkInfo")),1)]),_:1})])])]),_:1})):w("",!0),o(A,{onClick:r[6]||(r[6]=l=>$(vt))},{default:t(()=>[g("div",It,[o(ae,{class:"avatar-orange mt-4",shape:"square",size:32},{default:t(()=>r[13]||(r[13]=[g("img",{src:Ye,style:{width:"60%"},alt:""},null,-1)])),_:1,__:[13]}),g("div",Dt,[g("div",Rt,d(e.$t("views.knowledge.knowledgeType.workflowKnowledge")),1),o(Z,{type:"info",size:"small"},{default:t(()=>[h(d(e.$t("views.knowledge.knowledgeType.workflowInfo")),1)]),_:1})])])]),_:1})]),_:1})]),default:t(()=>[o(pe,{type:"primary",class:"ml-8"},{default:t(()=>[h(d(e.$t("common.create"))+" ",1),o(De,{class:"el-icon--right"},{default:t(()=>[o(Ie)]),_:1})]),_:1})]),_:1})):w("",!0)])]),default:t(()=>[Xe((s(),Q("div",At,[o(qe,{size:R(v).knowledgeList.length,total:a.total,page_size:a.page_size,current_page:a.current_page,"onUpdate:current_page":r[9]||(r[9]=l=>a.current_page=l),onLoad:j,loading:k.value},{default:t(()=>[R(v).knowledgeList.length>0?(s(),i(Ve,{key:0,gutter:15,class:"w-full"},{default:t(()=>[(s(!0),Q(de,null,_e(R(v).knowledgeList,(l,Fe)=>(s(),i(Ae,{key:Fe,xs:24,sm:12,md:12,lg:6,xl:6,class:"mb-16"},{default:t(()=>[o(Ee,{title:l.name,description:l.desc,class:"cursor",onClick:se=>R(z).push({path:`/knowledge/${l.id}/${R(I).currentFolder.id||"shared"}/${l.type}/document`})},{icon:t(()=>[o(Oe,{type:l.type},null,8,["type"])]),subTitle:t(()=>[o(Z,{class:"color-secondary lighter",size:"small"},{default:t(()=>[h(d(e.$t("common.creator"))+": "+d(R(Ge)(l.nickname)),1)]),_:2},1024)]),tag:t(()=>[f.value||y.value?(s(),i(Re,{key:0,type:"info",class:"info-tag"},{default:t(()=>[h(d(R(x)("views.shared.title")),1)]),_:1})):w("",!0)]),footer:t(()=>[g("div",Vt,[g("div",null,[g("span",Kt,d((l==null?void 0:l.documentCount)||0),1),g("span",zt,d(e.$t("views.knowledge.document_count")),1),o(ge,{direction:"vertical"}),g("span",Ft,d(R(He)(l==null?void 0:l.charLength)||0),1),g("span",Pt,d(e.$t("common.character")),1),o(ge,{direction:"vertical"}),g("span",Ut,d((l==null?void 0:l.applicationMappingCount)||0),1),g("span",Bt,d(e.$t("views.knowledge.relatedApp_count")),1)])])]),mouseEnter:t(()=>[f.value?w("",!0):(s(),Q("div",{key:0,onClick:r[8]||(r[8]=T(()=>{},["stop"]))},[o(me,{trigger:"click"},{dropdown:t(()=>[o(fe,null,{default:t(()=>{var se;return[l.type===1&&c.value.sync(l.id)?(s(),i(A,{key:0,onClick:T(q=>we(l),["stop"])},{default:t(()=>[o(U,{iconName:"app-sync",class:"color-secondary"}),h(" "+d(e.$t("views.knowledge.setting.sync")),1)]),_:2},1032,["onClick"])):w("",!0),c.value.vector(l.id)?(s(),i(A,{key:1,onClick:T(q=>be(l),["stop"])},{default:t(()=>[o(U,{iconName:"app-vectorization",class:"color-secondary"}),h(" "+d(e.$t("views.knowledge.setting.vectorization")),1)]),_:2},1032,["onClick"])):w("",!0),c.value.generate(l.id)?(s(),i(A,{key:2,onClick:T(q=>ke(l),["stop"])},{default:t(()=>[o(U,{iconName:"app-generate-question",class:"color-secondary"}),h(" "+d(e.$t("views.document.generateQuestion.title")),1)]),_:2},1032,["onClick"])):w("",!0),y.value?(s(),i(A,{key:3,onClick:T(q=>Ne(l),["stop"])},{default:t(()=>[o(U,{iconName:"app-lock",class:"color-secondary"}),h(" "+d(e.$t("views.shared.authorized_workspace")),1)]),_:2},1032,["onClick"])):w("",!0),p.value==="workspace"&&((se=c.value)!=null&&se.auth(l.id))?(s(),i(A,{key:4,onClick:T(q=>C(l),["stop"])},{default:t(()=>[o(U,{iconName:"app-resource-authorization",class:"color-secondary"}),h(" "+d(e.$t("views.system.resourceAuthorization.title")),1)]),_:2},1032,["onClick"])):w("",!0),c.value.edit(l.id)?(s(),i(A,{key:5,onClick:T(q=>R(z).push({path:`/knowledge/${l.id}/${R(I).currentFolder.id||"shared"}/setting`}),["stop"])},{default:t(()=>[o(U,{iconName:"app-setting",class:"color-secondary"}),h(" "+d(e.$t("common.setting")),1)]),_:2},1032,["onClick"])):w("",!0),c.value.export(l.id)?(s(),i(A,{key:6,onClick:T(q=>$e(l),["stop"])},{default:t(()=>[o(U,{iconName:"app-export",class:"color-secondary"}),h(d(e.$t("views.document.setting.export"))+" Excel ",1)]),_:2},1032,["onClick"])):w("",!0),c.value.export(l.id)?(s(),i(A,{key:7,onClick:T(q=>Le(l),["stop"])},{default:t(()=>[o(U,{iconName:"app-export",class:"color-secondary"}),h(d(e.$t("views.document.setting.export"))+" ZIP",1)]),_:2},1032,["onClick"])):w("",!0),c.value.delete(l.id)?(s(),i(A,{key:8,type:"danger",onClick:T(q=>xe(l),["stop"])},{default:t(()=>[o(U,{iconName:"app-delete",class:"color-secondary"}),h(" "+d(e.$t("common.delete")),1)]),_:2},1032,["onClick"])):w("",!0)]}),_:2},1024)]),default:t(()=>[L(l)?(s(),i(pe,{key:0,text:"",onClick:r[7]||(r[7]=T(()=>{},["stop"]))},{default:t(()=>[o(U,{iconName:"app-more"})]),_:1})):w("",!0)]),_:2},1024)]))]),_:2},1032,["title","description","onClick"])]),_:2},1024))),128))]),_:1})):(s(),i(Ke,{key:1,description:e.$t("common.noData")},null,8,["description"]))]),_:1},8,["size","total","page_size","current_page","loading"])])),[[ze,a.current_page===1&&k.value,void 0,{fullscreen:!0,lock:!0}]])]),_:3}),f.value?w("",!0):(s(),i(tt(G.value),{key:0,ref_key:"CreateKnowledgeDialogRef",ref:X},null,512)),f.value?w("",!0):(s(),i(ot,{key:1,ref_key:"CreateFolderDialogRef",ref:Ce,onRefresh:Se},null,512)),o(st,{ref_key:"GenerateRelatedDialogRef",ref:ne,apiType:p.value},null,8,["apiType"]),f.value?w("",!0):(s(),i(nt,{key:2,ref_key:"SyncWebDialogRef",ref:ce},null,512)),y.value?(s(),i(dt,{key:3,ref_key:"AuthorizedWorkspaceDialogRef",ref:re},null,512)):w("",!0),p.value==="workspace"?(s(),i(rt,{key:4,ref_key:"MoveToDialogRef",ref:K,source:R(ye).KNOWLEDGE,onRefresh:D},null,8,["source"])):w("",!0),p.value==="workspace"?(s(),i(it,{key:5,type:R(ye).KNOWLEDGE,ref_key:"ResourceAuthorizationDrawerRef",ref:n},null,8,["type"])):w("",!0)],64)}}});export{jt as _};

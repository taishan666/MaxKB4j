import{aJ as F,cE as v,df as I,d5 as h,cF as w,eo as O,aS as n,aT as d,aM as i,cO as P,cI as p,aX as k,aL as S,aO as q,aN as B,eW as L}from"./admin-B6VfIzX8.js";const N={key:1,class:"lighter"},T=F({__name:"ParagraphForm",props:{data:{type:Object,default:()=>{}},isEdit:Boolean,knowledgeId:String},setup(m,{expose:b}){const u=m,_=["bold","underline","italic","-","title","strikeThrough","sub","sup","quote","unorderedList","orderedList","task","-","codeRow","code","link","image","table","mermaid","katex","-","revoke","next","=","pageFullscreen","preview","htmlPreview"],y=["markdownTotal",0,"=",1,"scrollSwitch"],V=v(),a=v({title:"",content:""}),E=I({content:[{required:!0,message:h("views.paragraph.form.content.requiredMessage1"),trigger:"blur"},{max:1e5,message:h("views.paragraph.form.content.requiredMessage2"),trigger:"blur"}]}),s=v();w(()=>u.data,e=>{e&&JSON.stringify(e)!=="{}"&&(a.value.title=e.title,a.value.content=e.content)},{immediate:!0}),w(()=>u.isEdit,e=>{var t;e||(t=s.value)==null||t.clearValidate()},{immediate:!0});function x(){if(s.value)return s.value.validate(e=>e)}const M=async(e,t)=>{const c=await Promise.all(e.map(r=>new Promise((f,g)=>{const l=new FormData;l.append("file",r),l.append("source_id",u.knowledgeId),l.append("source_type","KNOWLEDGE"),L.postImage(l).then(o=>{f(o)}).catch(o=>g(o))})));t(c.map(r=>r.data))};return O(()=>{a.value={title:"",content:""}}),b({validate:x,form:a}),(e,t)=>{const c=n("el-input"),r=n("el-form-item"),f=n("MdEditor"),g=n("MdPreview"),l=n("el-form");return i(),d(l,{ref_key:"paragraphFormRef",ref:s,model:a.value,"label-position":"top","require-asterisk-position":"right",rules:E,onSubmit:t[2]||(t[2]=P(()=>{},["prevent"]))},{default:p(()=>[k(r,{label:e.$t("views.paragraph.form.paragraphTitle.label")},{default:p(()=>[m.isEdit?(i(),d(c,{key:0,modelValue:a.value.title,"onUpdate:modelValue":t[0]||(t[0]=o=>a.value.title=o),placeholder:e.$t("views.paragraph.form.paragraphTitle.placeholder"),maxlength:"256","show-word-limit":""},null,8,["modelValue","placeholder"])):(i(),S("span",N,q(a.value.title||"-"),1))]),_:1},8,["label"]),k(r,{label:e.$t("views.paragraph.form.content.label"),prop:"content"},{default:p(()=>[m.isEdit?(i(),d(f,{key:0,modelValue:a.value.content,"onUpdate:modelValue":t[1]||(t[1]=o=>a.value.content=o),placeholder:e.$t("views.paragraph.form.content.placeholder"),maxLength:1e5,preview:!1,toolbars:_,style:{height:"300px"},onOnUploadImg:M,footers:y},{defFooters:p(()=>t[3]||(t[3]=[B("span",{style:{"margin-left":"-6px"}},"/ 100000",-1)])),_:1},8,["modelValue","placeholder"])):(i(),d(g,{key:1,ref_key:"editorRef",ref:V,editorId:"preview-only",modelValue:a.value.content,class:"maxkb-md"},null,8,["modelValue"]))]),_:1},8,["label"])]),_:1},8,["model","rules"])}}});export{T as _};

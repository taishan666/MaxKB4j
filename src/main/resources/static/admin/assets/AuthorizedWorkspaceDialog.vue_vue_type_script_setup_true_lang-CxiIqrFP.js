import{el as I,ed as x,aJ as Z,cE as p,aR as ee,aS as i,d0 as te,aT as T,aM as _,cI as a,aN as c,aX as l,cU as oe,aO as s,cN as h,aL as b,aU as ae,cG as D,cH as H}from"./admin-prbV92s5.js";import{l as le}from"./permission-api-RwKbGj5z.js";const v="/system/shared",se=(r,n)=>x(`${v}/knowledge/${r}/authorization`,{},n),ne=(r,n,u)=>I(`${v}/knowledge/${r}/authorization`,n,u),ie=(r,n)=>x(`${v}/tool/${r}/authorization`,{},n),re=(r,n,u)=>I(`${v}/tool/${r}/authorization`,n,u),ce=(r,n)=>x(`${v}/model/${r}/authorization`,{},n),de=(r,n,u)=>I(`${v}/model/${r}/authorization`,n,u),M={getSharedAuthorizationKnowledge:se,postSharedAuthorizationKnowledge:ne,getSharedAuthorizationTool:ie,postSharedAuthorizationTool:re,getSharedAuthorizationModel:ce,postSharedAuthorizationModel:de},ue={class:"mb-8"},pe={class:"mb-8 lighter"},_e={class:"mb-8 lighter mt-16"},he={class:"flex border",style:{overflow:"hidden"}},me={class:"border-r"},ve={class:"mt-8"},fe={class:"flex"},ge=["title"],ke={class:"w-full"},we={class:"flex-between p-16"},$e={class:"lighter"},Ce={class:"flex-between"},be={class:"flex align-center"},ye=["title"],Se=Z({__name:"AuthorizedWorkspaceDialog",setup(r,{expose:n}){const u=p(!1),y=p(!0),d=p([]),m=p([]),g=p("WHITE_LIST"),k=p("");let L="",W="Knowledge";const z=p(!1),f=p(!1),P=ee(()=>m.value.filter(e=>e.name.includes(k.value))),F=e=>{d.value=e?m.value:[],y.value=!1,e||N()},V=e=>{const t=e.length;u.value=t===m.value.length,y.value=t>0&&t<m.value.length},G=async({id:e},t="Knowledge")=>{L=e,z.value=!0,W=t;const[w,$]=await Promise.all([M[`getSharedAuthorization${t}`](e),le("workspace").getSystemWorkspaceList()]);m.value=$.data,g.value=(w.data||{}).authentication_type||"WHITE_LIST";let S=(w.data||{}).workspace_id_list||[];d.value=m.value.filter(A=>S.includes(A.id)),V(d.value),z.value=!1,f.value=!0},J=()=>{M[`postSharedAuthorization${W}`](L,{workspace_id_list:d.value.map(e=>e.id),authentication_type:g.value}).then(()=>{f.value=!1})},O=e=>{d.value=d.value.filter(t=>t.id!==e.id)},N=()=>{d.value=[],V([])};return n({open:G}),(e,t)=>{const w=i("el-text"),$=i("el-radio"),S=i("el-radio-group"),A=i("Search"),K=i("el-icon"),R=i("el-input"),U=i("el-checkbox"),B=i("AppIcon"),X=i("el-checkbox-group"),E=i("el-scrollbar"),C=i("el-button"),j=i("Close"),q=i("el-dialog"),Q=te("loading");return _(),T(q,{"modal-class":"authorized-workspace",modelValue:f.value,"onUpdate:modelValue":t[5]||(t[5]=o=>f.value=o),width:"840"},{header:a(({titleId:o,titleClass:Y})=>[c("h4",ue,s(e.$t("views.shared.authorized_workspace")),1),l(w,{class:"color-secondary lighter"},{default:a(()=>[h(s(e.$t("views.shared.authorized_tip")),1)]),_:1})]),footer:a(()=>[l(C,{onClick:t[4]||(t[4]=o=>f.value=!1)},{default:a(()=>[h(s(e.$t("common.cancel")),1)]),_:1}),l(C,{type:"primary",onClick:J},{default:a(()=>[h(s(e.$t("common.save")),1)]),_:1})]),default:a(()=>[c("p",pe,s(e.$t("views.shared.type")),1),l(S,{modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=o=>g.value=o)},{default:a(()=>[l($,{value:"WHITE_LIST"},{default:a(()=>[h(s(e.$t("views.shared.WHITE_LIST")),1)]),_:1}),l($,{value:"BLACK_LIST"},{default:a(()=>[h(s(e.$t("views.shared.BLACK_LIST")),1)]),_:1})]),_:1},8,["modelValue"]),c("p",_e,s(e.$t("views.shared.select_workspace")),1),oe((_(),b("div",he,[c("div",me,[l(R,{modelValue:k.value,"onUpdate:modelValue":t[1]||(t[1]=o=>k.value=o),"validate-event":!1,placeholder:e.$t("common.search"),style:{width:"364px",padding:"16px 16px 0 16px"},clearable:""},{prefix:a(()=>[l(K,null,{default:a(()=>[l(A)]),_:1})]),_:1},8,["modelValue","placeholder"]),c("div",ve,[k.value?ae("",!0):(_(),T(U,{key:0,class:"mb-8",style:{"margin-left":"16px"},modelValue:u.value,"onUpdate:modelValue":t[2]||(t[2]=o=>u.value=o),indeterminate:y.value,onChange:F},{default:a(()=>[h(s(e.$t("views.shared.allCheck")),1)]),_:1},8,["modelValue","indeterminate"])),l(E,{"max-height":"205","wrap-class":"p-16 pt-0"},{default:a(()=>[l(X,{class:"checkbox-group-block",modelValue:d.value,"onUpdate:modelValue":t[3]||(t[3]=o=>d.value=o),onChange:V},{default:a(()=>[(_(!0),b(D,null,H(P.value,o=>(_(),T(U,{key:o.id,label:o.name,value:o},{default:a(()=>[c("div",fe,[l(B,{iconName:"app-workspace"}),c("span",{class:"ml-4 ellipsis",title:o.name},s(o.name),9,ge)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})])]),c("div",ke,[c("div",we,[c("span",$e,s(e.$t("common.selected"))+": "+s(d.value.length)+" ä¸ª ",1),l(C,{onClick:N,link:"",type:"primary"},{default:a(()=>[h(s(e.$t("common.clear")),1)]),_:1})]),l(E,{"max-height":"250","wrap-class":"p-16 pt-0"},{default:a(()=>[(_(!0),b(D,null,H(d.value,o=>(_(),b("div",Ce,[c("div",be,[l(B,{iconName:"app-workspace"}),c("span",{class:"ml-4 lighter ellipsis",title:o.name},s(o.name),9,ye)]),l(C,{link:""},{default:a(()=>[l(K,{onClick:Y=>O(o),size:18},{default:a(()=>[l(j)]),_:2},1032,["onClick"])]),_:2},1024)]))),256))]),_:1})])])),[[Q,z.value]])]),_:1},8,["modelValue"])}}});export{Se as _};

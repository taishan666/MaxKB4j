import{ay as me,aA as $e,az as Le,aC as _,aB as c,aX as Se,aR as Te,aD as n,aE as C,aF as r,b8 as U,c6 as ue,aG as t,aH as o,aU as B,aI as s,bC as We,aK as A,aJ as p,a_ as z,cs as ne,b5 as Ie,co as ze,a$ as qe,cT as Be,aT as K,cJ as Q,dh as Ke,c4 as Ae,aP as to,aY as ce,aZ as be,c9 as Ne,aW as ao,aQ as He,b_ as lo,b9 as no,c$ as io,b3 as so,dk as ro,b4 as po,dg as co,e9 as uo,ea as mo,di as fo,b$ as _o,dl as vo,c1 as ke,cf as go,c0 as ho,b6 as he,bO as ae,bN as le,bP as M,b7 as J,ca as bo}from"./admin-DrZ65G2p.js";import{T as wo,_ as yo}from"./store-BmIi4GAd.js";import{b as Ze}from"./data-DYu2-02g.js";import{M as Co}from"./MoveToDialog-ApmFGeHS.js";import{_ as ko}from"./index.vue_vue_type_script_setup_true_lang-BbM9QvHJ.js";import"./constant-DwK_4rEF.js";import"./system-CkhRQyt6.js";const Ao="data:image/svg+xml,%3csvg%20width='20'%20height='20'%20viewBox='0%200%2020%2020'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M0.833313%207.4004C0.833313%207.04021%201.20266%206.79818%201.53291%206.94197L8.77364%2010.0945C8.95607%2010.1739%209.07404%2010.354%209.07404%2010.553V18.339C9.07404%2018.7152%208.67435%2018.9566%208.34141%2018.7816L1.14372%2014.9983C1.05096%2014.9474%200.973499%2014.8738%200.919056%2014.7847C0.864612%2014.6957%200.835079%2014.5943%200.833395%2014.4907L0.833313%2014.4814V7.4004ZM18.4644%206.93223C18.795%206.78607%2019.1666%207.0281%2019.1666%207.38952V14.4814C19.1666%2014.5866%2019.1379%2014.6899%2019.0833%2014.7807C19.0288%2014.8715%2018.9504%2014.9466%2018.8562%2014.9983L11.6585%2018.7816C11.3256%2018.9566%2010.9259%2018.7152%2010.9259%2018.339L10.9259%2010.5912C10.9259%2010.3933%2011.0427%2010.214%2011.2237%2010.1339L18.4644%206.93223ZM9.69988%201.7434C9.79147%201.69315%209.89483%201.66675%209.99998%201.66675C10.1051%201.66675%2010.2085%201.69315%2010.3001%201.7434L17.198%204.80727C17.5962%204.98413%2017.5934%205.55024%2017.1935%205.72316L10.1984%208.74757C10.0718%208.80232%209.92817%208.80232%209.80155%208.74757L2.80644%205.72316C2.40651%205.55025%202.40371%204.98413%202.80191%204.80727L9.69988%201.7434Z'%20fill='white'/%3e%3c/svg%3e",$o="data:image/svg+xml,%3csvg%20width='20'%20height='20'%20viewBox='0%200%2020%2020'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M3.18428%204.04678C3.99599%203.49862%204.93827%203.33337%205.56826%203.33337H12.5001C12.0398%203.33337%2011.6667%203.70647%2011.6667%204.16671C11.6667%204.62694%2012.0398%205.00004%2012.5001%205.00004H5.56826C5.17552%205.00004%204.58372%205.11283%204.11702%205.428C3.69634%205.71209%203.33341%206.18316%203.33341%207.06392C3.33341%207.94608%203.69793%208.42805%204.12319%208.72081C4.59235%209.04379%205.18357%209.16132%205.56826%209.16132H14.4978C15.1332%209.16132%2016.0634%209.3331%2016.8602%209.89052C17.7012%2010.4789%2018.3334%2011.4598%2018.3334%2012.9079C18.3334%2014.3555%2017.7017%2015.3385%2016.8624%2015.9298C16.0666%2016.4905%2015.1362%2016.6667%2014.4978%2016.6667H7.50008C7.96032%2016.6667%208.33342%2016.2936%208.33342%2015.8334C8.33342%2015.3731%207.96032%2015%207.50008%2015H14.4978C14.882%2015%2015.4529%2014.8841%2015.9025%2014.5673C16.3087%2014.2812%2016.6667%2013.8014%2016.6667%2012.9079C16.6667%2012.0149%2016.3092%2011.5391%2015.9047%2011.2562C15.4561%2010.9423%2014.8851%2010.828%2014.4978%2010.828H5.56826C4.93022%2010.828%203.98736%2010.6507%203.17811%2010.0936C2.32496%209.50629%201.66675%208.52289%201.66675%207.06392C1.66675%205.60354%202.32656%204.62601%203.18428%204.04678Z'%20fill='white'/%3e%3cpath%20d='M7.50008%2015C7.03984%2015%206.66675%2015.3731%206.66675%2015.8334C6.66675%2016.2936%207.03984%2016.6667%207.50008%2016.6667H2.50008C2.03984%2016.6667%201.66675%2016.2936%201.66675%2015.8334C1.66675%2015.3731%202.03984%2015%202.50008%2015H7.50008Z'%20fill='white'/%3e%3cpath%20d='M12.5001%205.00004C12.9603%205.00004%2013.3334%204.62694%2013.3334%204.16671C13.3334%203.70647%2012.9603%203.33337%2012.5001%203.33337H17.4546C17.9148%203.33337%2018.2879%203.70647%2018.2879%204.16671C18.2879%204.62694%2017.9148%205.00004%2017.4546%205.00004H12.5001Z'%20fill='white'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M12.5%203.33329C12.0398%203.33329%2011.6667%203.70639%2011.6667%204.16663C11.6667%204.62686%2012.0398%204.99996%2012.5%204.99996C12.9602%204.99996%2013.3333%204.62686%2013.3333%204.16663C13.3333%203.70639%2012.9602%203.33329%2012.5%203.33329ZM10%204.16663C10%202.78591%2011.1193%201.66663%2012.5%201.66663C13.8807%201.66663%2015%202.78591%2015%204.16663C15%205.54734%2013.8807%206.66663%2012.5%206.66663C11.1193%206.66663%2010%205.54734%2010%204.16663Z'%20fill='white'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M7.5%2015C7.03976%2015%206.66667%2015.3731%206.66667%2015.8334C6.66667%2016.2936%207.03976%2016.6667%207.5%2016.6667C7.96024%2016.6667%208.33333%2016.2936%208.33333%2015.8334C8.33333%2015.3731%207.96024%2015%207.5%2015ZM5%2015.8334C5%2014.4527%206.11929%2013.3334%207.5%2013.3334C8.88071%2013.3334%2010%2014.4527%2010%2015.8334C10%2017.2141%208.88071%2018.3334%207.5%2018.3334C6.11929%2018.3334%205%2017.2141%205%2015.8334Z'%20fill='white'/%3e%3c/svg%3e",Io={blank:{edges:[],nodes:Ze},assistant:{nodes:[{id:"base-node",type:"base-node",x:120,y:260.30849999999987,properties:{config:{},height:734.766,showNode:!0,nodeName:"基本信息",nodeData:{desc:"模板",name:"知识库问答助手",prologue:`您好，我是 XXX 小助手，您可以向我提出 XXX 使用问题。
- XXX 主要功能有什么？
- XXX 如何收费？
- 需要转人工服务`,ttsType:"BROWSER"},inputFieldList:[],user_input_config:{title:"用户输入"},api_input_field_list:[],user_input_field_list:[]}},{id:"start-node",type:"start-node",x:120,y:929.6914999999999,properties:{config:{fields:[{label:"用户问题",value:"question"}],globalFields:[{label:"当前时间",value:"time"},{label:"历史聊天记录",value:"historyContext"},{label:"对话 ID",value:"chatId"}]},fields:[{label:"用户问题",value:"question"}],height:364,showNode:!0,nodeName:"开始",globalFields:[{label:"当前时间",value:"time"}]}},{id:"fd0324fc-f5e4-4fa6-a2d9-cb251b467605",type:"search-knowledge-node",x:710,y:929.6914999999999,properties:{config:{fields:[{label:"检索结果的分段列表",value:"paragraphList"},{label:"满足直接回答的分段列表",value:"isHitHandlingMethodList"},{label:"检索结果",value:"data"},{label:"满足直接回答的分段内容",value:"directlyReturn"}]},height:794,showNode:!0,nodeName:"知识库检索",condition:"AND",nodeData:{knowledgeIdList:[],knowledgeSetting:{topN:3,similarity:.6,searchMode:"embedding",maxParagraphCharNumber:5e3},questionReferenceAddress:["start-node","question"],allKnowledgeIdList:[],knowledgeList:[],showKnowledge:!1}}},{id:"420a6e4f-44ff-4847-bb81-0923630846b5",type:"condition-node",x:1300,y:929.6914999999999,properties:{width:600,config:{fields:[{label:"分支名称",value:"branchName"}]},height:544.148,showNode:!0,nodeName:"判断器",condition:"AND",nodeData:{branch:[{id:"7887",type:"IF",condition:"and",conditions:[{field:["fd0324fc-f5e4-4fa6-a2d9-cb251b467605","isHitHandlingMethodList"],value:1,compare:"is_not_null"}]},{id:"6847",type:"ELSE IF 1",condition:"and",conditions:[{field:["fd0324fc-f5e4-4fa6-a2d9-cb251b467605","paragraphList"],value:1,compare:"is_not_null"}]},{id:"2794",type:"ELSE",condition:"and",conditions:[]}]},branch_condition_list:[{index:0,height:121.383,id:"7887"},{index:1,height:121.383,id:"6847"},{index:2,height:44,id:"2794"}]}},{id:"36a440a9-5b00-4d82-b13a-8e7819112918",type:"reply-node",x:1890,y:120,properties:{config:{fields:[{label:"内容",value:"answer"}]},height:386,showNode:!0,nodeName:"指定回复",condition:"AND",nodeData:{fields:["fd0324fc-f5e4-4fa6-a2d9-cb251b467605","directlyReturn"],content:"",isResult:!0,replyType:"referencing"}}},{id:"f7c3b4a2-cb80-4e47-b050-7fef0315daaf",type:"ai-chat-node",x:1890,y:929.6914999999999,properties:{config:{fields:[{label:"AI 回答内容",value:"answer"},{label:"思考过程",value:"reasoningContent"}]},height:993.383,showNode:!0,nodeName:"AI 对话",condition:"AND",nodeData:{prompt:`已知信息：
{{知识库检索.data}}
问题：
{{开始.question}}`,system:"",modelId:"",isResult:!0,maxTokens:null,temperature:null,dialogueType:"WORK_FLOW",modelSetting:{reasoning_content_end:"</think>",reasoning_content_start:"<think>",reasoningContentEnable:!1},dialogueNumber:1}}},{id:"04dd6c1e-95f9-4757-bb3e-134d503fce54",type:"reply-node",x:1890,y:1798.383,properties:{config:{fields:[{label:"内容",value:"answer"}]},height:504,showNode:!0,nodeName:"指定回复1",condition:"AND",nodeData:{fields:[],content:"抱歉，没有在知识库查询到相关内容，请提供更详细的信息。",isResult:!0,replyType:"content"}}}],edges:[{id:"73f8992c-65ef-409a-a151-378d0927f2aa",type:"app-edge",sourceNodeId:"start-node",targetNodeId:"fd0324fc-f5e4-4fa6-a2d9-cb251b467605",startPoint:{x:280,y:929.6914999999999},endPoint:{x:550,y:929.6914999999999},properties:{},pointsList:[{x:280,y:929.6914999999999},{x:390,y:929.6914999999999},{x:440,y:929.6914999999999},{x:550,y:929.6914999999999}],sourceAnchorId:"start-node_right",targetAnchorId:"fd0324fc-f5e4-4fa6-a2d9-cb251b467605_left"},{id:"6a8d23d9-5179-424e-80c2-f08d37cdb8d4",type:"app-edge",sourceNodeId:"fd0324fc-f5e4-4fa6-a2d9-cb251b467605",targetNodeId:"420a6e4f-44ff-4847-bb81-0923630846b5",startPoint:{x:870,y:929.6914999999999},endPoint:{x:1010,y:929.6914999999999},properties:{},pointsList:[{x:870,y:929.6914999999999},{x:980,y:929.6914999999999},{x:900,y:929.6914999999999},{x:1010,y:929.6914999999999}],sourceAnchorId:"fd0324fc-f5e4-4fa6-a2d9-cb251b467605_right",targetAnchorId:"420a6e4f-44ff-4847-bb81-0923630846b5_left"},{id:"56006748-d9fe-491b-a14b-04fd568cac08",type:"app-edge",sourceNodeId:"420a6e4f-44ff-4847-bb81-0923630846b5",targetNodeId:"36a440a9-5b00-4d82-b13a-8e7819112918",startPoint:{x:1590,y:793.3089999999999},endPoint:{x:1730,y:120},properties:{},pointsList:[{x:1590,y:793.3089999999999},{x:1700,y:793.3089999999999},{x:1620,y:120},{x:1730,y:120}],sourceAnchorId:"420a6e4f-44ff-4847-bb81-0923630846b5_7887_right",targetAnchorId:"36a440a9-5b00-4d82-b13a-8e7819112918_left"},{id:"9bc8721b-07aa-4730-9347-910ed64e26b9",type:"app-edge",sourceNodeId:"420a6e4f-44ff-4847-bb81-0923630846b5",targetNodeId:"f7c3b4a2-cb80-4e47-b050-7fef0315daaf",startPoint:{x:1590,y:922.6919999999999},endPoint:{x:1730,y:929.6914999999999},properties:{},pointsList:[{x:1590,y:922.6919999999999},{x:1700,y:922.6919999999999},{x:1620,y:929.6914999999999},{x:1730,y:929.6914999999999}],sourceAnchorId:"420a6e4f-44ff-4847-bb81-0923630846b5_6847_right",targetAnchorId:"f7c3b4a2-cb80-4e47-b050-7fef0315daaf_left"},{id:"c276a5b6-ec29-4ab9-b911-a0a929ff193f",type:"app-edge",sourceNodeId:"420a6e4f-44ff-4847-bb81-0923630846b5",targetNodeId:"04dd6c1e-95f9-4757-bb3e-134d503fce54",startPoint:{x:1590,y:1013.3834999999998},endPoint:{x:1730,y:1798.383},properties:{},pointsList:[{x:1590,y:1013.3834999999998},{x:1700,y:1013.3834999999998},{x:1620,y:1798.383},{x:1730,y:1798.383}],sourceAnchorId:"420a6e4f-44ff-4847-bb81-0923630846b5_2794_right",targetAnchorId:"04dd6c1e-95f9-4757-bb3e-134d503fce54_left"}]}},Po={class:"w-full"},Ro={class:"flex-center p-24"},No={class:"dialog-footer"},Lo=me({__name:"CreateApplicationDialog",emits:["refresh"],setup(ie,{expose:q,emit:I}){const{user:L}=$e(),b=Le(),R=I,N=_("views.application.form.prompt.defaultPrompt",{data:"{data}",question:"{question}"}),w=_("views.application.dialog.defaultPrompt1",{question:"{question}"})+"<data></data>"+_("views.application.dialog.defaultPrompt2"),u=c({edges:[],nodes:Ze}),m=c("blank"),k=c(),O=c(!1),v=c(!1),y=c(),l=c({name:"",desc:"",modelId:void 0,dialogueNumber:1,prologue:_("views.application.form.defaultPrologue"),knowledgeIdList:[],knowledgeSetting:{topN:3,similarity:.6,maxParagraphCharNumber:5e3,searchMode:"embedding",noReferencesSetting:{status:"ai_questioning",value:"{question}"}},modelSetting:{prompt:N,system:_("views.application.form.roleSettings.placeholder"),noReferencesPrompt:"{question}"},modelParamsSetting:{},problemOptimization:!1,problemOptimizationPrompt:w,sttModelId:void 0,ttsModelId:void 0,sttModelEnable:!1,ttsModelEnable:!1,ttsType:"BROWSER",type:"SIMPLE",workFlowTemplate:void 0}),$=Se({name:[{required:!0,message:_("views.application.form.appName.placeholder"),trigger:"blur"}],modelId:[{required:!1,message:_("views.application.form.aiModel.placeholder"),trigger:"change"}]}),Z=c("");Te(v,d=>{var f;d||(l.value={name:"",desc:"",modelId:void 0,dialogueNumber:1,prologue:_("views.application.form.defaultPrologue"),knowledgeIdList:[],knowledgeSetting:{topN:3,similarity:.6,maxParagraphCharNumber:5e3,searchMode:"embedding",noReferencesSetting:{status:"ai_questioning",value:"{question}"}},modelSetting:{prompt:N,system:_("views.application.form.roleSettings.placeholder"),noReferencesPrompt:"{question}"},modelParamsSetting:{},problemOptimization:!1,problemOptimizationPrompt:w,sttModelId:void 0,ttsModelId:void 0,sttModelEnable:!1,ttsModelEnable:!1,ttsType:"BROWSER",type:"SIMPLE"},(f=k.value)==null||f.clearValidate())});const Y=(d,f,E)=>{Z.value=d,l.value.type=f||"SIMPLE",v.value=!0,y.value=E},j=async d=>{d&&await d.validate(f=>{f&&(ue(l.value.type)&&(u.value.nodes[0].properties.nodeData.desc=l.value.desc,u.value.nodes[0].properties.nodeData.name=l.value.name,l.value.workFlow=u.value,y.value&&(l.value.workFlowTemplate=y.value)),ne.postApplication({...l.value,folderId:Z.value},O).then(E=>L.profile().then(()=>E)).then(E=>{Ie(_("common.createSuccess")),R("refresh"),ue(l.value.type)?b.push({path:`/application/workspace/${E.data.id}/workflow`}):b.push({path:`/application/workspace/${E.data.id}/${E.data.type}/setting`}),v.value=!1}))})};function D(d){m.value=d,u.value=Io[d]}return q({open:Y}),(d,f)=>{const E=n("el-input"),g=n("el-form-item"),P=n("Plus"),T=n("el-icon"),F=n("el-card"),S=n("el-col"),ee=n("LogoIcon"),fe=n("el-text"),_e=n("CardBox"),se=n("el-row"),V=n("el-form"),W=n("el-button"),ve=n("el-dialog");return r(),C(ve,{title:U(ue)(l.value.type)?d.$t("views.application.createWorkFlowApplication"):d.$t("views.application.createApplication"),modelValue:v.value,"onUpdate:modelValue":f[8]||(f[8]=X=>v.value=X),width:"650","append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:t(()=>[s("span",No,[o(W,{onClick:f[6]||(f[6]=z(X=>v.value=!1,["prevent"])),loading:O.value},{default:t(()=>[A(p(d.$t("common.cancel")),1)]),_:1},8,["loading"]),o(W,{type:"primary",onClick:f[7]||(f[7]=X=>j(k.value)),loading:O.value},{default:t(()=>[A(p(d.$t("common.create")),1)]),_:1},8,["loading"])])]),default:t(()=>[o(V,{ref_key:"applicationFormRef",ref:k,model:l.value,rules:$,"label-position":"top","require-asterisk-position":"right",onSubmit:f[5]||(f[5]=z(()=>{},["prevent"]))},{default:t(()=>[o(g,{label:d.$t("views.application.form.appName.label"),prop:"name"},{default:t(()=>[o(E,{modelValue:l.value.name,"onUpdate:modelValue":f[0]||(f[0]=X=>l.value.name=X),maxlength:"64",placeholder:d.$t("views.application.form.appName.placeholder"),"show-word-limit":"",onBlur:f[1]||(f[1]=X=>{var ge;return l.value.name=(ge=l.value.name)==null?void 0:ge.trim()})},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(g,{label:d.$t("views.application.form.appDescription.label")},{default:t(()=>[o(E,{modelValue:l.value.desc,"onUpdate:modelValue":f[2]||(f[2]=X=>l.value.desc=X),type:"textarea",placeholder:d.$t("views.application.form.appDescription.placeholder"),rows:3,maxlength:"256","show-word-limit":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l.value.type==="WORK_FLOW"&&!y.value?(r(),C(g,{key:0,label:d.$t("views.document.upload.template")},{default:t(()=>[s("div",Po,[o(se,{gutter:16},{default:t(()=>[o(S,{span:12},{default:t(()=>[o(F,{class:We(["template-radio-card cursor text-center flex-center",m.value==="blank"?"active":""]),shadow:"never",onClick:f[3]||(f[3]=X=>D("blank"))},{default:t(()=>[s("div",Ro,[o(T,{class:"mr-12"},{default:t(()=>[o(P)]),_:1}),A(" "+p(d.$t("views.application.form.appTemplate.blankApp.title")),1)])]),_:1},8,["class"])]),_:1}),o(S,{span:12},{default:t(()=>[o(_e,{title:d.$t("views.application.form.appTemplate.assistantApp.title"),description:d.$t("views.application.form.appTemplate.assistantApp.description"),shadow:"never",class:We(["template-radio-card cursor",m.value==="assistant"?"active":""]),onClick:f[4]||(f[4]=X=>D("assistant"))},{icon:t(()=>[o(ee,{height:"32px"})]),subTitle:t(()=>[o(fe,{class:"color-secondary",size:"small"},{default:t(()=>[A(p(d.$t("views.application.workflow")),1)]),_:1})]),_:1},8,["title","description","class"])]),_:1})]),_:1})])]),_:1},8,["label"])):B("",!0)]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])}}}),Xe=ze(Lo,[["__scopeId","data-v-1c700f01"]]),So={class:"dialog-footer"},To=me({__name:"CopyApplicationDialog",setup(ie,{expose:q}){const I=Le(),{user:L}=$e(),b=_("views.application.form.prompt.defaultPrompt",{data:"{data}",question:"{question}"}),R=c(),N=c(!1),w=c(!1),u=c({name:"",desc:"",modelId:"",dialogueNumber:0,prologue:_("views.application.form.defaultPrologue"),knowledgeIdList:[],knowledgeSetting:{topN:3,similarity:.6,maxParagraphCharNumber:5e3,searchMode:"embedding",noReferencesSetting:{status:"ai_questioning",value:"{question}"}},modelSetting:{prompt:b},problemOptimization:!1,type:"SIMPLE"}),m=Se({name:[{required:!0,message:_("views.application.form.appName.placeholder"),trigger:"blur"}]}),k=c("");Te(w,y=>{var l;y||(u.value={name:"",desc:"",modelId:"",dialogueNumber:0,prologue:_("views.application.form.defaultPrologue"),knowledgeIdList:[],knowledgeSetting:{topN:3,similarity:.6,maxParagraphCharNumber:5e3,searchMode:"embedding",noReferencesSetting:{status:"ai_questioning",value:"{question}"}},modelSetting:{prompt:b},problemOptimization:!1,type:"SIMPLE"},(l=R.value)==null||l.clearValidate())});const O=(y,l)=>{k.value=l;const $=qe.cloneDeep(y);delete $.id,$.name=$.name+` ${_("common.copyTitle")}`,u.value=$,w.value=!0},v=async y=>{y&&await y.validate(l=>{l&&ne.postApplication({...u.value,folderId:k.value},N).then($=>L.profile().then(()=>$)).then($=>{Ie(_("common.createSuccess")),ue(u.value.type)?I.push({path:`/application/workspace/${$.data.id}/workflow`}):I.push({path:`/application/workspace/${$.data.id}/${$.data.type}/setting`}),w.value=!1})})};return q({open:O}),(y,l)=>{const $=n("el-input"),Z=n("el-form-item"),Y=n("el-form"),j=n("el-button"),D=n("el-dialog");return r(),C(D,{title:y.$t("views.application.copyApplication"),modelValue:w.value,"onUpdate:modelValue":l[5]||(l[5]=d=>w.value=d),width:"650","append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:t(()=>[s("span",So,[o(j,{onClick:l[3]||(l[3]=z(d=>w.value=!1,["prevent"])),loading:N.value},{default:t(()=>[A(p(y.$t("common.cancel")),1)]),_:1},8,["loading"]),o(j,{type:"primary",onClick:l[4]||(l[4]=d=>v(R.value)),loading:N.value},{default:t(()=>[A(p(y.$t("common.copy")),1)]),_:1},8,["loading"])])]),default:t(()=>[o(Y,{ref_key:"applicationFormRef",ref:R,model:u.value,rules:m,"label-position":"top","require-asterisk-position":"right",onSubmit:l[2]||(l[2]=z(()=>{},["prevent"]))},{default:t(()=>[o(Z,{label:y.$t("views.application.form.appName.label"),prop:"name"},{default:t(()=>[o($,{modelValue:u.value.name,"onUpdate:modelValue":l[0]||(l[0]=d=>u.value.name=d),maxlength:"64",placeholder:y.$t("views.application.form.appName.placeholder"),"show-word-limit":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(Z,{label:y.$t("views.application.form.appDescription.label")},{default:t(()=>[o($,{modelValue:u.value.desc,"onUpdate:modelValue":l[1]||(l[1]=d=>u.value.desc=d),type:"textarea",placeholder:y.$t("views.application.form.appDescription.placeholder"),rows:3,maxlength:"256","show-word-limit":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])}}}),xo=["src"],Do=["title"],Eo={key:0,class:"card-footer-left color-secondary flex align-center"},Vo=me({__name:"TemplateCard",props:{tool:{},getSubTitle:{type:Function},addLoading:{type:Boolean}},emits:["handleAdd","handleDetail"],setup(ie,{emit:q}){const I=ie,L=q;return(b,R)=>{const N=n("el-avatar"),w=n("el-button");return r(),C(Be,{title:I.tool.name,description:I.tool.desc,class:"cursor tool-card"},{icon:t(()=>[o(N,{shape:"square",size:32,style:{background:"none"}},{default:t(()=>{var u;return[s("img",{src:U(Ae)((u=I.tool)==null?void 0:u.icon,U(Ae)("./favicon.ico")),alt:""},null,8,xo)]}),_:1})]),title:t(()=>{var u,m;return[s("span",{title:(u=I.tool)==null?void 0:u.name,class:"ellipsis"},p((m=I.tool)==null?void 0:m.name),9,Do)]}),footer:t(()=>{var u;return[((u=I.tool)==null?void 0:u.downloads)!=null?(r(),K("span",Eo,[o(Q,{iconName:"app-download",class:"mr-4"}),s("span",null,p(U(Ke)(I.tool.downloads||0)),1)])):B("",!0),s("div",{class:"card-footer-operation mb-8",onClick:R[2]||(R[2]=z(()=>{},["stop"]))},[o(w,{onClick:R[0]||(R[0]=m=>L("handleDetail"))},{default:t(()=>[A(p(b.$t("common.detail")),1)]),_:1}),o(w,{type:"primary",loading:I.addLoading,onClick:R[1]||(R[1]=m=>L("handleAdd"))},{default:t(()=>[A(p(b.$t("common.use")),1)]),_:1},8,["loading"])])]}),_:1},8,["title","description"])}}}),Ue=ze(Vo,[["__scopeId","data-v-0d93e3db"]]),Mo="data:image/svg+xml,%3csvg%20width='32'%20height='32'%20viewBox='0%200%2032%2032'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M4%202.66671C4%201.93033%204.59695%201.33337%205.33333%201.33337H21.1477C21.3265%201.33337%2021.4979%201.4052%2021.6232%201.53272L27.8088%207.82592C27.9313%207.9506%2028%208.11842%2028%208.29324V29.3334C28%2030.0698%2027.403%2030.6667%2026.6667%2030.6667H5.33333C4.59695%2030.6667%204%2030.0698%204%2029.3334V2.66671Z'%20fill='%23FF8800'/%3e%3cpath%20d='M9.33325%2011.3333C9.33325%2010.9651%209.63173%2010.6666%209.99992%2010.6666H21.9999C22.3681%2010.6666%2022.6666%2010.9651%2022.6666%2011.3333V12.6666C22.6666%2013.0348%2022.3681%2013.3333%2021.9999%2013.3333H9.99992C9.63173%2013.3333%209.33325%2013.0348%209.33325%2012.6666V11.3333Z'%20fill='white'/%3e%3cpath%20d='M14.6666%2016.6666C14.6666%2016.2984%2014.9651%2016%2015.3333%2016H21.9999C22.3681%2016%2022.6666%2016.2984%2022.6666%2016.6666V23.3333C22.6666%2023.7015%2022.3681%2024%2021.9999%2024H15.3333C14.9651%2024%2014.6666%2023.7015%2014.6666%2023.3333V16.6666Z'%20fill='white'/%3e%3cpath%20d='M9.99992%2016C9.63173%2016%209.33325%2016.2984%209.33325%2016.6666V23.3333C9.33325%2023.7015%209.63173%2024%209.99992%2024H11.3333C11.7014%2024%2011.9999%2023.7015%2011.9999%2023.3333V16.6666C11.9999%2016.2984%2011.7014%2016%2011.3333%2016H9.99992Z'%20fill='white'/%3e%3cpath%20d='M21.3333%201.33337C21.4421%201.36494%2021.5422%201.42405%2021.6231%201.50637L27.8087%207.79957C27.8593%207.85109%2027.9008%207.90998%2027.932%207.97369H22.8468C22.0109%207.97369%2021.3333%207.29607%2021.3333%206.46017V1.33337Z'%20fill='%23D97400'/%3e%3c/svg%3e",Oo={class:"flex align-center",style:{"margin-left":"-8px"}},Fo={class:"border-b"},Wo={class:"flex-between mb-24"},Ho={class:"title flex align-center"},Uo={class:"ml-16"},zo={class:"mb-8"},qo={key:1,class:"color-secondary flex align-center mt-8"},Bo=me({__name:"InternalDescDrawer",emits:["refresh","addTool"],setup(ie,{expose:q,emit:I}){const L=I,b=c(!1),R=c(""),N=c({});Te(b,m=>{m||(R.value="")});const w=(m,k)=>{N.value=k,m&&(R.value=qe.cloneDeep(m)),b.value=!0},u=m=>{L("addTool",m),b.value=!1};return q({open:w}),(m,k)=>{const O=n("Back"),v=n("el-icon"),y=n("el-button"),l=n("el-avatar"),$=n("el-text"),Z=n("AppIcon"),Y=n("MdPreview"),j=n("el-drawer");return r(),C(j,{modelValue:b.value,"onUpdate:modelValue":k[3]||(k[3]=D=>b.value=D),size:"60%","append-to-body":!0},{header:t(()=>[s("div",Oo,[o(y,{class:"cursor mr-4",link:"",onClick:k[0]||(k[0]=z(D=>b.value=!1,["prevent"]))},{default:t(()=>[o(v,{size:20},{default:t(()=>[o(O)]),_:1})]),_:1}),s("h4",null,p(m.$t("common.detail")),1)])]),default:t(()=>{var D,d;return[s("div",null,[s("div",Fo,[s("div",Wo,[s("div",Ho,[o(l,{shape:"square",size:64,style:{background:"none"}},{default:t(()=>k[4]||(k[4]=[s("img",{src:Mo,alt:""},null,-1)])),_:1,__:[4]}),s("div",Uo,[s("h3",zo,p(N.value.name),1),(D=N.value)!=null&&D.desc?(r(),C($,{key:0,type:"info"},{default:t(()=>[A(p(N.value.desc),1)]),_:1})):B("",!0),((d=N.value)==null?void 0:d.downloads)!=null?(r(),K("span",qo,[o(Z,{iconName:"app-download",class:"mr-4"}),s("span",null,p(U(Ke)(N.value.downloads||0)),1)])):B("",!0)])]),s("div",{onClick:k[2]||(k[2]=z(()=>{},["stop"]))},[o(y,{type:"primary",onClick:k[1]||(k[1]=f=>u(N.value))},{default:t(()=>[A(p(m.$t("common.use")),1)]),_:1})])])]),o(Y,{ref:"editorRef",editorId:"preview-only",modelValue:R.value,style:{background:"none"},noImgZoomIn:""},null,8,["modelValue"])])]}),_:1},8,["modelValue"])}}}),Ko={class:"dialog-header flex-between mb-8"},Zo=["id"],Xo={class:"flex align-center",style:{"margin-right":"28px"}},Go={key:1},Jo=me({__name:"TemplateStoreDialog",props:{apiType:{type:String,default:"workspace"},source:{type:String,default:"application"}},emits:["refresh"],setup(ie,{expose:q,emit:I}){$e();const L=to(),{params:{id:b}}=L,R=ie,N=I,w=c(!1),u=c(!1),m=c(""),k=c(""),O=c([]),v=c(null);function y(g){var P;return((P=O.value.find(T=>T.id===g.label))==null?void 0:P.title)??""}function l(g){k.value=g,v.value=null,w.value=!0,$()}async function $(){v.value=null;const[g]=await Promise.all([Z()]),P=[...g].reduce((T,F)=>{const S=T.find(ee=>ee.id===F.id);return S?S.tools=[...S.tools,...F.tools]:T.push({...F}),T},[]);O.value=P.filter(T=>T.tools.length>0)}async function Z(){try{const g=await wo.getStoreAppList({name:m.value},u),P=g.data.additionalProperties.tags,T=g.data.apps;let F=[];return T.forEach(S=>{S.desc=S.description}),console.log("tags",P),console.log("storeTools",T),m.value.length?v.value=[...g.data.apps,...v.value||[]]:(v.value=null,F=P.map(S=>({id:S.key,title:S.name,tools:T.filter(ee=>ee.label===S.key)}))),console.log("categories",F),console.log("filterList",v),F}catch(g){return console.error(g),[]}}const Y=c();async function j(g){var P;(P=Y.value)==null||P.open(g.readMe,g)}const D=c();function d(g,P){R.source==="work_flow"?Ne(_("common.tip"),`${_("views.application.tip.confirmUse")} ${g.name} ${_("views.application.tip.overwrite")}?`,{confirmButtonText:_("common.confirm"),cancelButtonText:_("common.cancel")}).then(()=>{E(g)}).catch(()=>{}):D.value.open(k.value,"WORK_FLOW",g)}const f=c(!1);function E(g){try{ao({type:"application",systemType:R.apiType}).putApplication(b,{workFlowTemplate:g},f).then(()=>{N("refresh"),Ie(_("common.addSuccess"))}),w.value=!1}catch(P){console.error(P)}}return q({open:l}),(g,P)=>{const T=n("el-input"),F=n("el-divider"),S=n("el-col"),ee=n("el-row"),fe=n("el-empty"),_e=n("el-scrollbar"),se=n("el-dialog");return r(),K(ce,null,[o(se,{modelValue:w.value,"onUpdate:modelValue":P[1]||(P[1]=V=>w.value=V),width:"1000","append-to-body":"",class:"tool-store-dialog","align-center":"","close-on-click-modal":!1,"close-on-press-escape":!1},{header:t(({titleId:V})=>[s("div",Ko,[s("h4",{id:V,class:"medium w-240 mr-8"},p(g.$t("workflow.setting.templateCenter")),9,Zo),s("div",Xo,[o(T,{modelValue:m.value,"onUpdate:modelValue":P[0]||(P[0]=W=>m.value=W),placeholder:g.$t("common.search"),"prefix-icon":"Search",class:"w-240 mr-8",clearable:"",onChange:$},null,8,["modelValue","placeholder"]),o(F,{direction:"vertical"})])])]),default:t(()=>[o(_e,{class:"layout-bg","wrap-class":"p-16-24 category-scrollbar"},{default:t(()=>[v.value===null?(r(!0),K(ce,{key:0},be(O.value,V=>(r(),K("div",{key:V.id},[o(ee,{gutter:16},{default:t(()=>[(r(!0),K(ce,null,be(V.tools,W=>(r(),C(S,{key:W.id,span:8,class:"mb-16"},{default:t(()=>[o(Ue,{tool:W,addLoading:f.value,"get-sub-title":y,onHandleAdd:ve=>d(W),onHandleDetail:ve=>j(W)},null,8,["tool","addLoading","onHandleAdd","onHandleDetail"])]),_:2},1024))),128))]),_:2},1024)]))),128)):(r(),K("div",Go,[v.value.length?(r(),C(ee,{key:0,gutter:16},{default:t(()=>[(r(!0),K(ce,null,be(v.value,V=>(r(),C(S,{key:V.id,span:8,class:"mb-16"},{default:t(()=>[o(Ue,{tool:V,addLoading:f.value,"get-sub-title":y,onHandleAdd:W=>d(V),onHandleDetail:W=>j(V)},null,8,["tool","addLoading","onHandleAdd","onHandleDetail"])]),_:2},1024))),128))]),_:1})):(r(),C(fe,{key:1,description:g.$t("common.noData")},null,8,["description"]))]))]),_:1})]),_:1},8,["modelValue"]),o(Bo,{ref_key:"internalDescDrawerRef",ref:Y,onAddTool:d},null,512),o(Xe,{ref_key:"CreateKnowledgeDialogRef",ref:D},null,512)],64)}}}),jo={class:"p-12-16 pb-0 mt-12"},Qo={class:"p-8"},Yo={class:"flex"},et={class:"flex-between complex-search"},ot={class:"flex"},tt={class:"pre-wrap ml-8"},at={class:"lighter"},lt={class:"flex"},nt={class:"pre-wrap ml-8"},it={class:"lighter"},st={class:"flex align-center w-full"},rt={class:"pre-wrap ml-8"},dt={class:"lighter"},pt={style:{"max-height":"calc(100vh - 120px)"}},ct=["src"],ut={key:0,class:"flex align-center"},mt={class:"color-secondary"},ft={class:"color-secondary"},_t={key:1,class:"flex align-center"},vt={class:"color-secondary"},At=me({__name:"index",setup(ie){const q=Le(),I=He(()=>"workspace"),L=He(()=>lo.application[I.value]),{folder:b,application:R,user:N}=$e(),w=c(!1),u=c("name"),m=c({name:"",type:"",createUser:"",publishStatus:void 0}),k=c(""),O=c([]),v=Se({current_page:1,page_size:30,total:0}),y=c([]),l=c([]),$=c(),Z=c();function Y(e){Z.value.open(e.id)}const j=c();function D(e){const a=l.value.findIndex(h=>h.id===e.id);l.value.splice(a,1)}const d=e=>{q.push({path:f(e)})},f=e=>he([new ae([le.USER],[M.APPLICATION.getApplicationWorkspaceResourcePermission(e.id)],[],"AND"),le.WORKSPACE_MANAGE.getWorkspaceRole,M.APPLICATION_OVERVIEW_READ.getWorkspacePermissionWorkspaceManageRole,M.APPLICATION_OVERVIEW_READ.getApplicationWorkspaceResourcePermission(e.id)],"OR")?`/application/workspace/${e.id}/${e.type}/overview`:he([new ae([le.USER],[M.APPLICATION.getApplicationWorkspaceResourcePermission(e.id)],[],"AND"),le.WORKSPACE_MANAGE.getWorkspaceRole,M.APPLICATION_EDIT.getWorkspacePermissionWorkspaceManageRole,M.APPLICATION_EDIT.getApplicationWorkspaceResourcePermission(e.id)],"OR")?e.type=="WORK_FLOW"?`/application/workspace/${e.id}/workflow`:`/application/workspace/${e.id}/${e.type}/setting`:he([new ae([le.USER],[M.APPLICATION.getApplicationWorkspaceResourcePermission(e.id)],[J.IS_EE,J.IS_PE],"AND"),new ae([le.WORKSPACE_MANAGE.getWorkspaceRole],[M.APPLICATION_ACCESS_READ.getWorkspacePermissionWorkspaceManageRole],[J.IS_EE,J.IS_PE],"OR"),new ae([],[M.APPLICATION_ACCESS_READ.getApplicationWorkspaceResourcePermission(e.id)],[J.IS_EE,J.IS_PE],"OR")],"OR")?`/application/workspace/${e.id}/${e.type}/access`:he([new ae([le.USER],[M.APPLICATION.getApplicationWorkspaceResourcePermission(e.id)],[J.IS_EE,J.IS_PE],"AND"),new ae([le.WORKSPACE_MANAGE.getWorkspaceRole],[M.APPLICATION_CHAT_USER_READ.getWorkspacePermissionWorkspaceManageRole],[J.IS_EE,J.IS_PE],"OR"),new ae([],[M.APPLICATION_CHAT_USER_READ.getApplicationWorkspaceResourcePermission(e.id)],[J.IS_EE,J.IS_PE],"OR")],"OR")?`/application/workspace/${e.id}/${e.type}/chat-user`:he([new ae([le.USER],[M.APPLICATION.getApplicationWorkspaceResourcePermission(e.id)],[],"AND"),M.APPLICATION_CHAT_LOG_READ.getWorkspacePermissionWorkspaceManageRole,M.APPLICATION_CHAT_LOG_READ.getApplicationWorkspaceResourcePermission(e.id)],"OR")?`/application//workspace${e.id}/${e.type}/chat-log`:"/application/",E=c();function g(e){var a;E.value.open(((a=b.currentFolder)==null?void 0:a.id)||"default",e)}const P=()=>{m.value={name:"",createUser:""}};function T(e){(e.type=="WORK_FLOW"?h=>ne.getApplicationDetail(h):h=>Promise.resolve({data:e}))(e.id).then(h=>{var ye,oe,de;let G=(de=(oe=(ye=h.data)==null?void 0:ye.workFlow)==null?void 0:oe.nodes)==null?void 0:de.filter(H=>H.id==="base-node").map(H=>H.properties.api_input_field_list?H.properties.api_input_field_list.map(x=>({name:x.variable,value:x.default_value})):H.properties.inputFieldList?H.properties.inputFieldList.filter(x=>x.assignment_method==="api_input").map(x=>({name:x.variable,value:x.default_value})):[]).reduce((H,x)=>[...H,...x]);G=G||[];const Pe=F(G)?"?"+F(G):"";ne.getAccessToken(e.id,w).then(H=>{var x;window.open(R.location+((x=H==null?void 0:H.data)==null?void 0:x.accessToken)+Pe)})})}function F(e){const a=new URLSearchParams;return e.forEach(h=>{a.append(encodeURIComponent(h.name),encodeURIComponent(h.value))}),a.toString()}function S(e){ne.getApplicationDetail(e.id,w).then(a=>{var h;a!=null&&a.data&&$.value.open({...a.data,modelId:a.data.model},((h=b.currentFolder)==null?void 0:h.id)||"default")})}function ee(e){ue(e.type)?q.push({path:`/application/workspace/${e.id}/workflow`}):q.push({path:`/application/workspace/${e.id}/${e.type}/setting`})}function fe(e){Ne(`${_("views.application.delete.confirmTitle")}${e.name} ?`,_("views.application.delete.confirmMessage"),{confirmButtonText:_("common.confirm"),cancelButtonText:_("common.cancel"),confirmButtonClass:"danger"}).then(()=>{ne.delApplication(e.id,w).then(()=>{const a=l.value.findIndex(h=>h.id===e.id);l.value.splice(a,1),Ie(_("common.deleteSuccess"))})}).catch(()=>{})}const _e=e=>{ne.exportApplication(e.id,e.name,w).catch(a=>{a.response.status!==403&&a.response.data.text().then(h=>{bo(`${_("views.application.tip.ExportError")}:${JSON.parse(h).message}`)})})},se=c();function V(){var e;(e=se.value)==null||e.open(b.currentFolder.id)}const W=c(),ve=e=>{const a=new FormData;a.append("file",e.raw,e.name),W.value.clearFiles(),ne.importApplication(b.currentFolder.id,a,w).then(async h=>{h!=null&&h.data&&(l.value=[],await N.profile())}).then(()=>{re()}).catch(h=>{h.code===400&&Ne(_("common.tip"),_("views.application.tip.professionalMessage"),{cancelButtonText:_("common.confirm"),confirmButtonText:_("common.professional")}).then(()=>{window.open("https://tarzan.blog.csdn.net","_blank")})})},X=c();function ge(e){const a={};console.log(b),b.asyncGetFolder(ke.APPLICATION,a,I.value,w).then(h=>{var G;y.value=h.data,e&&b.setCurrentFolder(((G=h.data)==null?void 0:G[0])||{}),re()})}function xe(e){var a;e.id!==((a=b.currentFolder)==null?void 0:a.id)&&(b.setCurrentFolder(e),v.current_page=1,l.value=[],re())}function De(){v.current_page=1,l.value=[],ge()}function we(){v.current_page=1,l.value=[],re()}function re(){var a;const e={folderId:((a=b.currentFolder)==null?void 0:a.id)||"default"};m.value[u.value]&&(e[u.value]=m.value[u.value]),e.type=k.value,ne.getApplication(v,e,w).then(h=>{v.total=h.data.total,l.value=[...l.value,...h.data.records]})}return no(()=>{var e;ge(!((e=b.currentFolder)!=null&&e.id)),io.getAllMemberList(N.getWorkspaceId(),w).then(a=>{O.value=a.data})}),(e,a)=>{const h=n("el-divider"),G=n("el-radio-button"),Pe=n("el-radio-group"),ye=n("el-space"),oe=n("el-option"),de=n("el-select"),H=n("el-input"),x=n("el-button"),Ge=n("arrow-down"),Ee=n("el-icon"),Ce=n("el-avatar"),Re=n("el-text"),te=n("el-dropdown-item"),Je=n("el-upload"),Ve=n("el-dropdown-menu"),Me=n("el-dropdown"),Oe=n("el-tag"),je=n("SuccessFilled"),Qe=n("el-col"),Ye=n("el-row"),eo=n("el-empty"),oo=so("loading");return r(),C(ho,{showCollapse:"",class:"application-manage"},{left:t(()=>{var i;return[s("h4",jo,p(e.$t("views.application.title")),1),s("div",Qo,[o(go,{source:U(ke).APPLICATION,data:y.value,currentNodeKey:(i=U(b).currentFolder)==null?void 0:i.id,onHandleNodeClick:xe,onRefreshTree:De},null,8,["source","data","currentNodeKey"])])]}),default:t(()=>[o(ro,null,{header:t(()=>[o(ye,{wrap:""},{default:t(()=>[o(_o,{folderList:y.value,onClick:xe},null,8,["folderList"]),o(h,{direction:"vertical"}),o(Pe,{modelValue:k.value,"onUpdate:modelValue":a[0]||(a[0]=i=>k.value=i),onChange:we,class:"app-radio-button-group"},{default:t(()=>[o(G,{value:""},{default:t(()=>[A(p(e.$t("views.tool.all")),1)]),_:1}),o(G,{value:"SIMPLE"},{default:t(()=>[A(p(e.$t("views.application.simple")),1)]),_:1}),o(G,{value:"WORK_FLOW"},{default:t(()=>[A(p(e.$t("views.application.workflow")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),search:t(()=>[s("div",Yo,[s("div",et,[o(de,{class:"complex-search__left",modelValue:u.value,"onUpdate:modelValue":a[1]||(a[1]=i=>u.value=i),style:{width:"120px"},onChange:P},{default:t(()=>[o(oe,{label:e.$t("common.creator"),value:"createUser"},null,8,["label"]),o(oe,{label:e.$t("common.name"),value:"name"},null,8,["label"]),o(oe,{label:e.$t("common.publishStatus"),value:"publishStatus"},null,8,["label"])]),_:1},8,["modelValue"]),u.value==="name"?(r(),C(H,{key:0,modelValue:m.value.name,"onUpdate:modelValue":a[2]||(a[2]=i=>m.value.name=i),onChange:we,placeholder:e.$t("common.searchBar.placeholder"),style:{width:"220px"},clearable:""},null,8,["modelValue","placeholder"])):u.value==="createUser"?(r(),C(de,{key:1,modelValue:m.value.createUser,"onUpdate:modelValue":a[3]||(a[3]=i=>m.value.createUser=i),onChange:we,filterable:"",clearable:"",style:{width:"220px"}},{default:t(()=>[(r(!0),K(ce,null,be(O.value,i=>(r(),C(oe,{key:i.id,value:i.id,label:i.nickname},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])):u.value==="publishStatus"?(r(),C(de,{key:2,modelValue:m.value.publishStatus,"onUpdate:modelValue":a[4]||(a[4]=i=>m.value.publishStatus=i),onChange:we,filterable:"",clearable:"",style:{width:"220px"}},{default:t(()=>[o(oe,{label:e.$t("common.published"),value:"published"},null,8,["label"]),o(oe,{label:e.$t("common.unpublished"),value:"unpublished"},null,8,["label"])]),_:1},8,["modelValue"])):B("",!0)]),L.value.create()?(r(),C(x,{key:0,class:"ml-8",onClick:a[5]||(a[5]=i=>V())},{default:t(()=>[o(Q,{iconName:"app-template-center",class:"mr-4"}),A(" "+p(e.$t("workflow.setting.templateCenter")),1)]),_:1})):B("",!0),L.value.create()?(r(),C(Me,{key:1,trigger:"click"},{dropdown:t(()=>[o(Ve,{class:"create-dropdown"},{default:t(()=>[o(te,{onClick:a[6]||(a[6]=i=>g("SIMPLE"))},{default:t(()=>[s("div",ot,[o(Ce,{shape:"square",class:"avatar-blue mt-4",size:32},{default:t(()=>a[11]||(a[11]=[s("img",{src:Ao,style:{width:"65%"},alt:""},null,-1)])),_:1,__:[11]}),s("div",tt,[s("div",at,p(e.$t("views.application.simple")),1),o(Re,{type:"info",size:"small"},{default:t(()=>[A(p(e.$t("views.application.simplePlaceholder")),1)]),_:1})])])]),_:1}),o(te,{onClick:a[7]||(a[7]=i=>g("WORK_FLOW"))},{default:t(()=>[s("div",lt,[o(Ce,{shape:"square",class:"avatar-purple mt-4",size:32},{default:t(()=>a[12]||(a[12]=[s("img",{src:$o,style:{width:"65%"},alt:""},null,-1)])),_:1,__:[12]}),s("div",nt,[s("div",it,p(e.$t("views.application.workflow")),1),o(Re,{type:"info",size:"small"},{default:t(()=>[A(p(e.$t("views.application.workflowPlaceholder")),1)]),_:1})])])]),_:1}),o(Je,{class:"import-button",ref_key:"elUploadRef",ref:W,"file-list":[],action:"#",multiple:"","auto-upload":!1,"show-file-list":!1,limit:1,"on-change":(i,Fe)=>ve(i)},{default:t(()=>[o(te,null,{default:t(()=>[s("div",st,[o(Ce,{shape:"square",class:"mt-4",size:32,style:{background:"none"}},{default:t(()=>a[13]||(a[13]=[s("img",{src:yo,alt:""},null,-1)])),_:1,__:[13]}),s("div",rt,[s("div",dt,p(e.$t("common.importCreate")),1)])])]),_:1})]),_:1},8,["on-change"])]),_:1})]),default:t(()=>[o(x,{type:"primary",class:"ml-8"},{default:t(()=>[A(p(e.$t("common.create"))+" ",1),o(Ee,{class:"el-icon--right"},{default:t(()=>[o(Ge)]),_:1})]),_:1})]),_:1})):B("",!0)])]),default:t(()=>[po((r(),K("div",pt,[o(co,{size:l.value.length,total:v.total,page_size:v.page_size,current_page:v.current_page,"onUpdate:current_page":a[10]||(a[10]=i=>v.current_page=i),onLoad:re,loading:w.value},{default:t(()=>[l.value.length>0?(r(),C(Ye,{key:0,gutter:15,class:"w-full"},{default:t(()=>[(r(!0),K(ce,null,be(l.value,(i,Fe)=>(r(),C(Qe,{key:Fe,xs:24,sm:12,md:12,lg:6,xl:6,class:"mb-16"},{default:t(()=>[o(Be,{title:i.name,description:i.desc,class:"cursor",onClick:pe=>d(i)},{icon:t(()=>[o(Ce,{shape:"square",size:32,style:{background:"none"}},{default:t(()=>[s("img",{src:U(Ae)(i==null?void 0:i.icon,U(Ae)("./favicon.ico")),alt:""},null,8,ct)]),_:2},1024)]),subTitle:t(()=>[o(Re,{class:"color-secondary lighter",size:"small"},{default:t(()=>[o(mo,{content:i.username},{default:t(()=>[A(p(e.$t("common.creator"))+": "+p(U(fo)(i.nickname)),1)]),_:2},1032,["content"])]),_:2},1024)]),tag:t(()=>[U(ue)(i.type)?(r(),C(Oe,{key:0,class:"warning-tag"},{default:t(()=>[A(p(e.$t("views.application.workflow")),1)]),_:1})):(r(),C(Oe,{key:1,class:"blue-tag"},{default:t(()=>[A(p(e.$t("views.application.simple")),1)]),_:1}))]),footer:t(()=>[i.isPublish?(r(),K("div",ut,[o(Ee,{class:"color-success mr-8",style:{"font-size":"16px"}},{default:t(()=>[o(je)]),_:1}),s("span",mt,p(e.$t("views.application.status.published")),1),o(h,{direction:"vertical"}),o(Q,{iconName:"app-clock",class:"color-secondary mr-8"}),s("span",ft,p(U(uo)(i.updateTime)),1)])):(r(),K("div",_t,[o(Q,{iconName:"app-disabled",class:"color-secondary mr-8"}),s("span",vt,p(e.$t("views.application.status.unpublished")),1)]))]),mouseEnter:t(()=>[s("div",{onClick:a[9]||(a[9]=z(()=>{},["stop"]))},[o(Me,{trigger:"click"},{dropdown:t(()=>[o(Ve,null,{default:t(()=>[o(te,{onClick:z(pe=>T(i),["stop"])},{default:t(()=>[o(Q,{iconName:"app-create-chat",class:"color-secondary"}),A(" "+p(e.$t("views.application.operation.toChat")),1)]),_:2},1032,["onClick"]),L.value.edit(i.id)?(r(),C(te,{key:0,onClick:z(pe=>ee(i),["stop"])},{default:t(()=>[o(Q,{iconName:"app-setting",class:"color-secondary"}),A(" "+p(e.$t("common.setting")),1)]),_:2},1032,["onClick"])):B("",!0),L.value.auth(i.id)?(r(),C(te,{key:1,onClick:z(pe=>Y(i),["stop"])},{default:t(()=>[o(Q,{iconName:"app-resource-authorization",class:"color-secondary"}),A(" "+p(e.$t("views.system.resourceAuthorization.title")),1)]),_:2},1032,["onClick"])):B("",!0),L.value.create()?(r(),C(te,{key:2,onClick:pe=>S(i)},{default:t(()=>[o(Q,{iconName:"app-copy",class:"color-secondary"}),A(" "+p(e.$t("common.copy")),1)]),_:2},1032,["onClick"])):B("",!0),L.value.export(i.id)?(r(),C(te,{key:3,divided:"",onClick:z(pe=>_e(i),["stop"])},{default:t(()=>[o(Q,{iconName:"app-export",class:"color-secondary"}),A(" "+p(e.$t("common.export")),1)]),_:2},1032,["onClick"])):B("",!0),L.value.delete(i.id)?(r(),C(te,{key:4,divided:"",onClick:z(pe=>fe(i),["stop"])},{default:t(()=>[o(Q,{iconName:"app-delete",class:"color-secondary"}),A(" "+p(e.$t("common.delete")),1)]),_:2},1032,["onClick"])):B("",!0)]),_:2},1024)]),default:t(()=>[o(x,{text:"",onClick:a[8]||(a[8]=z(()=>{},["stop"]))},{default:t(()=>[o(Q,{iconName:"app-more"})]),_:1})]),_:2},1024)])]),_:2},1032,["title","description","onClick"])]),_:2},1024))),128))]),_:1})):(r(),C(eo,{key:1,description:e.$t("common.noData")},null,8,["description"]))]),_:1},8,["size","total","page_size","current_page","loading"])])),[[oo,v.current_page===1&&w.value,void 0,{fullscreen:!0,lock:!0}]])]),_:1}),o(Xe,{ref_key:"CreateApplicationDialogRef",ref:E},null,512),o(To,{ref_key:"CopyApplicationDialogRef",ref:$},null,512),o(vo,{ref_key:"CreateFolderDialogRef",ref:X,onRefresh:De},null,512),I.value==="workspace"?(r(),C(Co,{key:0,ref_key:"MoveToDialogRef",ref:j,source:U(ke).APPLICATION,onRefresh:D},null,8,["source"])):B("",!0),o(ko,{type:U(ke).APPLICATION,ref_key:"ResourceAuthorizationDrawerRef",ref:Z},null,8,["type"]),o(Jo,{ref_key:"templateStoreDialogRef",ref:se,"api-type":I.value,onRefresh:re},null,8,["api-type"])]),_:1})}}});export{At as default};

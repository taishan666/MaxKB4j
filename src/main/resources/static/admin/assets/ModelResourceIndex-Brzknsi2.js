import{ay as _e,aA as be,aB as r,aX as ye,aQ as Q,b_ as he,aR as ge,b9 as ke,aL as we,aD as n,aT as L,aF as s,aH as t,aG as o,aK as b,aJ as m,b8 as y,aC as g,aI as i,aE as d,aU as $,aY as I,aZ as z,cb as Te,cc as $e,a_ as S,c6 as X,c8 as Ce,cd as Y,b5 as Ve}from"./admin-D1QwKL-A.js";import{E as Me,_ as Le}from"./ParamSettingDialog.vue_vue_type_script_setup_true_lang-c8YilDEk.js";import{l as Se}from"./permission-api-DO0YHChN.js";import"./workspace-m2Aw7qWC.js";const Ue={class:"p-16-24"},Fe={class:"ml-4 color-text-primary"},Ne={class:"flex-between mb-16"},xe={class:"complex-search"},Re=["innerHTML"],Ae=["innerHTML"],Ee={class:"filter"},Pe={class:"form-item mb-16 ml-4"},Be={class:"text-right"},Ie={class:"mr-8"},ze={class:"mr-8"},He={class:"mr-8"},je=_e({__name:"ModelResourceIndex",setup(De){const{user:H,model:Z}=be(),k=r("name"),c=r({name:"",createUser:"",modelType:""}),U=r(!1),D=r([]),O=r([]),F=r([]),N=ye({current_page:1,page_size:20,total:0}),ee=e=>{Ce(`${g("views.model.delete.confirmTitle")}${e.name} ?`,g("views.model.delete.confirmMessage"),{confirmButtonText:g("common.confirm"),confirmButtonClass:"danger"}).then(()=>{Y.deleteModel(e.id).then(()=>{p(),Ve(g("common.deleteSuccess"))})}).catch(()=>{})},W=r(),le=e=>{var a;(a=W.value)==null||a.open(e)},G=r(),te=e=>{var v;const a=F.value.find(A=>A.provider===e.provider);a&&((v=G.value)==null||v.open(a,e))},x=Q(()=>he.model.systemManage),C=r([]),V=r(!1),_=r([]),R=Q(()=>e=>F.value.find(a=>a.provider===e.provider)),w=r(""),M=r([]);ge([()=>C.value,()=>w.value],()=>{w.value.length||(M.value=C.value),M.value=C.value.filter(e=>e.label.toLowerCase().includes(w.value.toLowerCase()))},{immediate:!0});function J(e){e==="clear"&&(_.value=[]),p(),V.value=!1}async function ae(){if(H.isEE()){const e=await Se("workspace").getSystemWorkspaceList(U);C.value=e.data.map(a=>({label:a.name,value:a.id}))}}const oe=()=>{c.value={name:"",createUser:"",modelType:""}};function ne(){let e={name:c.value.name,createUser:c.value.createUser,modelType:c.value.modelType};return _.value.length>0&&(e.workspace_ids=JSON.stringify(_.value)),e}function p(){Y.getModelListPage(N,ne(),U).then(e=>{var a,v;N.total=(a=e.data)==null?void 0:a.total,D.value=(v=e.data)==null?void 0:v.records})}function se(){Z.asyncGetProvider(U).then(e=>{F.value=e==null?void 0:e.data,p()})}return ke(()=>{ae(),se(),we.getAllMemberList("").then(e=>{O.value=e.data})}),(e,a)=>{const v=n("el-breadcrumb-item"),A=n("el-breadcrumb"),T=n("el-option"),E=n("el-select"),j=n("el-input"),q=n("el-space"),u=n("el-table-column"),ie=n("Filter"),re=n("el-icon"),h=n("el-button"),de=n("el-checkbox"),me=n("el-checkbox-group"),ce=n("el-scrollbar"),pe=n("el-empty"),ue=n("el-popover"),P=n("AppIcon"),B=n("el-tooltip"),ve=n("app-table"),fe=n("el-card");return s(),L("div",Ue,[t(A,{"separator-icon":"ArrowRight"},{default:o(()=>[t(v,null,{default:o(()=>[b(m(y(g)("views.system.resource_management.label")),1)]),_:1}),t(v,null,{default:o(()=>[i("h5",Fe,m(y(g)("views.model.title")),1)]),_:1})]),_:1}),t(fe,{class:"mt-16",style:{height:"calc(var(--app-main-height) + 20px)"}},{default:o(()=>[i("div",Ne,[i("div",xe,[t(E,{class:"complex-search__left",modelValue:k.value,"onUpdate:modelValue":a[0]||(a[0]=l=>k.value=l),style:{width:"120px"},onChange:oe},{default:o(()=>[t(T,{label:e.$t("common.creator"),value:"createUser"},null,8,["label"]),t(T,{label:e.$t("views.model.modelForm.modelType.label"),value:"modelType"},null,8,["label"]),t(T,{label:e.$t("views.model.modelForm.modelName.label"),value:"name"},null,8,["label"])]),_:1},8,["modelValue"]),k.value==="name"?(s(),d(j,{key:0,modelValue:c.value.name,"onUpdate:modelValue":a[1]||(a[1]=l=>c.value.name=l),onChange:p,placeholder:e.$t("common.searchBar.placeholder"),style:{width:"220px"},clearable:""},null,8,["modelValue","placeholder"])):k.value==="createUser"?(s(),d(E,{key:1,modelValue:c.value.createUser,"onUpdate:modelValue":a[2]||(a[2]=l=>c.value.createUser=l),onChange:p,filterable:"",clearable:"",style:{width:"220px"}},{default:o(()=>[(s(!0),L(I,null,z(O.value,l=>(s(),d(T,{key:l.id,value:l.id,label:l.nickname},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])):k.value==="modelType"?(s(),d(E,{key:2,modelValue:c.value.modelType,"onUpdate:modelValue":a[3]||(a[3]=l=>c.value.modelType=l),clearable:"",onChange:p,style:{width:"220px"}},{default:o(()=>[(s(!0),L(I,null,z(y(Te),l=>(s(),d(T,{key:l.value,label:l.text,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):$("",!0)])]),t(ve,{data:D.value,"pagination-config":N,onSizeChange:p,onChangePage:p,maxTableHeight:260},{default:o(()=>[t(u,{width:"220",label:e.$t("common.name"),"show-overflow-tooltip":""},{default:o(({row:l})=>[t(q,{size:8},{default:o(()=>{var f;return[i("span",{style:{width:"24px",height:"24px",display:"inline-block"},innerHTML:(f=R.value(l))==null?void 0:f.icon},null,8,Re),i("span",null,m(l.name),1)]}),_:2},1024)]),_:1},8,["label"]),t(u,{prop:"provider",label:e.$t("views.model.provider"),"show-overflow-tooltip":"",width:"150"},{default:o(({row:l})=>[t(q,{size:8},{default:o(()=>{var f,K;return[i("span",{style:{width:"24px",height:"24px",display:"inline-block"},innerHTML:(f=R.value(l))==null?void 0:f.icon},null,8,Ae),i("span",null,m((K=R.value(l))==null?void 0:K.name),1)]}),_:2},1024)]),_:1},8,["label"]),t(u,{width:"120",label:e.$t("views.model.modelForm.modelType.label")},{default:o(({row:l})=>[b(m(e.$t(y($e)[l.modelType])),1)]),_:1},8,["label"]),t(u,{width:"220",label:e.$t("views.model.modelForm.base_model.label"),"show-overflow-tooltip":""},{default:o(({row:l})=>[b(m(l.modelName),1)]),_:1},8,["label"]),y(H).isEE()?(s(),d(u,{key:0,width:"150",prop:"workspace_name",label:e.$t("views.workspace.title"),"show-overflow-tooltip":""},{header:o(()=>[i("div",null,[i("span",null,m(e.$t("views.workspace.title")),1),t(ue,{width:200,trigger:"click",visible:V.value},{reference:o(()=>[t(h,{style:{"margin-top":"-2px"},type:_.value&&_.value.length>0?"primary":"",link:"",onClick:a[4]||(a[4]=l=>V.value=!V.value)},{default:o(()=>[t(re,null,{default:o(()=>[t(ie)]),_:1})]),_:1},8,["type"])]),default:o(()=>[i("div",Ee,[i("div",Pe,[i("div",{onClick:a[7]||(a[7]=S(()=>{},["stop"]))},[t(j,{modelValue:w.value,"onUpdate:modelValue":a[5]||(a[5]=l=>w.value=l),placeholder:e.$t("common.search"),"prefix-icon":"Search",clearable:""},null,8,["modelValue","placeholder"]),M.value.length?(s(),d(ce,{key:0,height:"300"},{default:o(()=>[t(me,{modelValue:_.value,"onUpdate:modelValue":a[6]||(a[6]=l=>_.value=l),style:{display:"flex","flex-direction":"column"}},{default:o(()=>[(s(!0),L(I,null,z(M.value,l=>(s(),d(de,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):(s(),d(pe,{key:1,description:e.$t("common.noData")},null,8,["description"]))])])]),i("div",Be,[t(h,{size:"small",onClick:a[8]||(a[8]=l=>J("clear"))},{default:o(()=>[b(m(e.$t("common.clear")),1)]),_:1}),t(h,{type:"primary",onClick:J,size:"small"},{default:o(()=>[b(m(e.$t("common.confirm")),1)]),_:1})])]),_:1},8,["visible"])])]),_:1},8,["label"])):$("",!0),t(u,{prop:"nickname",label:e.$t("common.creator"),"show-overflow-tooltip":""},null,8,["label"]),t(u,{label:e.$t("views.document.table.updateTime"),width:"180"},{default:o(({row:l})=>[b(m(y(X)(l.update_time)),1)]),_:1},8,["label"]),t(u,{label:e.$t("common.createTime"),width:"180"},{default:o(({row:l})=>[b(m(y(X)(l.createTime)),1)]),_:1},8,["label"]),t(u,{label:e.$t("common.operation"),align:"left",width:"120",fixed:"right"},{default:o(({row:l})=>[x.value.modify()?(s(),d(B,{key:0,effect:"dark",content:e.$t("common.modify"),placement:"top"},{default:o(()=>[i("span",Ie,[t(h,{type:"primary",text:"",title:e.$t("common.modify"),onClick:S(f=>te(l),["stop"])},{default:o(()=>[t(P,{iconName:"app-edit"})]),_:2},1032,["title","onClick"])])]),_:2},1032,["content"])):$("",!0),(l.modelType==="TTS"||l.modelType==="LLM"||l.modelType==="VISION"||l.modelType==="TTI")&&x.value.paramSetting()?(s(),d(B,{key:1,effect:"dark",content:e.$t("views.model.modelForm.title.paramSetting"),placement:"top"},{default:o(()=>[i("span",ze,[t(h,{type:"primary",text:"",title:e.$t("views.model.modelForm.title.paramSetting"),onClick:S(f=>le(l),["stop"])},{default:o(()=>[t(P,{iconName:"app-setting"})]),_:2},1032,["title","onClick"])])]),_:2},1032,["content"])):$("",!0),x.value.delete()?(s(),d(B,{key:2,effect:"dark",content:e.$t("common.delete"),placement:"top"},{default:o(()=>[i("span",He,[t(h,{type:"primary",text:"",title:e.$t("common.delete"),onClick:S(f=>ee(l),["stop"])},{default:o(()=>[t(P,{iconName:"app-delete"})]),_:2},1032,["title","onClick"])])]),_:2},1032,["content"])):$("",!0)]),_:1},8,["label"])]),_:1},8,["data","pagination-config"])]),_:1}),t(Me,{ref_key:"editModelRef",ref:G,onSubmit:p},null,512),t(Le,{ref_key:"paramSettingRef",ref:W},null,512)])}}});export{je as default};

{"name":"MySQL 查询","desc":"一个连接MySQL数据库执行SQL查询的工具","code":"import groovy.sql.Sql\nimport groovy.json.JsonBuilder\nimport java.sql.Timestamp\nimport java.sql.Date\nimport java.math.BigDecimal\n\n  def url = \"jdbc:mysql://${host}:${port}/${database}?useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC\"\n\n    def jsonResult = null\n\n    Sql.withInstance(url, user, password, 'com.mysql.cj.jdbc.Driver') { sqlConn ->\n        def rows = sqlConn.rows(sql)\n\n        // 处理特殊类型：Date, Timestamp, BigDecimal, byte[]\n        def processedRows = rows.collect { row ->\n            row.collectEntries { key, value ->\n                def processedValue = value\n                if (value instanceof Timestamp || value instanceof Date) {\n                    processedValue = value.toInstant().toString() // ISO 8601 格式\n                } else if (value instanceof BigDecimal) {\n                    processedValue = value.doubleValue()\n                } else if (value instanceof byte[]) {\n                    processedValue = new String(value, 'UTF-8')\n                }\n                // 其他类型保持原样\n                [(key): processedValue]\n            }\n        }\n\n        jsonResult = new JsonBuilder(processedRows).toString()\n    }\n\n    return jsonResult","inputFieldList":[{"name":"sql","type":"string","source":"reference","isRequired":true}],"initFieldList":[{"attrs":{"maxlength":200,"minlength":1,"show-word-limit":true},"field":"host","label":"host","required":true,"input_type":"TextInput","props_info":{"rules":[{"message":"host 为必填属性","required":true},{"max":200,"min":1,"message":"host长度在 1 到 200 个字符","trigger":"blur"}]},"default_value":"127.0.0.1","show_default_value":false},{"attrs":{"maxlength":200,"minlength":1,"show-word-limit":true},"field":"port","label":"port","required":true,"input_type":"TextInput","props_info":{"rules":[{"message":"port 为必填属性","required":true},{"max":200,"min":1,"message":"port长度在 1 到 200 个字符","trigger":"blur"}]},"default_value":"3306","show_default_value":true},{"attrs":{"maxlength":200,"minlength":1,"show-word-limit":true},"field":"user","label":"user","required":true,"input_type":"TextInput","props_info":{"rules":[{"message":"user 为必填属性","required":true},{"max":200,"min":1,"message":"user长度在 1 到 200 个字符","trigger":"blur"}]},"default_value":"root","show_default_value":true},{"attrs":{"type":"password","maxlength":200,"minlength":1,"show-password":true,"show-word-limit":true},"field":"password","label":"password","required":true,"input_type":"PasswordInput","props_info":{"rules":[{"message":"password 为必填属性","required":true},{"max":200,"min":1,"message":"password长度在 1 到 200 个字符","trigger":"blur"}]},"default_value":"******","show_default_value":true},{"attrs":{"maxlength":200,"minlength":1,"show-word-limit":true},"field":"database","label":"database","required":true,"input_type":"TextInput","props_info":{"rules":[{"message":"database 为必填属性","required":true},{"max":200,"min":1,"message":"database长度在 1 到 200 个字符","trigger":"blur"}]},"default_value":"mysql","show_default_value":true}],"initParams":{},"userId":"ee95e0e38acaad23bd73d9bea414a97d","isActive":true,"toolType":"CUSTOM","label":"database_search","scope":"WORKSPACE","icon":"./tool/mysql/icon.png","folderId":"default","id":"f6b4a010834752f2085228ee784df9ec","version":"1.0.0","version":"1.0.0","createTime":1762327996000,"updateTime":1764214477303}
{"name":"百度翻译","desc":"百度翻译工具","code":"import java.security.MessageDigest\nimport groovy.json.JsonSlurper\n\nif (!fromLang) fromLang = 'auto'\n\ndef url = 'https://fanyi-api.baidu.com/api/trans/vip/translate'\n\n// 生成 salt（32768 ~ 65536 之间的随机整数）\ndef salt = new Random().nextInt(32768) + 32768\n\n// 构造签名字符串: appid + q + salt + secretKey\ndef signStr = appId + text + salt + secretKey\ndef md5 = MessageDigest.getInstance(\"MD5\")\ndef sign = md5.digest(signStr.getBytes('UTF-8'))\n    .encodeHex()\n    .toString()\n\n// 构建查询参数（作为 URL 查询字符串）\ndef params = [\n    q      : text,\n    from   : fromLang,\n    to     : toLang,\n    appid  : appId,\n    salt   : salt,\n    sign   : sign\n]\n\n// 构造完整 URL（注意：POST 请求但百度 API 接受 GET 参数形式，实际是 POST with query params）\ndef queryString = params.collect { k, v -> \"${k}=${URLEncoder.encode(v.toString(), 'UTF-8')}\" }.join('&')\ndef fullUrl = \"${url}?${queryString}\"\n\ntry {\n    // 发送 POST 请求（空 body）\n    def connection = new URL(fullUrl).openConnection()\n    connection.setRequestMethod('POST')\n    connection.setDoOutput(true)\n    connection.connect()\n\n    // 读取响应\n    def responseText = connection.inputStream.text\n    def jsonSlurper = new JsonSlurper()\n    def result = jsonSlurper.parseText(responseText)\n\n    if (result.trans_result) {\n        return result.trans_result[0].dst\n    } else {\n        def errorCode = result.error_code ?: 'unknown'\n        def errorMsg = result.error_msg ?: '未知错误'\n\n        def errorTips = [\n            '52001': 'APP ID不存在或错误',\n            '52002': '签名错误，请检查密钥',\n            '52003': '访问IP被限制',\n            '54000': '必填参数为空',\n            '54001': '签名错误',\n            '54003': 'QPS超限或超出配额（免费版每秒1次，每月5万字符）',\n            '54004': '账户余额不足',\n            '54005': '请求过于频繁，请降低QPS',\n            '58000': '客户端IP非法',\n            '58001': '译文语言方向不支持',\n            '58002': '服务当前已关闭',\n        ]\n\n        def tip = errorTips.get(errorCode as String, '')\n        return \"翻译失败: 错误代码${errorCode}, ${errorMsg} ${tip}\"\n    }\n} catch (Exception e) {\n    return \"请求异常: ${e.message}\"\n}\n\n// 辅助方法：byte[] 转 hex 字符串（Groovy 中可扩展）\nif (!Byte[].metaClass.hasMetaMethod('encodeHex')) {\n    Byte[].metaClass.encodeHex = {\n        delegate.collect { String.format(\"%02x\", it) }.join()\n    }\n}","inputFieldList":[{"name":"text","type":"string","source":"reference","isRequired":true},{"name":"toLang","type":"string","source":"reference","isRequired":true},{"name":"fromLang","type":"string","source":"reference","isRequired":false}],"initFieldList":[{"attrs":{"maxlength":200,"minlength":1,"show-word-limit":true},"field":"appId","label":"APP ID","required":true,"input_type":"TextInput","props_info":{"rules":[{"message":"APP ID 为必填属性","required":true},{"max":200,"min":1,"message":"APP ID长度在 1 到 200 个字符","trigger":"blur"}]},"default_value":"xxxxxx","show_default_value":true},{"attrs":{"type":"password","maxlength":200,"minlength":1,"show-password":true,"show-word-limit":true},"field":"secretKey","label":"密钥","required":true,"input_type":"PasswordInput","props_info":{"rules":[{"message":"密钥 为必填属性","required":true},{"max":200,"min":1,"message":"密钥长度在 1 到 200 个字符","trigger":"blur"}]},"default_value":"xxxxxx","show_default_value":true}],"initParams":{},"userId":"ee95e0e38acaad23bd73d9bea414a97d","isActive":true,"toolType":"CUSTOM","label":"translate","scope":"WORKSPACE","icon":"https://apps-assets.fit2cloud.com/stable/maxkb/baidu-translate/logo.png","folderId":"default","id":"1d7142d9b6c6e2c1fe0f69cb146dfe5c","version":"1.0.0","createTime":1768808010000,"updateTime":1768808303498}